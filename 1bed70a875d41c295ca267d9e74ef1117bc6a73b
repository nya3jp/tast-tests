{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "0739d0f4_1b29cea5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1474010
      },
      "writtenOn": "2021-06-07T08:15:27Z",
      "side": 1,
      "message": "nya@, Here the test fails on x86 devices and model names are hardcoded to skip tests on those devices. Based on your comment on another CL adding you to this CL for suggestions.",
      "revId": "1bed70a875d41c295ca267d9e74ef1117bc6a73b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6bec2101_ea3e9e91",
        "filename": "src/chromiumos/tast/local/bundles/cros/arcappcompat/autocad.go",
        "patchSetId": 5
      },
      "lineNbr": 46,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2021-06-07T08:32:55Z",
      "side": 1,
      "message": "You can use hwdep.NoX86() instead to skip this test on X86.",
      "revId": "1bed70a875d41c295ca267d9e74ef1117bc6a73b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "65df7612_5bffaf91",
        "filename": "src/chromiumos/tast/local/bundles/cros/arcappcompat/autocad.go",
        "patchSetId": 5
      },
      "lineNbr": 46,
      "author": {
        "id": 1287257
      },
      "writtenOn": "2021-06-07T18:25:24Z",
      "side": 1,
      "message": "Already tried using HardwareDeps: hwdep.D(hwdep.NoX86()). Observed that, it is skipping on other devices like eve, careena, helios. hwdep.NoX86() is looking for DUT CPU architecture not android architecture. Getting message as \" DUT\u0027s CPU is x86 compatible\". So hwdep.D(hwdep.NoX86()) couldn\u0027t be used here.\n\nAdditional Info: Please find the comment in the bug, https://b.corp.google.com/issues/181045525#comment9. Based on the comment, hwdep ABI is looking for useragent or Cros CPU info which is x86_64 for caroline, Nasher360, Eve, Careena, helios. Whereas android build for caroline, Nasher360 are x86. So hwdep.NoX86() couldn\u0027t be used here.",
      "parentUuid": "6bec2101_ea3e9e91",
      "revId": "1bed70a875d41c295ca267d9e74ef1117bc6a73b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e1b11771_65a98e2f",
        "filename": "src/chromiumos/tast/local/bundles/cros/arcappcompat/autocad.go",
        "patchSetId": 5
      },
      "lineNbr": 46,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2021-06-08T02:13:57Z",
      "side": 1,
      "message": "Thanks for clarification!\n\nIt looks like you need a new software dependency. ABI of Android container is specified by USE flags at build time, and software dependencies are a way to skip tests based on USE flags. They are defined here:\nhttps://source.corp.google.com/chromeos_public/src/platform/tast/src/chromiumos/tast/cmd/local_test_runner/main.go\n\n\"cheets_user\" and \"cheets_user_64\" are USE flags to specify Android container ABI.\nhttps://source.corp.google.com/chromeos_internal/src/private-overlays/project-cheets-private/profiles/android/amd64/make.defaults\n\nSo I think you can define the software dependency as:\n\n \"no_arc_x86\": \"!(amd64 \u0026\u0026 cheets_user)\"\n \nFor more information about software deps, see:\nhttps://chromium.googlesource.com/chromiumos/platform/tast/+/HEAD/docs/test_dependencies.md",
      "parentUuid": "65df7612_5bffaf91",
      "revId": "1bed70a875d41c295ca267d9e74ef1117bc6a73b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fcede185_74ff8d99",
        "filename": "src/chromiumos/tast/local/bundles/cros/arcappcompat/autocad.go",
        "patchSetId": 5
      },
      "lineNbr": 46,
      "author": {
        "id": 1287257
      },
      "writtenOn": "2021-06-08T23:08:46Z",
      "side": 1,
      "message": "Thanks for the suggestions. \nas suggested, tried adding \"no_arc_x86\": \"!(amd64 \u0026\u0026 cheets_user)\" in \"https://source.corp.google.com/chromeos_public/src/platform/tast/src/chromiumos/tast/cmd/local_test_runner/main.go\" and ran on caroline, nasher360. It isn\u0027t skipping the \"arcappcompat.Autocad\" test on caroline and nasher360 devices.",
      "parentUuid": "e1b11771_65a98e2f",
      "revId": "1bed70a875d41c295ca267d9e74ef1117bc6a73b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c8c5e891_084a5598",
        "filename": "src/chromiumos/tast/local/bundles/cros/arcappcompat/autocad.go",
        "patchSetId": 5
      },
      "lineNbr": 46,
      "author": {
        "id": 1287257
      },
      "writtenOn": "2021-06-09T02:07:42Z",
      "side": 1,
      "message": "Tried using ExtraSoftwareDeps: []string{\"android_p\", \"no_arc_x86\"}, in \"arcappcompat.Autocad\" test. Observed that the test isn\u0027t skipping run on Caroline and nasher360. Couldn\u0027t use  \"no_arc_x86\". So hwdep.SkipOnModel is needed here.",
      "parentUuid": "fcede185_74ff8d99",
      "revId": "1bed70a875d41c295ca267d9e74ef1117bc6a73b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fe27cb10_a5b179ac",
        "filename": "src/chromiumos/tast/local/bundles/cros/arcappcompat/autocad.go",
        "patchSetId": 5
      },
      "lineNbr": 46,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2021-06-09T02:14:18Z",
      "side": 1,
      "message": "I debugged this and found that the USE flag cheets_user is the default if no other cheets_* USE flags are set (which is indicated by a plus sign).\nhttps://source.corp.google.com/chromeos_internal/src/private-overlays/project-cheets-private/chromeos-base/android-container-pi/android-container-pi-9999.ebuild;rcl\u003d88fbff2d980f3778606cbc09e2ba3330fb70a285;l\u003d177\n\nThis issue should be fixed by updating tast-use-flags-9999.ebuild and replacing cheets_user with +cheets_user:\nhttps://source.corp.google.com/chromeos_public/src/third_party/chromiumos-overlay/chromeos-base/tast-use-flags/tast-use-flags-9999.ebuild;rcl\u003dd74da03b8acc8e630c5dbd31520f21a050592ca0;l\u003d42\n\n(I often find that non-centralized default dandling of USE flags is error-prone...)",
      "parentUuid": "fcede185_74ff8d99",
      "revId": "1bed70a875d41c295ca267d9e74ef1117bc6a73b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "562c0e54_55c9048b",
        "filename": "src/chromiumos/tast/local/bundles/cros/arcappcompat/autocad.go",
        "patchSetId": 5
      },
      "lineNbr": 46,
      "author": {
        "id": 1287257
      },
      "writtenOn": "2021-06-14T21:52:29Z",
      "side": 1,
      "message": "Tried \"cheets_user\" with \"+cheets_user\" in \"tast-use-flags-9999.ebuild\" file. Also added \"no_arc_x86\": `!\"amd64\" \u0026\u0026 !\"+cheets_user\"` in main.go file. Observed that arcappcompat.Autocad is skipping on caroline(Caroline), coral(nasher360) but it is skipping on other devices which are having x86_64 android build (List of other devices: eve(Eve), (dedede)Sasuke, puff(Wyvern), zork(Ezkinil), hatch (Jinlon)). So I think we couldn\u0027t use \"no_arc_x86\": `!\"amd64\" \u0026\u0026 !\"+cheets_user\"` here.",
      "parentUuid": "fe27cb10_a5b179ac",
      "revId": "1bed70a875d41c295ca267d9e74ef1117bc6a73b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a8a212b7_b42ef638",
        "filename": "src/chromiumos/tast/local/bundles/cros/arcappcompat/autocad.go",
        "patchSetId": 5
      },
      "lineNbr": 46,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2021-06-15T00:39:45Z",
      "side": 1,
      "message": "Can you try \"!(amd64 \u0026\u0026 cheets_user)\" ?\n\n- We should not use plus signs in local_test_runner/main.go. Plus signs can be used only in IUSE in tast-use-flags-9999.ebuild.\n- \"!amd64 \u0026\u0026 !cheets_user\" is different from \"!(amd64 \u0026\u0026 cheets_user)\". With the former expression, all x86/x86_64 devices are skipped.",
      "parentUuid": "562c0e54_55c9048b",
      "revId": "1bed70a875d41c295ca267d9e74ef1117bc6a73b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "41479b79_44b24d1d",
        "filename": "src/chromiumos/tast/local/bundles/cros/arcappcompat/autocad.go",
        "patchSetId": 5
      },
      "lineNbr": 46,
      "author": {
        "id": 1287257
      },
      "writtenOn": "2021-06-29T18:15:05Z",
      "side": 1,
      "message": "Tried \"no_arc_x86\": \"!(amd64 \u0026\u0026 cheets_user)\" in  local_test_runner/main.go file.\nStill it isn\u0027t skipping test on Caroline and Nasher360. I think it better to use hwdep.SkipOnModel to skip on these two devices, \"caroline\", \"nasher360.",
      "parentUuid": "a8a212b7_b42ef638",
      "revId": "1bed70a875d41c295ca267d9e74ef1117bc6a73b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7a534c85_f11419f2",
        "filename": "src/chromiumos/tast/local/bundles/cros/arcappcompat/autocad.go",
        "patchSetId": 5
      },
      "lineNbr": 46,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2021-06-30T09:16:31Z",
      "side": 1,
      "message": "Hard-coding models is easier but not better; hard-coded lists often get stale without noticing.\n\nIn this case I\u0027m pretty sure software deps is the right way to go. We need to debug why it doesn\u0027t work.\n\nCould you check the content of /usr/local/etc/tast_use_flags.txt and see if \"amd64\" and \"cheets_user\" is included in the list?\n\nPlease note that you need to deploy a change to tast-use-flags-9999.ebuild to the DUT in order for the change to take effect.\n\n\u003e Before a new USE flag can be used in an expression, it must be added to IUSE in the tast-use-flags package. Local changes to the tast-use-flags ebuild have to be pushed to the DUT manually to take effect:\n\n\u003e cros_workon-$BOARD start chromeos-base/tast-use-flags\n\u003e emerge-$BOARD chromeos-base/tast-use-flags\n\u003e cros deploy --root\u003d/usr/local $HOST chromeos-base/tast-use-flags\n\n\u003e When submitting changes to add new USE flags to the tast-use-flags package, please use Cq-Depend in your commit messages to ensure that changes land in the correct order.\n\nhttps://chromium.googlesource.com/chromiumos/platform/tast/+/HEAD/docs/test_dependencies.md#new-features",
      "parentUuid": "41479b79_44b24d1d",
      "revId": "1bed70a875d41c295ca267d9e74ef1117bc6a73b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c571ec8b_17abda41",
        "filename": "src/chromiumos/tast/local/bundles/cros/arcappcompat/autocad.go",
        "patchSetId": 5
      },
      "lineNbr": 46,
      "author": {
        "id": 1287257
      },
      "writtenOn": "2021-06-30T23:53:50Z",
      "side": 1,
      "message": "\u003e\u003e Could you check the content of /usr/local/etc/tast_use_flags.txt and see if \"amd64\" and \"cheets_user\" is included in the list?\nI can find \"amd64\" on my \"tast_use_flags.txt\" files. But I couldn\u0027t find \"cheets_user\". I build the packages for eve, caroline and scarlet boards on my linux desktop https://chromium.googlesource.com/chromiumos/docs/+/master/developer_guide.md#build-the-packages-for-your-board. Still I couldn\u0027t find \"cheets_user\" in any of the devices \"tast_use_flags.txt\" files. Please let me know if I am missing any.",
      "parentUuid": "7a534c85_f11419f2",
      "revId": "1bed70a875d41c295ca267d9e74ef1117bc6a73b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}