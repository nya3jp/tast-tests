{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "0739d0f4_1b29cea5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1474010
      },
      "writtenOn": "2021-06-07T08:15:27Z",
      "side": 1,
      "message": "nya@, Here the test fails on x86 devices and model names are hardcoded to skip tests on those devices. Based on your comment on another CL adding you to this CL for suggestions.",
      "revId": "1bed70a875d41c295ca267d9e74ef1117bc6a73b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6bec2101_ea3e9e91",
        "filename": "src/chromiumos/tast/local/bundles/cros/arcappcompat/autocad.go",
        "patchSetId": 5
      },
      "lineNbr": 46,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2021-06-07T08:32:55Z",
      "side": 1,
      "message": "You can use hwdep.NoX86() instead to skip this test on X86.",
      "revId": "1bed70a875d41c295ca267d9e74ef1117bc6a73b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "65df7612_5bffaf91",
        "filename": "src/chromiumos/tast/local/bundles/cros/arcappcompat/autocad.go",
        "patchSetId": 5
      },
      "lineNbr": 46,
      "author": {
        "id": 1287257
      },
      "writtenOn": "2021-06-07T18:25:24Z",
      "side": 1,
      "message": "Already tried using HardwareDeps: hwdep.D(hwdep.NoX86()). Observed that, it is skipping on other devices like eve, careena, helios. hwdep.NoX86() is looking for DUT CPU architecture not android architecture. Getting message as \" DUT\u0027s CPU is x86 compatible\". So hwdep.D(hwdep.NoX86()) couldn\u0027t be used here.\n\nAdditional Info: Please find the comment in the bug, https://b.corp.google.com/issues/181045525#comment9. Based on the comment, hwdep ABI is looking for useragent or Cros CPU info which is x86_64 for caroline, Nasher360, Eve, Careena, helios. Whereas android build for caroline, Nasher360 are x86. So hwdep.NoX86() couldn\u0027t be used here.",
      "parentUuid": "6bec2101_ea3e9e91",
      "revId": "1bed70a875d41c295ca267d9e74ef1117bc6a73b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e1b11771_65a98e2f",
        "filename": "src/chromiumos/tast/local/bundles/cros/arcappcompat/autocad.go",
        "patchSetId": 5
      },
      "lineNbr": 46,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2021-06-08T02:13:57Z",
      "side": 1,
      "message": "Thanks for clarification!\n\nIt looks like you need a new software dependency. ABI of Android container is specified by USE flags at build time, and software dependencies are a way to skip tests based on USE flags. They are defined here:\nhttps://source.corp.google.com/chromeos_public/src/platform/tast/src/chromiumos/tast/cmd/local_test_runner/main.go\n\n\"cheets_user\" and \"cheets_user_64\" are USE flags to specify Android container ABI.\nhttps://source.corp.google.com/chromeos_internal/src/private-overlays/project-cheets-private/profiles/android/amd64/make.defaults\n\nSo I think you can define the software dependency as:\n\n \"no_arc_x86\": \"!(amd64 \u0026\u0026 cheets_user)\"\n \nFor more information about software deps, see:\nhttps://chromium.googlesource.com/chromiumos/platform/tast/+/HEAD/docs/test_dependencies.md",
      "parentUuid": "65df7612_5bffaf91",
      "revId": "1bed70a875d41c295ca267d9e74ef1117bc6a73b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fcede185_74ff8d99",
        "filename": "src/chromiumos/tast/local/bundles/cros/arcappcompat/autocad.go",
        "patchSetId": 5
      },
      "lineNbr": 46,
      "author": {
        "id": 1287257
      },
      "writtenOn": "2021-06-08T23:08:46Z",
      "side": 1,
      "message": "Thanks for the suggestions. \nas suggested, tried adding \"no_arc_x86\": \"!(amd64 \u0026\u0026 cheets_user)\" in \"https://source.corp.google.com/chromeos_public/src/platform/tast/src/chromiumos/tast/cmd/local_test_runner/main.go\" and ran on caroline, nasher360. It isn\u0027t skipping the \"arcappcompat.Autocad\" test on caroline and nasher360 devices.",
      "parentUuid": "e1b11771_65a98e2f",
      "revId": "1bed70a875d41c295ca267d9e74ef1117bc6a73b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c8c5e891_084a5598",
        "filename": "src/chromiumos/tast/local/bundles/cros/arcappcompat/autocad.go",
        "patchSetId": 5
      },
      "lineNbr": 46,
      "author": {
        "id": 1287257
      },
      "writtenOn": "2021-06-09T02:07:42Z",
      "side": 1,
      "message": "Tried using ExtraSoftwareDeps: []string{\"android_p\", \"no_arc_x86\"}, in \"arcappcompat.Autocad\" test. Observed that the test isn\u0027t skipping run on Caroline and nasher360. Couldn\u0027t use  \"no_arc_x86\". So hwdep.SkipOnModel is needed here.",
      "parentUuid": "fcede185_74ff8d99",
      "revId": "1bed70a875d41c295ca267d9e74ef1117bc6a73b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fe27cb10_a5b179ac",
        "filename": "src/chromiumos/tast/local/bundles/cros/arcappcompat/autocad.go",
        "patchSetId": 5
      },
      "lineNbr": 46,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2021-06-09T02:14:18Z",
      "side": 1,
      "message": "I debugged this and found that the USE flag cheets_user is the default if no other cheets_* USE flags are set (which is indicated by a plus sign).\nhttps://source.corp.google.com/chromeos_internal/src/private-overlays/project-cheets-private/chromeos-base/android-container-pi/android-container-pi-9999.ebuild;rcl\u003d88fbff2d980f3778606cbc09e2ba3330fb70a285;l\u003d177\n\nThis issue should be fixed by updating tast-use-flags-9999.ebuild and replacing cheets_user with +cheets_user:\nhttps://source.corp.google.com/chromeos_public/src/third_party/chromiumos-overlay/chromeos-base/tast-use-flags/tast-use-flags-9999.ebuild;rcl\u003dd74da03b8acc8e630c5dbd31520f21a050592ca0;l\u003d42\n\n(I often find that non-centralized default dandling of USE flags is error-prone...)",
      "parentUuid": "fcede185_74ff8d99",
      "revId": "1bed70a875d41c295ca267d9e74ef1117bc6a73b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "562c0e54_55c9048b",
        "filename": "src/chromiumos/tast/local/bundles/cros/arcappcompat/autocad.go",
        "patchSetId": 5
      },
      "lineNbr": 46,
      "author": {
        "id": 1287257
      },
      "writtenOn": "2021-06-14T21:52:29Z",
      "side": 1,
      "message": "Tried \"cheets_user\" with \"+cheets_user\" in \"tast-use-flags-9999.ebuild\" file. Also added \"no_arc_x86\": `!\"amd64\" \u0026\u0026 !\"+cheets_user\"` in main.go file. Observed that arcappcompat.Autocad is skipping on caroline(Caroline), coral(nasher360) but it is skipping on other devices which are having x86_64 android build (List of other devices: eve(Eve), (dedede)Sasuke, puff(Wyvern), zork(Ezkinil), hatch (Jinlon)). So I think we couldn\u0027t use \"no_arc_x86\": `!\"amd64\" \u0026\u0026 !\"+cheets_user\"` here.",
      "parentUuid": "fe27cb10_a5b179ac",
      "revId": "1bed70a875d41c295ca267d9e74ef1117bc6a73b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}