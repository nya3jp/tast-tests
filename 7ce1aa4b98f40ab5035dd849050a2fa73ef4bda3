{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "4d285ae0_b38febbb",
        "filename": "src/chromiumos/tast/remote/bundles/cros/network/diag_signal_strength.go",
        "patchSetId": 6
      },
      "lineNbr": 111,
      "author": {
        "id": 1408947
      },
      "writtenOn": "2021-04-30T17:52:40Z",
      "side": 1,
      "message": "It would be good to defer here a function that would reset all channels to 0, to leave the setup in the same state as you got it. Definitely leaving it set to maximum attenuation would not be appreciated by next tests ðŸ˜Š",
      "revId": "7ce1aa4b98f40ab5035dd849050a2fa73ef4bda3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a39b2f3c_49bcd9a5",
        "filename": "src/chromiumos/tast/remote/bundles/cros/network/diag_signal_strength.go",
        "patchSetId": 6
      },
      "lineNbr": 111,
      "author": {
        "id": 1108324
      },
      "writtenOn": "2021-04-30T18:21:40Z",
      "side": 1,
      "message": "+1 \n\nJacek,\n\nWhile it is a good practice to reset all channels to 0 at the end of the test, we should also set the attenuation to 0 during initialization (when you initially open access to atten?) as we do in autotest (link below) to account for cases where the test hangs or does not complete as expected. In such cases the attenuator may be left with any non-zero atten which can interfere with the following tests.\n\nhttps://source.corp.google.com/chromeos_public/src/third_party/autotest/files/server/cros/network/attenuator_controller.py;l\u003d47",
      "parentUuid": "4d285ae0_b38febbb",
      "revId": "7ce1aa4b98f40ab5035dd849050a2fa73ef4bda3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7ee7bb13_cf2cecc0",
        "filename": "src/chromiumos/tast/remote/bundles/cros/network/diag_signal_strength.go",
        "patchSetId": 6
      },
      "lineNbr": 111,
      "author": {
        "id": 1304442
      },
      "writtenOn": "2021-04-30T20:33:31Z",
      "side": 1,
      "message": "+1 to Harpreet \n\nI think this would probably be something that is better suited to perform in the fixture. The tast docs state that tests shouldn\u0027t assume that things are in a particular state when they run, and that tests shouldn\u0027t perform unnecessary deinitialization steps: https://chromium.googlesource.com/chromiumos/platform/tast/+/HEAD/docs/writing_tests.md#startup-and-shutdown\n\nI realized that my test was not properly setting the attenuation before connecting, so I moved that logic above were I attempt to connect to the AP.",
      "parentUuid": "a39b2f3c_49bcd9a5",
      "revId": "7ce1aa4b98f40ab5035dd849050a2fa73ef4bda3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8a01bfca_53f65f15",
        "filename": "src/chromiumos/tast/remote/bundles/cros/network/diag_signal_strength.go",
        "patchSetId": 6
      },
      "lineNbr": 111,
      "author": {
        "id": 1304442
      },
      "writtenOn": "2021-05-11T17:39:34Z",
      "side": 1,
      "message": "Jacek, should we file a bug to modify the fixture to perform this cleanup in the fixture?",
      "parentUuid": "7ee7bb13_cf2cecc0",
      "revId": "7ce1aa4b98f40ab5035dd849050a2fa73ef4bda3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "93f31e78_14018d2a",
        "filename": "src/chromiumos/tast/remote/bundles/cros/network/diag_signal_strength.go",
        "patchSetId": 6
      },
      "lineNbr": 111,
      "author": {
        "id": 1408947
      },
      "writtenOn": "2021-05-12T22:03:24Z",
      "side": 1,
      "message": "I guess so.\n\nHowever, from the practical point of view, I remember I had some problems with cleanly disconnecting WiFi, when attenuation was too high (could not get SelectedService). I\u0027m not sure if it\u0027s still the case, but looking at the code the way the defer()s stack it might still happen.",
      "parentUuid": "8a01bfca_53f65f15",
      "revId": "7ce1aa4b98f40ab5035dd849050a2fa73ef4bda3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d3909dcc_35227920",
        "filename": "src/chromiumos/tast/remote/bundles/cros/network/diag_signal_strength.go",
        "patchSetId": 6
      },
      "lineNbr": 111,
      "author": {
        "id": 1304442
      },
      "writtenOn": "2021-05-13T18:15:36Z",
      "side": 1,
      "message": "Ok I will add a cleanup to set the attenuation to zero in this test, but I think a more robust solution in the fixture would be best in the long term.",
      "parentUuid": "93f31e78_14018d2a",
      "revId": "7ce1aa4b98f40ab5035dd849050a2fa73ef4bda3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "99f54007_14c944eb",
        "filename": "src/chromiumos/tast/remote/bundles/cros/network/diag_signal_strength.go",
        "patchSetId": 6
      },
      "lineNbr": 111,
      "author": {
        "id": 1108324
      },
      "writtenOn": "2021-05-13T18:30:23Z",
      "side": 1,
      "message": "Created a bug https://b.corp.google.com/issues/188068031",
      "parentUuid": "d3909dcc_35227920",
      "revId": "7ce1aa4b98f40ab5035dd849050a2fa73ef4bda3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cf1bd6ca_979b3171",
        "filename": "src/chromiumos/tast/remote/bundles/cros/network/diag_signal_strength.go",
        "patchSetId": 6
      },
      "lineNbr": 144,
      "author": {
        "id": 1408947
      },
      "writtenOn": "2021-04-30T17:52:40Z",
      "side": 1,
      "message": "Here you probably might set not high enough attenuation.\n\nSpeaking about attenuations, we actally mean two attenuations: attenuation set on the attenuator (0-95) and total attenuation on the line (including loss on cables splitters etc, variable in different setups, adding another 30-60dB). Anything in the code referring to TotalAttenuation is as the name suggests Total (line) attenuation. Anything that does not refer to the Total attenuation, means attenuator setting.\n\nMaking long story short, if you want to cut the signal off, instead of attenuator.SetTotalAttneuation(attenuator.MaximumAttenuation()...) you should use\nattenuator.SetAttneuation(attenuator.MaximumAttenuation()...).",
      "range": {
        "startLine": 144,
        "startChar": 37,
        "endLine": 144,
        "endChar": 55
      },
      "revId": "7ce1aa4b98f40ab5035dd849050a2fa73ef4bda3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "08aef179_67d57cbc",
        "filename": "src/chromiumos/tast/remote/bundles/cros/network/diag_signal_strength.go",
        "patchSetId": 6
      },
      "lineNbr": 144,
      "author": {
        "id": 1304442
      },
      "writtenOn": "2021-04-30T20:33:31Z",
      "side": 1,
      "message": "Thanks for the context Jacek! \n\nI tested using the SetAttenuation, and at this point the network is no longer connected. Ideally, I would like to still have the network connected but with a weak signal strength. When I test using the SetTotalAttenuation, the signal strength drops from 100 (maximum) to 37, which is well below the threshold I\u0027m testing. Is it fine to just attenuate the line instead of using the attenuator? Or would it be better to actually set the attenuator, but use a value less than maximum?",
      "parentUuid": "cf1bd6ca_979b3171",
      "range": {
        "startLine": 144,
        "startChar": 37,
        "endLine": 144,
        "endChar": 55
      },
      "revId": "7ce1aa4b98f40ab5035dd849050a2fa73ef4bda3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "39a0dfe7_cc930e49",
        "filename": "src/chromiumos/tast/remote/bundles/cros/network/diag_signal_strength.go",
        "patchSetId": 6
      },
      "lineNbr": 144,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2021-05-05T03:42:51Z",
      "side": 1,
      "message": "Thanks Jacek\u0027s detailed explanation. The original code \nattenuator.SetTotalAttneuation(attenuator.MaximumAttenuation()) \nworks just because the parameter attenuates the signal to a weak but not disconnect level. I would say the test should define a constant, i.e. AttenuationForWeakConnection, and call attenuator.SetTotalAttneuation(AttenuationForWeakConnection) so that let the function do the calculation for you.",
      "parentUuid": "08aef179_67d57cbc",
      "range": {
        "startLine": 144,
        "startChar": 37,
        "endLine": 144,
        "endChar": 55
      },
      "revId": "7ce1aa4b98f40ab5035dd849050a2fa73ef4bda3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8e90f155_71bb7f88",
        "filename": "src/chromiumos/tast/remote/bundles/cros/network/diag_signal_strength.go",
        "patchSetId": 6
      },
      "lineNbr": 144,
      "author": {
        "id": 1304442
      },
      "writtenOn": "2021-05-11T17:39:34Z",
      "side": 1,
      "message": "Ok I added a constant and used that instead. Based on the comments, I think it makes sense to just use the SetAttenuation call. Let me know if I missed something.",
      "parentUuid": "39a0dfe7_cc930e49",
      "range": {
        "startLine": 144,
        "startChar": 37,
        "endLine": 144,
        "endChar": 55
      },
      "revId": "7ce1aa4b98f40ab5035dd849050a2fa73ef4bda3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}