{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "3e94e556_cc1a7bb2",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1113991
      },
      "writtenOn": "2021-08-09T21:49:02Z",
      "side": 1,
      "message": "frkoenig@, pwang@ PTAL",
      "revId": "12e1d90a7542c70e5ff15df238aa6157af3443ed",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a322b46a_6ab0b6ce",
        "filename": "src/chromiumos/tast/local/graphics/dri.go",
        "patchSetId": 5
      },
      "lineNbr": 124,
      "author": {
        "id": 1000886
      },
      "writtenOn": "2021-08-09T22:05:59Z",
      "side": 1,
      "message": "Isn\u0027t this just going to pick the highest index?  I\u0027m failing to see how this iterates through the available crtcs.",
      "revId": "12e1d90a7542c70e5ff15df238aa6157af3443ed",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0fb647e9_379ecef2",
        "filename": "src/chromiumos/tast/local/graphics/dri.go",
        "patchSetId": 5
      },
      "lineNbr": 124,
      "author": {
        "id": 1113991
      },
      "writtenOn": "2021-08-09T22:14:24Z",
      "side": 1,
      "message": "g.Index will contain the |i| selected in l.105-106 out of the for\nloop that iterates over indexes. Object oriented programming in Go\nis bizarre.\n\nBut there\u0027s a bug! l.104 should start from 0 and go up to 63. Let\nme fix it.",
      "parentUuid": "a322b46a_6ab0b6ce",
      "revId": "12e1d90a7542c70e5ff15df238aa6157af3443ed",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "23ca9fb4_517e3077",
        "filename": "src/chromiumos/tast/local/graphics/dri.go",
        "patchSetId": 5
      },
      "lineNbr": 124,
      "author": {
        "id": 1000886
      },
      "writtenOn": "2021-08-09T22:28:54Z",
      "side": 1,
      "message": "I see g.Index getting the largest crtc.  But we need to open each crtc and try and read to see if it has the data we are looking for.  It looks like if there were 10 crtcs: |/sys/kernel/debug/dri/[0-9]/framebuffer| then g.Index would end up with 9 and only that one would get through the os.Open call.  Or is ReadFramebufferCount called after each os.Stat?",
      "parentUuid": "0fb647e9_379ecef2",
      "revId": "12e1d90a7542c70e5ff15df238aa6157af3443ed",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "603e7dbd_e33381be",
        "filename": "src/chromiumos/tast/local/graphics/dri.go",
        "patchSetId": 5
      },
      "lineNbr": 124,
      "author": {
        "id": 1113991
      },
      "writtenOn": "2021-08-09T23:12:25Z",
      "side": 1,
      "message": "mem_check.go logic creates a Backend object once [1] (by calling\nGetBackend() [2] which creates the GenericBackend object). The\ncode in this CL\u0027s\n  func genericBackend() *GenericBackend\n  \niterates over all /sys/kernel/debug/dri/%d/framebuffer files \n(with %d from 0 upwards) until it finds one, then it just saves\nthe index in the created GenericBackend so it can be used in the\ncalls to GenericBackend.ReadFramebufferCount() [3]. Also note how\ngenericBackend() bundles statement and condition in one single\nline (which is go-isms).\n\n  if _, err :\u003d os.Stat(fmt.Sprintf(genericFramebufferFilePattern, i)); err \u003d\u003d nil {\n    // .. found it!\n  }\n\nAlso in general we\u0027d pick the first one we see existing,\nwhich should be OK until we have systems with two GPU\ncards (there\u0027s more code in graphics/ with a similar\nlimitation).\n\n\n[1] https://source.chromium.org/chromiumos/chromiumos/codesearch/+/main:src/platform/tast-tests/src/chromiumos/tast/local/bundles/cros/video/mem_check.go;l\u003d114?q\u003dmem_check.go\u0026ss\u003dchromiumos%2Fchromiumos%2Fcodesearch\n[2] https://source.chromium.org/chromiumos/chromiumos/codesearch/+/main:src/platform/tast-tests/src/chromiumos/tast/local/graphics/dri.go;l\u003d141?q\u003ddri.go%20GetBackend\n[3] https://source.chromium.org/chromiumos/chromiumos/codesearch/+/main:src/platform/tast-tests/src/chromiumos/tast/local/graphics/dri.go;l\u003d178?q\u003ddri.go%20GetBackend",
      "parentUuid": "23ca9fb4_517e3077",
      "revId": "12e1d90a7542c70e5ff15df238aa6157af3443ed",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a5675233_5a010a48",
        "filename": "src/chromiumos/tast/local/graphics/dri.go",
        "patchSetId": 5
      },
      "lineNbr": 124,
      "author": {
        "id": 1000886
      },
      "writtenOn": "2021-08-09T23:30:26Z",
      "side": 1,
      "message": "My mistake.  For some reason I was thinking that it had to open and check the |framebuffer| file for the data.  But in actuality, only |/sys/kernel/debug/dri/0/framebuffer| OR |/sys/kernel/debug/dri/1/framebuffer| exist.  So we are taking the first one.",
      "parentUuid": "603e7dbd_e33381be",
      "revId": "12e1d90a7542c70e5ff15df238aa6157af3443ed",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}