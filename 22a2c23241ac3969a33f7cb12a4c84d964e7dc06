{
  "comments": [
    {
      "key": {
        "uuid": "0e7a6da2_cc178f9d",
        "filename": "src/chromiumos/tast/local/audio/cras.go",
        "patchSetId": 1
      },
      "lineNbr": 72,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-03-19T20:10:58Z",
      "side": 1,
      "message": "i don\u0027t see this documented in README.dbus-api. if that\u0027s an oversight, can you update the docs?\n\nalso, is uint64 incorrect here? SetOutputVolume and SetOutputNodeVolume are both documented as taking int32 volumes.",
      "range": {
        "startLine": 72,
        "startChar": 12,
        "endLine": 72,
        "endChar": 18
      },
      "revId": "22a2c23241ac3969a33f7cb12a4c84d964e7dc06",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1720b224_48d7ef04",
        "filename": "src/chromiumos/tast/local/audio/cras.go",
        "patchSetId": 1
      },
      "lineNbr": 72,
      "author": {
        "id": 1299444
      },
      "writtenOn": "2019-03-19T21:14:36Z",
      "side": 1,
      "message": "I believe the docs is a bit out-of-date, as |NodeVolume| appears in [1] to retrieve the node volume.\n\nAlso I tried to use int32 as indicated in the doc, but the type assertion nodeVolume.Value().(int32) returns false and typeof(nodeVolume.Value()) actually gave me uint64, not sure if it is as intended or a bug.\n\n[1] https://cs.corp.google.com/chromeos_public/src/third_party/autotest/files/client/cros/audio/cras_utils.py?rcl\u003d471b4144628d96c4353546c407649824c9203e81\u0026l\u003d603",
      "parentUuid": "0e7a6da2_cc178f9d",
      "range": {
        "startLine": 72,
        "startChar": 12,
        "endLine": 72,
        "endChar": 18
      },
      "revId": "22a2c23241ac3969a33f7cb12a4c84d964e7dc06",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b9e0061e_6da2963b",
        "filename": "src/chromiumos/tast/local/audio/cras.go",
        "patchSetId": 1
      },
      "lineNbr": 72,
      "author": {
        "id": 1001485
      },
      "writtenOn": "2019-03-20T02:24:02Z",
      "side": 1,
      "message": "Thanks for spotting this.\nWe found that there are three places which use different format for node volume:\n1. uint8 in cras_client_set_node_volume [1]\n2. int32 in OutputNodeVolumeChanged[2]\n3. uint64 GetNodes [3]\n\nWe should align them and fix the readme.\nI think uint8 is sufficient for this value because we only need 0 ~ 100.\nSo we can keep 1 unchanged.\n\nFor 2, it requires Chrome side change. We would need to make change to Chrome to make it backword compatible[4]. After ChromeOS pick up that Chrome change, we change OutputNodeVolumeChanged to uint8 in CRAS, we then make another Chrome change to accept uint8 only.\n\nFor 3, fortunately, there is no user except cras_utils.py in autotest using the NodeVolume value of GetNodes.\nSo we can make the change without breaking Chrome.\n\nI moved the AIs to bug crbug.com/943899.\n\nIn sum, I think you can land this change first as it is (uint64).\nWe can update this part later when we land 3 with CQ-DEPEND and there shouldn\u0027t be anything broken.\n\nPlease let me know if the plan looks sane to you.\nThanks!\n\n[1] https://cs.corp.google.com/chromeos_public/src/third_party/adhd/cras/src/libcras/cras_client.c?q\u003dcras_client+package:%5Echromeos_public$\u0026dr\u003dCSs\u0026l\u003d3175\n[2]\nhttps://cs.corp.google.com/chromeos_public/src/third_party/adhd/cras/README.dbus-api?l\u003d219\n[3]\nhttps://cs.corp.google.com/chromeos_public/src/third_party/adhd/cras/src/server/cras_dbus_control.c?q\u003dadhd+cras_dbus_control.c+package:%5Echromeos_public$\u0026dr\u0026l\u003d507\n[4] https://cs.chromium.org/chromium/src/chromeos/dbus/cras_audio_client.cc?type\u003dcs\u0026q\u003d+kOutputNodeVolumeChange++package:%5Echromium$\u0026g\u003d0\u0026l\u003d382",
      "parentUuid": "1720b224_48d7ef04",
      "range": {
        "startLine": 72,
        "startChar": 12,
        "endLine": 72,
        "endChar": 18
      },
      "revId": "22a2c23241ac3969a33f7cb12a4c84d964e7dc06",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "39c05e2d_4902a6ed",
        "filename": "src/chromiumos/tast/local/audio/cras.go",
        "patchSetId": 1
      },
      "lineNbr": 72,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-03-20T03:24:27Z",
      "side": 1,
      "message": "thanks for investigating this! your plan sounds good to me.",
      "parentUuid": "b9e0061e_6da2963b",
      "range": {
        "startLine": 72,
        "startChar": 12,
        "endLine": 72,
        "endChar": 18
      },
      "revId": "22a2c23241ac3969a33f7cb12a4c84d964e7dc06",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f5ff95e5_2ab808b0",
        "filename": "src/chromiumos/tast/local/audio/cras.go",
        "patchSetId": 1
      },
      "lineNbr": 107,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-03-19T20:10:58Z",
      "side": 1,
      "message": "nit: delete this \u0027is\u0027 to match the code above",
      "range": {
        "startLine": 107,
        "startChar": 43,
        "endLine": 107,
        "endChar": 45
      },
      "revId": "22a2c23241ac3969a33f7cb12a4c84d964e7dc06",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}