{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "e24be9b7_dee8a052",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1243287
      },
      "writtenOn": "2022-10-11T23:21:20Z",
      "side": 1,
      "message": "I prefer using channels that are non-DFS everywhere to enforcing a certain regdom for all tests, especially since these tests don\u0027t have anything to do with the channel that we\u0027ve arbitrarily chosen for them. lmk if you disagree",
      "revId": "44b7f6478ba7e9bb55ce8d6a819b22098d349bc5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5e346f2d_4fd7966e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1432127
      },
      "writtenOn": "2022-10-12T00:07:41Z",
      "side": 1,
      "message": "Hi Matthew, the issue here isn\u0027t that DFS channels are used. It\u0027s that given the regulatory setting, the channel used (which isn\u0027t DFS), is considered a no IR channel (cannot radiate first). \n\nIf we were to consider the union of the 2 zones (US and 00), we would only have 4 possible channels to transmit on: \n\n                        * 5180 MHz [36] (23.0 dBm)\n                        * 5200 MHz [40] (23.0 dBm)\n                        * 5220 MHz [44] (23.0 dBm)\n                        * 5240 MHz [48] (23.0 dBm)\nThe other other channels are either at least no IR (perhaps also DFS channels) or disabled entirely at least on openwrt.\n\nWhen we look at gales, having DFS-UNSET doesn\u0027t have this limitation where most channels can\u0027t be transmitted on:\n\n                        * 5180 MHz [36] (23.0 dBm)\n                        * 5200 MHz [40] (23.0 dBm)\n                        * 5220 MHz [44] (23.0 dBm)\n                        * 5240 MHz [48] (23.0 dBm)\n                        * 5260 MHz [52] (23.0 dBm)\n                        * 5280 MHz [56] (23.0 dBm)\n                        * 5300 MHz [60] (23.0 dBm)\n                        * 5320 MHz [64] (23.0 dBm)\n                        * 5500 MHz [100] (23.0 dBm)\n                        * 5520 MHz [104] (23.0 dBm)\n                        * 5540 MHz [108] (23.0 dBm)\n                        * 5560 MHz [112] (23.0 dBm)\n                        * 5580 MHz [116] (23.0 dBm)\n                        * 5600 MHz [120] (23.0 dBm)\n                        * 5620 MHz [124] (23.0 dBm)\n                        * 5640 MHz [128] (23.0 dBm)\n                        * 5660 MHz [132] (23.0 dBm)\n                        * 5680 MHz [136] (23.0 dBm)\n                        * 5700 MHz [140] (23.0 dBm)\n                        * 5720 MHz [144] (23.0 dBm)\n                        * 5745 MHz [149] (23.0 dBm)\n                        * 5765 MHz [153] (23.0 dBm)\n                        * 5785 MHz [157] (23.0 dBm)\n                        * 5805 MHz [161] (23.0 dBm)\n                        * 5825 MHz [165] (23.0 dBm)\n                        \nThese channels are all allowed on gale.",
      "parentUuid": "e24be9b7_dee8a052",
      "revId": "44b7f6478ba7e9bb55ce8d6a819b22098d349bc5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4755c165_0b29a956",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1243287
      },
      "writtenOn": "2022-10-12T00:14:47Z",
      "side": 1,
      "message": "My point is that we shouldn\u0027t be using channels that are no IR if there\u0027s no reason to. If there are 4 channels that are in the intersection(?) of the two zones, then can we just pick one of those instead?",
      "parentUuid": "5e346f2d_4fd7966e",
      "revId": "44b7f6478ba7e9bb55ce8d6a819b22098d349bc5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "82ac0b82_468c3f3a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1432127
      },
      "writtenOn": "2022-10-12T00:40:37Z",
      "side": 1,
      "message": "I\u0027m still hesitant to go through with only limiting our channels on DFS-UNSET to channels 36-48. This precedent will carry to throughput tests as well (we are actively porting them over and they will also use openwrt), and I think there are non-zero amount of issues in our stack that have had channel specific issues.\n\nHere\u0027s a bug that affected specific channels that was detected on a (no-IR) channel with respect to openwrt to illustrate my concern in a coverage reduction https://b.corp.google.com/issues/170832071 (this is a throughput test). By only testing low band 5ghz, we lose out on coverage of mid and high band 5ghz channels which may behave differently.\n\nI think that if we\u0027re running tests in the US, it\u0027s permissible to have our reg domain also be set to US. Presumably, other ramifications such as tx power will be more representative of the US test environment as well.",
      "parentUuid": "4755c165_0b29a956",
      "revId": "44b7f6478ba7e9bb55ce8d6a819b22098d349bc5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "baf0946c_e602efff",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1243287
      },
      "writtenOn": "2022-10-12T03:07:13Z",
      "side": 1,
      "message": "That\u0027s a valid concern, but in general, I don\u0027t think we should rely on the fact that we happened to choose specific channels for certain tests. That doesn\u0027t pass as adequate coverage. In an ideal world with infinite resources, we\u0027d test operation on every channel, but given that that\u0027s not practical, diversifying channel choice in tests will have to do for now.\n\n\u003e I think that if we\u0027re running tests in the US, it\u0027s permissible to have our reg domain also be set to US.\n\nI disagree with this. We ship devices worldwide, and running all of our functional tests with US regulatory intentionally blinds ourselves to non-US regulatory issues.\n\nInstead of doing this for all functional tests, I\u0027d be fine with only doing this for tests that use no IR channels. How does that sound?\n\nRelated question: What\u0027s the default regdom for gale APs? Why don\u0027t we have this problem there?",
      "parentUuid": "82ac0b82_468c3f3a",
      "revId": "44b7f6478ba7e9bb55ce8d6a819b22098d349bc5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "519f14f3_c7d3889b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1432127
      },
      "writtenOn": "2022-10-12T20:39:00Z",
      "side": 1,
      "message": "After looking at the test fixture code again, it looks like the gale router is forced to the US reg domain during the init step. src/platform/tast-tests/src/chromiumos/tast/remote/wificell/router/legacy/router.go line 155\n\n```\n\tif err :\u003d r.iwr.SetRegulatoryDomain(shortCtx, \"US\"); err !\u003d nil {\n\t\tr.Close(shortCtx)\n\t\treturn nil, errors.Wrap(err, \"failed to set regulatory domain to US\")\n\t}\n```\n\nJared has tested doing something similar for openwrt which works (and thus we won\u0027t need to modify hostapd arbitrarily and I can abandon this cl). \n\nThis doesn\u0027t address the concern about non-US regulatory coverage however. It looks like we have a coverage gap, but this coverage gap is discussed in a doc I message you offline about.",
      "parentUuid": "baf0946c_e602efff",
      "revId": "44b7f6478ba7e9bb55ce8d6a819b22098d349bc5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ff08a9c6_a4cf660d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1243287
      },
      "writtenOn": "2022-10-12T21:12:50Z",
      "side": 1,
      "message": "Oh interesting, so we set the regdom but we don\u0027t configure hostapd to advertise the country code IE, that sounds not great. In any case, I think we can just defer regulatory test coverage improvements to whenever we find room to implement Nicolas\u0027 doc.",
      "parentUuid": "519f14f3_c7d3889b",
      "revId": "44b7f6478ba7e9bb55ce8d6a819b22098d349bc5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ],
  "submitRequirementResults": [
    {
      "submitRequirement": {
        "name": "Code-Owners",
        "description": {
          "value": "User with the code owner override approved the change"
        },
        "applicabilityExpression": {
          "value": {
            "expressionString": "has:enabled_code-owners"
          }
        },
        "submittabilityExpression": {
          "expressionString": "has:approval_code-owners"
        },
        "overrideExpression": {
          "value": {
            "expressionString": "label:Owners-Override\u003d+1"
          }
        },
        "allowOverrideInChildProjects": true
      },
      "applicabilityExpressionResult": {
        "value": {"expression":{"expressionString":"has:enabled_code-owners"},"status":"PASS","errorMessage":{"value":null},"passingAtoms":["has:enabled_code-owners"],"failingAtoms":[]}
      },
      "submittabilityExpressionResult": {
        "value": {"expression":{"expressionString":"has:approval_code-owners"},"status":"FAIL","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":["has:approval_code-owners"]}
      },
      "overrideExpressionResult": {
        "value": {"expression":{"expressionString":"label:Owners-Override=+1"},"status":"FAIL","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":["label:Owners-Override=+1"]}
      },
      "patchSetCommitId": "44b7f6478ba7e9bb55ce8d6a819b22098d349bc5",
      "legacy": {
        "value": false
      },
      "forced": {},
      "hidden": {}
    },
    {
      "submitRequirement": {
        "name": "Code-Review",
        "description": {
          "value": "Submit requirement for the \u0027Code-Review\u0027 label"
        },
        "applicabilityExpression": {},
        "submittabilityExpression": {
          "expressionString": "label:Code-Review\u003dMAX,user\u003dnon_uploader -label:Code-Review\u003dMIN"
        },
        "overrideExpression": {
          "value": {
            "expressionString": "label:Bot-Commit\u003d+1"
          }
        },
        "allowOverrideInChildProjects": true
      },
      "applicabilityExpressionResult": {},
      "submittabilityExpressionResult": {
        "value": {"expression":{"expressionString":"label:Code-Review=MAX,user=non_uploader -label:Code-Review=MIN"},"status":"FAIL","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":["label:Code-Review=MAX,user=non_uploader","label:Code-Review=MIN"]}
      },
      "overrideExpressionResult": {
        "value": {"expression":{"expressionString":"label:Bot-Commit=+1"},"status":"FAIL","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":["label:Bot-Commit=+1"]}
      },
      "patchSetCommitId": "44b7f6478ba7e9bb55ce8d6a819b22098d349bc5",
      "legacy": {
        "value": false
      },
      "forced": {},
      "hidden": {}
    },
    {
      "submitRequirement": {
        "name": "Review-Enforcement",
        "description": {
          "value": "Two Google employees must approve the change. Uploading the change or voting positively on Code-Review count as approval."
        },
        "applicabilityExpression": {
          "value": {
            "expressionString": "is:review-enforced_gerrit"
          }
        },
        "submittabilityExpression": {
          "expressionString": "is:review-enforcement-satisfied_gerrit"
        },
        "overrideExpression": {},
        "allowOverrideInChildProjects": false
      },
      "applicabilityExpressionResult": {
        "value": {"expression":{"expressionString":"is:review-enforced_gerrit"},"status":"FAIL","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":["is:review-enforced_gerrit"]}
      },
      "submittabilityExpressionResult": {
        "value": {"expression":{"expressionString":"is:review-enforcement-satisfied_gerrit"},"status":"NOT_EVALUATED","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":[]}
      },
      "overrideExpressionResult": {},
      "patchSetCommitId": "44b7f6478ba7e9bb55ce8d6a819b22098d349bc5",
      "legacy": {
        "value": false
      },
      "forced": {},
      "hidden": {}
    },
    {
      "submitRequirement": {
        "name": "Verified",
        "description": {
          "value": "CI or human verified the change"
        },
        "applicabilityExpression": {},
        "submittabilityExpression": {
          "expressionString": "label:Verified\u003dMAX AND -label:Verified\u003dMIN"
        },
        "overrideExpression": {
          "value": {
            "expressionString": "label:Bot-Commit\u003d+1"
          }
        },
        "allowOverrideInChildProjects": true
      },
      "applicabilityExpressionResult": {},
      "submittabilityExpressionResult": {
        "value": {"expression":{"expressionString":"label:Verified=MAX AND -label:Verified=MIN"},"status":"FAIL","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":["label:Verified=MAX","label:Verified=MIN"]}
      },
      "overrideExpressionResult": {
        "value": {"expression":{"expressionString":"label:Bot-Commit=+1"},"status":"FAIL","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":["label:Bot-Commit=+1"]}
      },
      "patchSetCommitId": "44b7f6478ba7e9bb55ce8d6a819b22098d349bc5",
      "legacy": {
        "value": false
      },
      "forced": {},
      "hidden": {}
    }
  ]
}