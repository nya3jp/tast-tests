{
  "comments": [
    {
      "key": {
        "uuid": "13aee6f6_bbbec9fb",
        "filename": "src/chromiumos/tast/local/bundles/cros/dbus/signal_watcher_close.go",
        "patchSetId": 6
      },
      "lineNbr": 5,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2019-11-06T04:11:09Z",
      "side": 1,
      "message": "This is the first file in dbus package. How about having a doc.go as a package document placeholder? (like https://chromium.git.corp.google.com/chromiumos/platform/tast-tests/+/ecbb805a068beb36373c35401b9be8e48eb875e6/src/chromiumos/tast/local/bundles/cros/network/doc.go#)",
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5d4c06e7_6bb08af2",
        "filename": "src/chromiumos/tast/local/bundles/cros/dbus/signal_watcher_close.go",
        "patchSetId": 6
      },
      "lineNbr": 5,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2019-11-06T06:01:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "13aee6f6_bbbec9fb",
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "edc2e155_97f62271",
        "filename": "src/chromiumos/tast/local/bundles/cros/dbus/signal_watcher_close.go",
        "patchSetId": 6
      },
      "lineNbr": 20,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2019-11-06T04:11:09Z",
      "side": 1,
      "message": "be closed properly",
      "range": {
        "startLine": 20,
        "startChar": 49,
        "endLine": 20,
        "endChar": 63
      },
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "17acb6d8_fa33fd0b",
        "filename": "src/chromiumos/tast/local/bundles/cros/dbus/signal_watcher_close.go",
        "patchSetId": 6
      },
      "lineNbr": 20,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2019-11-06T06:01:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "edc2e155_97f62271",
      "range": {
        "startLine": 20,
        "startChar": 49,
        "endLine": 20,
        "endChar": 63
      },
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "be9408c6_d6ff0702",
        "filename": "src/chromiumos/tast/local/bundles/cros/dbus/signal_watcher_close.go",
        "patchSetId": 6
      },
      "lineNbr": 21,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2019-11-06T02:51:13Z",
      "side": 1,
      "message": "Not sure which group is more suitable for this test. As the problem is found in shill, I use wifi team for now.",
      "range": {
        "startLine": 21,
        "startChar": 45,
        "endLine": 21,
        "endChar": 78
      },
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5b806d27_07dfe8ce",
        "filename": "src/chromiumos/tast/local/bundles/cros/dbus/signal_watcher_close.go",
        "patchSetId": 6
      },
      "lineNbr": 21,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2019-11-06T04:11:09Z",
      "side": 1,
      "message": "Seems either chromeos-kernel-wifi@ or cros-networking@ are fine.\n\nhttps://chromium.git.corp.google.com/chromiumos/platform/tast-tests/+/ecbb805a068beb36373c35401b9be8e48eb875e6/src/chromiumos/tast/local/bundles/cros/network/ethernet_static_ip.go\n\nhttps://chromium.git.corp.google.com/chromiumos/platform/tast-tests/+/ecbb805a068beb36373c35401b9be8e48eb875e6/src/chromiumos/tast/local/bundles/cros/network/two_shills.go",
      "parentUuid": "be9408c6_d6ff0702",
      "range": {
        "startLine": 21,
        "startChar": 45,
        "endLine": 21,
        "endChar": 78
      },
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4f976fe8_c51092f5",
        "filename": "src/chromiumos/tast/local/bundles/cros/dbus/signal_watcher_close.go",
        "patchSetId": 6
      },
      "lineNbr": 59,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2019-11-06T04:11:09Z",
      "side": 1,
      "message": "a signal",
      "range": {
        "startLine": 59,
        "startChar": 29,
        "endLine": 59,
        "endChar": 35
      },
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d8e1a8cd_f2bbd1db",
        "filename": "src/chromiumos/tast/local/bundles/cros/dbus/signal_watcher_close.go",
        "patchSetId": 6
      },
      "lineNbr": 59,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2019-11-06T04:11:09Z",
      "side": 1,
      "message": "s.Fatal(\"\"Failed to create a signal emitter bus: \", err)\n\nhttps://chromium.googlesource.com/chromiumos/platform/tast/+/HEAD/docs/writing_tests.md#log_error_fatal-vs_logf_errorf_fatalf",
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a095153b_c11eee4e",
        "filename": "src/chromiumos/tast/local/bundles/cros/dbus/signal_watcher_close.go",
        "patchSetId": 6
      },
      "lineNbr": 59,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2019-11-06T06:01:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d8e1a8cd_f2bbd1db",
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7bb785f0_720991b3",
        "filename": "src/chromiumos/tast/local/bundles/cros/dbus/signal_watcher_close.go",
        "patchSetId": 6
      },
      "lineNbr": 59,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2019-11-06T06:01:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "4f976fe8_c51092f5",
      "range": {
        "startLine": 59,
        "startChar": 29,
        "endLine": 59,
        "endChar": 35
      },
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4f42eda8_cc149823",
        "filename": "src/chromiumos/tast/local/bundles/cros/dbus/signal_watcher_close.go",
        "patchSetId": 6
      },
      "lineNbr": 62,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2019-11-06T04:11:09Z",
      "side": 1,
      "message": "We may have blank line between logical code blocks.",
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4f84a3fa_d43e9f47",
        "filename": "src/chromiumos/tast/local/bundles/cros/dbus/signal_watcher_close.go",
        "patchSetId": 6
      },
      "lineNbr": 62,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2019-11-06T06:01:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "4f42eda8_cc149823",
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "342c3292_419798c5",
        "filename": "src/chromiumos/tast/local/bundles/cros/dbus/signal_watcher_close.go",
        "patchSetId": 6
      },
      "lineNbr": 64,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2019-11-06T04:11:09Z",
      "side": 1,
      "message": "same, and below",
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0e2ac4af_266f6447",
        "filename": "src/chromiumos/tast/local/bundles/cros/dbus/signal_watcher_close.go",
        "patchSetId": 6
      },
      "lineNbr": 64,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2019-11-06T06:01:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "342c3292_419798c5",
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bd8ba965_9aaaa89f",
        "filename": "src/chromiumos/tast/local/bundles/cros/dbus/signal_watcher_close.go",
        "patchSetId": 6
      },
      "lineNbr": 68,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2019-11-06T04:11:09Z",
      "side": 1,
      "message": "Match the precise spec",
      "range": {
        "startLine": 68,
        "startChar": 4,
        "endLine": 68,
        "endChar": 25
      },
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "10512a87_64b8171f",
        "filename": "src/chromiumos/tast/local/bundles/cros/dbus/signal_watcher_close.go",
        "patchSetId": 6
      },
      "lineNbr": 68,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2019-11-06T06:01:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "bd8ba965_9aaaa89f",
      "range": {
        "startLine": 68,
        "startChar": 4,
        "endLine": 68,
        "endChar": 25
      },
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "61e9f404_fa075c11",
        "filename": "src/chromiumos/tast/local/bundles/cros/dbus/signal_watcher_close.go",
        "patchSetId": 6
      },
      "lineNbr": 131,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2019-11-06T04:11:09Z",
      "side": 1,
      "message": "Would the goroutine (line 111-116) still running when code goes here?",
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c2e44df0_1d6d6a1f",
        "filename": "src/chromiumos/tast/local/bundles/cros/dbus/signal_watcher_close.go",
        "patchSetId": 6
      },
      "lineNbr": 131,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2019-11-06T06:01:55Z",
      "side": 1,
      "message": "If deadlock happens, closeCtx.Done() in line 121 is selected and the goroutine still stucks in watcher.Close(). In this case, draining the channel (line 127) may release the deadlock and make watcher.Close() go on, but it may not yet finish when main thread reaches here.",
      "parentUuid": "61e9f404_fa075c11",
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "40ba450c_4e501163",
        "filename": "src/chromiumos/tast/local/dbusutil/signal.go",
        "patchSetId": 6
      },
      "lineNbr": 62,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2019-11-06T06:33:45Z",
      "side": 1,
      "message": "Add a comment \n// Matching goroutine.",
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "81e18370_0f51b0c9",
        "filename": "src/chromiumos/tast/local/dbusutil/signal.go",
        "patchSetId": 6
      },
      "lineNbr": 62,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2019-11-06T08:06:58Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "40ba450c_4e501163",
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0d71636f_7ee9bbfc",
        "filename": "src/chromiumos/tast/local/dbusutil/signal.go",
        "patchSetId": 6
      },
      "lineNbr": 101,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2019-11-06T06:33:45Z",
      "side": 1,
      "message": "How about rephrasing the comment:\n\nStop retrieving and filter signals from sw.conn.\nTo stop watching signals from conn, i.e. sw.conn.RemoveSignal(sw.allSigs), we first need to consume sw.Signals to avoid the case that sw.Signals is full and is blocking conn dispatching goroutine. To avoid deadlock, the following signal consuming goroutine must be run before RemoveSignal(sw.allSigs) is called.",
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "75343b2b_0873e56c",
        "filename": "src/chromiumos/tast/local/dbusutil/signal.go",
        "patchSetId": 6
      },
      "lineNbr": 101,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2019-11-06T08:06:58Z",
      "side": 1,
      "message": "As the information is similar to the one in next step, so I merge them together.",
      "parentUuid": "0d71636f_7ee9bbfc",
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "27ed10b6_7900f1b5",
        "filename": "src/chromiumos/tast/local/dbusutil/signal.go",
        "patchSetId": 6
      },
      "lineNbr": 105,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2019-11-06T06:33:45Z",
      "side": 1,
      "message": "This can be reword and move just before line 115:\n\nThe consumption goroutine will be terminated when sw.Signals is closed, which is called at the last step of the matching goroutine, which is triggered by the closing of sw.allSigs, i.e. conn.Close() or right after running the matching goroutine.",
      "range": {
        "startLine": 104,
        "startChar": 4,
        "endLine": 105,
        "endChar": 23
      },
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "590a8f66_e9be2508",
        "filename": "src/chromiumos/tast/local/dbusutil/signal.go",
        "patchSetId": 6
      },
      "lineNbr": 105,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2019-11-06T08:06:58Z",
      "side": 1,
      "message": "Done, but sw.allSigs is in fact closed in this function (line 121). rephrase a little bit.",
      "parentUuid": "27ed10b6_7900f1b5",
      "range": {
        "startLine": 104,
        "startChar": 4,
        "endLine": 105,
        "endChar": 23
      },
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3eaf8d5e_2f8f6412",
        "filename": "src/chromiumos/tast/local/dbusutil/signal.go",
        "patchSetId": 6
      },
      "lineNbr": 106,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2019-11-06T06:33:45Z",
      "side": 1,
      "message": "sw.allSigs",
      "range": {
        "startLine": 106,
        "startChar": 17,
        "endLine": 106,
        "endChar": 28
      },
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4d827f8b_e345cd81",
        "filename": "src/chromiumos/tast/local/dbusutil/signal.go",
        "patchSetId": 6
      },
      "lineNbr": 106,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2019-11-06T08:06:58Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3eaf8d5e_2f8f6412",
      "range": {
        "startLine": 106,
        "startChar": 17,
        "endLine": 106,
        "endChar": 28
      },
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b205f6c9_edc63da8",
        "filename": "src/chromiumos/tast/local/dbusutil/signal.go",
        "patchSetId": 6
      },
      "lineNbr": 107,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2019-11-06T04:11:09Z",
      "side": 1,
      "message": "which",
      "range": {
        "startLine": 107,
        "startChar": 55,
        "endLine": 107,
        "endChar": 56
      },
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "effe7dc6_2184077c",
        "filename": "src/chromiumos/tast/local/dbusutil/signal.go",
        "patchSetId": 6
      },
      "lineNbr": 107,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2019-11-06T06:01:55Z",
      "side": 1,
      "message": "I guess this might be ok?\nThe method takes a lock\nand\na dispatcher goroutine takes its read lock.\n(but I misspelled dispatcher :p)",
      "parentUuid": "b205f6c9_edc63da8",
      "range": {
        "startLine": 107,
        "startChar": 55,
        "endLine": 107,
        "endChar": 56
      },
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a664cc01_c012ef01",
        "filename": "src/chromiumos/tast/local/dbusutil/signal.go",
        "patchSetId": 6
      },
      "lineNbr": 107,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2019-11-06T06:33:45Z",
      "side": 1,
      "message": "Sorry that I parse the sentence wrong. Ignore it.",
      "parentUuid": "b205f6c9_edc63da8",
      "range": {
        "startLine": 107,
        "startChar": 55,
        "endLine": 107,
        "endChar": 56
      },
      "revId": "d6b19cc7d3ea4a868423a08e12faac65930ed24b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}