{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "4409f05c_b5a38d62",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1403852
      },
      "writtenOn": "2022-08-24T00:07:28Z",
      "side": 1,
      "message": "Hi Toby Please review this CL thanks!",
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5f1fe75f_9942c449",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1351120
      },
      "writtenOn": "2022-08-24T19:08:49Z",
      "side": 1,
      "message": "Thanks for working on this. We had crash bugs from this in the past, so it\u0027s good to add a test to prevent regressions.",
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "25e01866_ca28358b",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 105,
      "author": {
        "id": 1351120
      },
      "writtenOn": "2022-08-24T19:08:49Z",
      "side": 1,
      "message": "Nit: Could you simplify this to testProjectorEnabled?",
      "range": {
        "startLine": 105,
        "startChar": 5,
        "endLine": 105,
        "endChar": 29
      },
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3ebf3a2c_4e4d6df3",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 105,
      "author": {
        "id": 1403852
      },
      "writtenOn": "2022-08-26T21:56:16Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "25e01866_ca28358b",
      "range": {
        "startLine": 105,
        "startChar": 5,
        "endLine": 105,
        "endChar": 29
      },
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "09db67ec_505b926b",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 110,
      "author": {
        "id": 1351120
      },
      "writtenOn": "2022-08-24T19:08:49Z",
      "side": 1,
      "message": "Nit: consider return errors.Wrap(err, \"failed to list registered apps\")",
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2509f8f8_f12fd448",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 110,
      "author": {
        "id": 1403852
      },
      "writtenOn": "2022-08-26T21:56:16Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "09db67ec_505b926b",
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "492ae814_adcd6574",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 127,
      "author": {
        "id": 1351120
      },
      "writtenOn": "2022-08-24T19:08:49Z",
      "side": 1,
      "message": "Should you return here?",
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e43a2a73_58e9346d",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 127,
      "author": {
        "id": 1403852
      },
      "writtenOn": "2022-08-26T21:56:16Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "492ae814_adcd6574",
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "93a4c2e7_d8e9a3d0",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 145,
      "author": {
        "id": 1351120
      },
      "writtenOn": "2022-08-24T19:08:49Z",
      "side": 1,
      "message": "Should you wait here for the Projector app to close? Something like\n\nui.WaitUntilGone(screencastAppWindow)",
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3dcf3e53_da96088b",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 145,
      "author": {
        "id": 1403852
      },
      "writtenOn": "2022-08-26T21:56:16Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "93a4c2e7_d8e9a3d0",
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5d62b5fe_ef0a9c16",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 153,
      "author": {
        "id": 1351120
      },
      "writtenOn": "2022-08-24T19:08:49Z",
      "side": 1,
      "message": "Use LaunchApp() so we don\u0027t need to use a keyboard (which is notoriously flaky).",
      "range": {
        "startLine": 153,
        "startChar": 20,
        "endLine": 153,
        "endChar": 35
      },
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c0d02859_37cb852c",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 153,
      "author": {
        "id": 1403852
      },
      "writtenOn": "2022-08-26T21:56:16Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5d62b5fe_ef0a9c16",
      "range": {
        "startLine": 153,
        "startChar": 20,
        "endLine": 153,
        "endChar": 35
      },
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "083b2130_63f72092",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 157,
      "author": {
        "id": 1351120
      },
      "writtenOn": "2022-08-24T19:08:49Z",
      "side": 1,
      "message": "Could you use uiauto.Combine() [1] to combine many of these actions into one block so it\u0027s easier to read?\n\n[1] go/tast-codelab-3",
      "range": {
        "startLine": 157,
        "startChar": 13,
        "endLine": 157,
        "endChar": 28
      },
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "578c3049_ab6132a7",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 157,
      "author": {
        "id": 1403852
      },
      "writtenOn": "2022-08-26T21:56:16Z",
      "side": 1,
      "message": "Cool idea!",
      "parentUuid": "083b2130_63f72092",
      "range": {
        "startLine": 157,
        "startChar": 13,
        "endLine": 157,
        "endChar": 28
      },
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "21deea69_dd73bde1",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 161,
      "author": {
        "id": 1351120
      },
      "writtenOn": "2022-08-24T19:08:49Z",
      "side": 1,
      "message": "I wonder if it\u0027s more robust to do\n\nui.WithInterval(time.Second).LeftClickUntil(okButton, ui.Gone(blockedWindowFinder))\n\nbecause hitting the enter key one time might not do the trick. This way has the benefit of clicking multiple times, if necessary, until the dialog closes, especially since leaving the dialog behind might affect later tests.",
      "range": {
        "startLine": 161,
        "startChar": 9,
        "endLine": 161,
        "endChar": 31
      },
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4c130a2c_995a710c",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 161,
      "author": {
        "id": 1403852
      },
      "writtenOn": "2022-08-26T21:56:16Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "21deea69_dd73bde1",
      "range": {
        "startLine": 161,
        "startChar": 9,
        "endLine": 161,
        "endChar": 31
      },
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "689ee4c2_7fcaa478",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 166,
      "author": {
        "id": 1351120
      },
      "writtenOn": "2022-08-24T19:08:49Z",
      "side": 1,
      "message": "Nit: affect",
      "range": {
        "startLine": 166,
        "startChar": 93,
        "endLine": 166,
        "endChar": 99
      },
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ef7548d9_d4aa73cd",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 166,
      "author": {
        "id": 1403852
      },
      "writtenOn": "2022-08-26T21:56:16Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "689ee4c2_7fcaa478",
      "range": {
        "startLine": 166,
        "startChar": 93,
        "endLine": 166,
        "endChar": 99
      },
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9c9cd93b_ab765f84",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 173,
      "author": {
        "id": 1351120
      },
      "writtenOn": "2022-08-24T19:08:49Z",
      "side": 1,
      "message": "Nit: Could you rename this to testProjectorDisabled?",
      "range": {
        "startLine": 173,
        "startChar": 5,
        "endLine": 173,
        "endChar": 30
      },
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e2e02861_c710a3dc",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 173,
      "author": {
        "id": 1403852
      },
      "writtenOn": "2022-08-26T21:56:16Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9c9cd93b_ab765f84",
      "range": {
        "startLine": 173,
        "startChar": 5,
        "endLine": 173,
        "endChar": 30
      },
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d43dfe2b_3368ae13",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 174,
      "author": {
        "id": 1351120
      },
      "writtenOn": "2022-08-24T19:08:49Z",
      "side": 1,
      "message": "Instead of doing this, I wonder if it\u0027s better to WaitForChromeAppInstalled(Projector.ID, time.Minute) and expect an error. \n\nIf you detect that the Projector SWA is not installed like this, it could be due to a race condition where this test proceeded too quickly before *any* SWA has installed. If we wait a minute or two for the Projector SWA to install, then we can be sure that the Projector SWA didn\u0027t install.",
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e9ce6802_c2a3d352",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 174,
      "author": {
        "id": 1403852
      },
      "writtenOn": "2022-08-26T21:56:16Z",
      "side": 1,
      "message": "I am thinking about removing this section.\nThe testing.Poll()(in WaitForChromeAppInstalled) should only be used as a last resort when there\u0027s no other way to watch for an event[1]. \n\nWe verifies the Screencast is not in the app registry. \n@Yilkal: since you work for app time limit before, could we assume that if a app is not in the app registry, the app will never be installed? \n\n\n[1] https://source.chromium.org/chromiumos/chromiumos/codesearch/+/main:src/platform/tast/src/chromiumos/tast/testing/util.go;l\u003d37;drc\u003de2fe706ffdd02eb70704b8a3b0a72215ef08c147",
      "parentUuid": "d43dfe2b_3368ae13",
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "df04b04b_a66dc99c",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 174,
      "author": {
        "id": 1351120
      },
      "writtenOn": "2022-08-29T18:58:55Z",
      "side": 1,
      "message": "Should we just ping Yilkal with this question in chat for a quicker response?\n\nThat comment above Poll() is true, but we still use polling all the time anyway in our Tast tests to wait for something to happen, such a pref to sync. If we don\u0027t have to wait to verify that the SWA is not installed, then great, but if we have to wait, then I don\u0027t think it\u0027s a problem to use WaitForChromeAppInstalled() and polling.",
      "parentUuid": "e9ce6802_c2a3d352",
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b47b4905_9cae03f3",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 174,
      "author": {
        "id": 1332928
      },
      "writtenOn": "2022-08-30T02:05:23Z",
      "side": 1,
      "message": "hmm this is an interesting problem\n\nThe code that we are calling i.e. ChromeAppInstalled calls into AppRegistryCache here [1].\n\nMy understanding is that upon startup AppRegistryCache can be empty and all the AppPublishers notify the registry about the applications that they have. \n\nNow the main question is if we start chrome with the policy disabled, will the AppRegistryCache even be informed about projector by the web app provider?\n\nLooking at the code: If the SWA is disabled, then it\u0027s ProjectorSystemWebAppDelegate will not be part of the delegate_map returned here [2], which means the delegate actually gets destroyed and the app will not be installed [3].\n\nI think some other SWAs manage this behavior better by installing in a disabled state [4], maybe Projector should do the same.\n\n[1] https://source.chromium.org/chromium/chromium/src/+/main:chrome/browser/chromeos/extensions/autotest_private/autotest_private_api.cc;drc\u003d956d134255a8bb1ad5456c7cfa35097372cebbfa;l\u003d3755\n\n[2] https://source.chromium.org/chromium/chromium/src/+/main:chrome/browser/ash/system_web_apps/system_web_app_manager.cc;drc\u003d206fd5e4a12226776e734e38871d12e83bed6a6d;l\u003d154\n\n[3] https://source.chromium.org/chromium/chromium/src/+/main:chrome/browser/ash/system_web_apps/types/system_web_app_delegate.h;drc\u003d31587bb18cb168cd44e69edcab075951820746ce;l\u003d151\n\n[4] https://source.chromium.org/chromium/chromium/src/+/main:chrome/browser/web_applications/policy/web_app_policy_manager.cc;drc\u003d956d134255a8bb1ad5456c7cfa35097372cebbfa;l\u003d657",
      "parentUuid": "df04b04b_a66dc99c",
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ac21c89c_62273a7d",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 183,
      "author": {
        "id": 1351120
      },
      "writtenOn": "2022-08-24T19:08:49Z",
      "side": 1,
      "message": "Nit: consider return errors.Wrap(err, \"failed to list registered apps\")",
      "range": {
        "startLine": 183,
        "startChar": 9,
        "endLine": 183,
        "endChar": 12
      },
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "eed2d3cc_f8d66f23",
        "filename": "src/chromiumos/tast/local/bundles/cros/projector/enabled_policy.go",
        "patchSetId": 3
      },
      "lineNbr": 183,
      "author": {
        "id": 1403852
      },
      "writtenOn": "2022-08-26T21:56:16Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ac21c89c_62273a7d",
      "range": {
        "startLine": 183,
        "startChar": 9,
        "endLine": 183,
        "endChar": 12
      },
      "revId": "e1e4d9d7d7e99d59fe3dc71fe08dc2d31fe41006",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}