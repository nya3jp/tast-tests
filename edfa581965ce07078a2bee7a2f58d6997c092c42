{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "cc4bfeeb_96e7d000",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1288602
      },
      "writtenOn": "2021-12-09T02:24:17Z",
      "side": 1,
      "message": "Hi Tast owners, it seems I have to write the ARCVM config when a fixture is created, rather than when Setup() is called. Is this acceptable or do you have a better suggestion? Thanks!",
      "revId": "edfa581965ce07078a2bee7a2f58d6997c092c42",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "de5b8eb8_e94f188a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1413373
      },
      "writtenOn": "2021-12-09T23:29:19Z",
      "side": 1,
      "message": "Just rewriting to make sure I understand your problem correctly:\narcvm_dev.conf needs to have flags written PRIOR to arcvm booting but you\u0027re finding when putting the code in the fixture it is happening too late?\nOne potential solution here is to take in a chrome.Option that takes arbitrary arcvm_dev configuration options and writes them out to a file. Much like chrome.EnableFeatures\n\nI\u0027m wondering if the configuration options that you\u0027re writing to arcvm_dev.conf are also exposable by flags, are you able to use chrome.ExtraArgs?",
      "parentUuid": "cc4bfeeb_96e7d000",
      "revId": "edfa581965ce07078a2bee7a2f58d6997c092c42",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "efad753e_c12cdcac",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1288602
      },
      "writtenOn": "2021-12-10T00:48:08Z",
      "side": 1,
      "message": "Hi Ben, thanks for the quick reply!\n\nI need to have some flags written to arcvm_dev.conf before crosvm starts. It\u0027s too late if I write the config in the fixture\u0027s Setup() function, it works fine when I write the config upon creating the fixture in NewArcBootedWithConfigFixture(). I\u0027m trying to figure out if that\u0027s an acceptable thing to do.\n\nchrome.ExtraArgs doesn\u0027t seem to work here as these flags are specific to arcvm and need to end up in arcvm_dev.conf.\n\nThe closest example I found is: https://source.corp.google.com/chromeos_public/src/platform/tast-tests/src/chromiumos/tast/local/bundles/cros/arc/boot.go;l\u003d116\n\nThis test doesn\u0027t use any fixture and boots Chrome manually. But I want to avoid having to manually reconstruct the entire process used to bring up Chrome and ARCVM in the \"arcBootedWithVideoLogging\" fixture. I just want to write an additional flag to arcvm_dev.conf and use a similar fixture. Given that the flag should be temporary until the roll-out is completed I prefer to keep things simple.",
      "parentUuid": "de5b8eb8_e94f188a",
      "revId": "edfa581965ce07078a2bee7a2f58d6997c092c42",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9ca95e4f_1f72b363",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1413373
      },
      "writtenOn": "2021-12-10T00:51:39Z",
      "side": 1,
      "message": "Got it. Should be fine to move the code in SetUp to prior to chrome.New to achieve the same as boot.go, give that a crack.",
      "parentUuid": "efad753e_c12cdcac",
      "revId": "edfa581965ce07078a2bee7a2f58d6997c092c42",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "659afba5_1cace703",
        "filename": "src/chromiumos/tast/local/arc/fixture.go",
        "patchSetId": 1
      },
      "lineNbr": 257,
      "author": {
        "id": 1288602
      },
      "writtenOn": "2021-12-09T02:24:17Z",
      "side": 1,
      "message": "ARCVM flags need to be written upon creating the fixture.",
      "revId": "edfa581965ce07078a2bee7a2f58d6997c092c42",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "25306550_bf6a110e",
        "filename": "src/chromiumos/tast/local/arc/fixture.go",
        "patchSetId": 1
      },
      "lineNbr": 375,
      "author": {
        "id": 1288602
      },
      "writtenOn": "2021-12-09T02:24:17Z",
      "side": 1,
      "message": "Writing the config in SetUp() doesn\u0027t work unfortunately, as the flag needs to be set before ARCVM has booted.",
      "revId": "edfa581965ce07078a2bee7a2f58d6997c092c42",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d2b3aa1d_582a9b88",
        "filename": "src/chromiumos/tast/local/arc/fixture.go",
        "patchSetId": 1
      },
      "lineNbr": 375,
      "author": {
        "id": 1413373
      },
      "writtenOn": "2021-12-10T00:51:39Z",
      "side": 1,
      "message": "If you move this line back up to  ~312 that will be prior to chrome starting, I wonder if that\u0027s appropriate",
      "parentUuid": "25306550_bf6a110e",
      "revId": "edfa581965ce07078a2bee7a2f58d6997c092c42",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}