{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "1fdc0ccc_8e628d00",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 10
      },
      "lineNbr": 0,
      "author": {
        "id": 1304442
      },
      "writtenOn": "2021-02-08T21:28:13Z",
      "side": 1,
      "message": "Adding nya@ from conversations in https://groups.google.com/a/chromium.org/g/tast-users/c/4uVick5DE_E. \n\nhidehiko@ would you mind re-reviewing this CL? It\u0027s changed significantly since you gave +2. Thanks!",
      "revId": "e3af4a9e490e7ec8eec1457f45bc60405c971f5c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "94012611_9112ef1d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 10
      },
      "lineNbr": 0,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2021-02-09T01:06:23Z",
      "side": 1,
      "message": "Temporarily unsetting CR.",
      "revId": "e3af4a9e490e7ec8eec1457f45bc60405c971f5c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1890c427_d095db8a",
        "filename": "src/chromiumos/tast/local/bundles/cros/health/diagnostics_cancel.go",
        "patchSetId": 10
      },
      "lineNbr": 34,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2021-02-09T01:06:23Z",
      "side": 1,
      "message": "Could you move this to SoftwareDeps in testing.Fixture in fixture.go? Ditto for all others.",
      "range": {
        "startLine": 34,
        "startChar": 25,
        "endLine": 34,
        "endChar": 34
      },
      "revId": "e3af4a9e490e7ec8eec1457f45bc60405c971f5c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3008426a_5db8db90",
        "filename": "src/chromiumos/tast/local/bundles/cros/health/diagnostics_cancel.go",
        "patchSetId": 10
      },
      "lineNbr": 34,
      "author": {
        "id": 1304442
      },
      "writtenOn": "2021-02-09T02:02:03Z",
      "side": 1,
      "message": "I didn\u0027t see the fields to declare SoftwareDeps in the fixture, and this makes it seem like it\u0027s not possible: https://source.chromium.org/chromiumos/chromiumos/codesearch/+/main:src/platform/tast/src/chromiumos/tast/internal/testing/fixt.go;l\u003d102?q\u003dfixt.go\n\nIs there a way to do it that I\u0027m not seeing?",
      "parentUuid": "1890c427_d095db8a",
      "range": {
        "startLine": 34,
        "startChar": 25,
        "endLine": 34,
        "endChar": 34
      },
      "revId": "e3af4a9e490e7ec8eec1457f45bc60405c971f5c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ff96af9d_13e4911e",
        "filename": "src/chromiumos/tast/local/bundles/cros/health/diagnostics_cancel.go",
        "patchSetId": 10
      },
      "lineNbr": 34,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2021-02-09T02:11:43Z",
      "side": 1,
      "message": "Oops, my bad.\nI mis-read the code... Pls ignore this.",
      "parentUuid": "3008426a_5db8db90",
      "range": {
        "startLine": 34,
        "startChar": 25,
        "endLine": 34,
        "endChar": 34
      },
      "revId": "e3af4a9e490e7ec8eec1457f45bc60405c971f5c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a3e8568f_04108438",
        "filename": "src/chromiumos/tast/local/croshealthd/fixture.go",
        "patchSetId": 10
      },
      "lineNbr": 55,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2021-02-09T01:06:23Z",
      "side": 1,
      "message": "My understanding is of the email thread is:\n\nWhat you need is running chrome. And, the tests do not need to talk to Chrome directly, while cros_healthd does over Mojo.\n\nIn the case, WDYT about using upstart.RestartJob(ctx, \"ui\") here, (as nya@ also recommended in the thread)?\nIt ensures ui job to start, i.e. Chrome should running?\n\nIf chrome.Chrome instance is needed, could you share/comment what is needed in addition to restart ui?",
      "revId": "e3af4a9e490e7ec8eec1457f45bc60405c971f5c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2aa37a24_0435c176",
        "filename": "src/chromiumos/tast/local/croshealthd/fixture.go",
        "patchSetId": 10
      },
      "lineNbr": 55,
      "author": {
        "id": 1304442
      },
      "writtenOn": "2021-02-09T02:02:03Z",
      "side": 1,
      "message": "Originally I didn\u0027t use this solution, because Chrome did not have time to bootstrap cros_healthd before the test started. But adding a wait condition on the dbus service MojoConnectionService does ensure that cros_healthd has been boostrapped. \n\nI\u0027ve modified the CL to use the RestartJob solution.",
      "parentUuid": "a3e8568f_04108438",
      "revId": "e3af4a9e490e7ec8eec1457f45bc60405c971f5c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e212c1e0_c3fbbeed",
        "filename": "src/chromiumos/tast/local/croshealthd/fixture.go",
        "patchSetId": 10
      },
      "lineNbr": 55,
      "author": {
        "id": 1304442
      },
      "writtenOn": "2021-02-09T19:04:55Z",
      "side": 1,
      "message": "So I don\u0027t think I was testing the right patch ðŸ˜ž. The service I should be waiting for is org.chromium.MojoConnectionService. When I test waiting on this dbus service, Chrome does not have time to send cros_healthd the mojo remotes. I think this leaves me with a few options:\n\n1. Add a sleep in the SetUp of the fixture to give Chrome time to bootstrap cros_healthd. (Not ideal, but this would work)\n\n2. Add a polling mechanism to wait until cros_healthd has been bootstrapped before continuing. \n\n3. Use the chrome.New() mechanism even though it is not needed in the fixture. This seems to give enough time for the bootstrap indirectly.\n\n#2 Would probably be the cleanest solution, but do you have a preference?",
      "parentUuid": "2aa37a24_0435c176",
      "revId": "e3af4a9e490e7ec8eec1457f45bc60405c971f5c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "be1efcc9_8adbdf1f",
        "filename": "src/chromiumos/tast/local/croshealthd/fixture.go",
        "patchSetId": 10
      },
      "lineNbr": 55,
      "author": {
        "id": 1304442
      },
      "writtenOn": "2021-02-25T00:48:58Z",
      "side": 1,
      "message": "Alright based on a lot of experimentation. I added a new API to cros_healthd to report when it is fully ready to go. This way we can restart the \"ui\" job, and then just want for cros_healthd to be ready.",
      "parentUuid": "e212c1e0_c3fbbeed",
      "revId": "e3af4a9e490e7ec8eec1457f45bc60405c971f5c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}