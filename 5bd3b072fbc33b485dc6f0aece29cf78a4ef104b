{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "be4b4bd4_c3983fcd",
        "filename": "src/chromiumos/tast/remote/firmware/fingerprint/firmware_test_handler.go",
        "patchSetId": 1
      },
      "lineNbr": 59,
      "author": {
        "id": 1314845
      },
      "writtenOn": "2021-09-14T23:03:11Z",
      "side": 1,
      "message": "nit: \"try to stop\"",
      "range": {
        "startLine": 59,
        "startChar": 51,
        "endLine": 59,
        "endChar": 59
      },
      "revId": "5bd3b072fbc33b485dc6f0aece29cf78a4ef104b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7512c269_2759e5a4",
        "filename": "src/chromiumos/tast/remote/firmware/fingerprint/firmware_test_handler.go",
        "patchSetId": 1
      },
      "lineNbr": 59,
      "author": {
        "id": 1314845
      },
      "writtenOn": "2021-09-14T23:03:11Z",
      "side": 1,
      "message": "nit: \"immediately following this with a call to stopDaemons\"",
      "range": {
        "startLine": 59,
        "startChar": 63,
        "endLine": 59,
        "endChar": 68
      },
      "revId": "5bd3b072fbc33b485dc6f0aece29cf78a4ef104b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a0d8a6c2_c365f2a8",
        "filename": "src/chromiumos/tast/remote/firmware/fingerprint/firmware_test_handler.go",
        "patchSetId": 1
      },
      "lineNbr": 70,
      "author": {
        "id": 1401350
      },
      "writtenOn": "2021-09-22T08:09:28Z",
      "side": 1,
      "message": "What do you think about moving this into a function, e.g. ensureBiosEnabled()?",
      "range": {
        "startLine": 55,
        "startChar": 0,
        "endLine": 70,
        "endChar": 2
      },
      "revId": "5bd3b072fbc33b485dc6f0aece29cf78a4ef104b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9aa7a1d3_ec63800a",
        "filename": "src/chromiumos/tast/remote/firmware/fingerprint/firmware_test_handler.go",
        "patchSetId": 1
      },
      "lineNbr": 116,
      "author": {
        "id": 1334530
      },
      "writtenOn": "2021-09-13T19:34:08Z",
      "side": 1,
      "message": "Are we sure enabling biod in NewFirmwareTest makes sense?\n\nI think we only disable it right here, in the same function. This also only should happen if the device is zork. Is there some other place that might be disabling biod?",
      "range": {
        "startLine": 114,
        "startChar": 2,
        "endLine": 116,
        "endChar": 3
      },
      "revId": "5bd3b072fbc33b485dc6f0aece29cf78a4ef104b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2eed52a6_3bd8e300",
        "filename": "src/chromiumos/tast/remote/firmware/fingerprint/firmware_test_handler.go",
        "patchSetId": 1
      },
      "lineNbr": 116,
      "author": {
        "id": 1407950
      },
      "writtenOn": "2021-09-14T16:30:43Z",
      "side": 1,
      "message": "When we are calling NewFirmwareTest and biod is disabled (biod.conf is missing) then stopDeamons() function will fail because it can\u0027t get information about biod.\n\nI think NewFirmwareTest is the only function which disables biod. This was intended to fix situation in which biod service remains disabled because error occurred in NewFirmwareTest (after biod was disabled, eg. incorrect write protect flags) or user interrupted test (Close() method not called).\n\nFor the first case I created https://chromium-review.googlesource.com/c/chromiumos/platform/tast-tests/+/3159538. It implements enabling biod service and FP updater when NewFirmwareTest is returning error. It doesn\u0027t help with situation in which user terminates test manually.",
      "parentUuid": "9aa7a1d3_ec63800a",
      "range": {
        "startLine": 114,
        "startChar": 2,
        "endLine": 116,
        "endChar": 3
      },
      "revId": "5bd3b072fbc33b485dc6f0aece29cf78a4ef104b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "255cfeed_1a824727",
        "filename": "src/chromiumos/tast/remote/firmware/fingerprint/firmware_test_handler.go",
        "patchSetId": 1
      },
      "lineNbr": 116,
      "author": {
        "id": 1314845
      },
      "writtenOn": "2021-09-14T23:03:11Z",
      "side": 1,
      "message": "I think it\u0027s ok to add this based on Patryk\u0027s explanation. Agree that it\u0027s a little weird that on Zork we enable it and then disable it. On the other hand, it\u0027s nice to be able to ensure that some other random test in the system didn\u0027t do something to biod\u0027s conf file (or more likely that we add a test in the future that does).",
      "parentUuid": "2eed52a6_3bd8e300",
      "range": {
        "startLine": 114,
        "startChar": 2,
        "endLine": 116,
        "endChar": 3
      },
      "revId": "5bd3b072fbc33b485dc6f0aece29cf78a4ef104b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "53948582_505bbd02",
        "filename": "src/chromiumos/tast/remote/firmware/fingerprint/firmware_test_handler.go",
        "patchSetId": 1
      },
      "lineNbr": 116,
      "author": {
        "id": 1334530
      },
      "writtenOn": "2021-09-21T20:52:36Z",
      "side": 1,
      "message": "If the user terminates the test manually (s.Fatal() or something else), the \"defer t.Close()\" should still run, so I think we are covered. This doesn\u0027t really hurt anything, so go for it.",
      "parentUuid": "255cfeed_1a824727",
      "range": {
        "startLine": 114,
        "startChar": 2,
        "endLine": 116,
        "endChar": 3
      },
      "revId": "5bd3b072fbc33b485dc6f0aece29cf78a4ef104b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a351e59a_6009798f",
        "filename": "src/chromiumos/tast/remote/firmware/fingerprint/firmware_test_handler.go",
        "patchSetId": 1
      },
      "lineNbr": 116,
      "author": {
        "id": 1441652
      },
      "writtenOn": "2021-09-22T09:05:02Z",
      "side": 1,
      "message": "AFAIK when I press ctrl-c tast exits immediately, no functions are called. It doesn\u0027t even close SSH connection correctly. This is expected behaviour https://github.com/golang/go/issues/38261 unless some magic mechanisms are implemented.\n\nNow, I think we should focus on proper error handling, so we are not leaving biod (and fp_updater) disabled. Also, manual test termination can introduce many more problems which we are not aware. Another problem is that sometimes /mnt/stateful_partition/biod.conf (to disable biod, biod.conf is copied from /etc/init to /mnt/stateful_partition) is missing (not sure when it happens, just found that I was not able to find biod.conf).\n\nI\u0027m not going to merge this. It would be good if pressing ctrl-c cancels context, so we can exit gracefully.",
      "parentUuid": "53948582_505bbd02",
      "range": {
        "startLine": 114,
        "startChar": 2,
        "endLine": 116,
        "endChar": 3
      },
      "revId": "5bd3b072fbc33b485dc6f0aece29cf78a4ef104b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}