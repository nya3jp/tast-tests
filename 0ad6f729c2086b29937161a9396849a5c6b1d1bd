{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "211942f2_ae7d8943",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2022-04-12T00:23:46Z",
      "side": 1,
      "message": "In general, it is better/recommended to minimize the retry in order not to hide issues in the parts which do not need \"polling\".\nIn this specific case, can we wait for the service to be running?\n\nThen, querying the package list to it?",
      "revId": "0ad6f729c2086b29937161a9396849a5c6b1d1bd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "340f90d9_0b2495a6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1399098
      },
      "writtenOn": "2022-04-12T00:34:58Z",
      "side": 1,
      "message": "The previous code was attempting to just that but it doesn\u0027t work all the time. The command to list packages fails with error code 244 or 245 as well. These are usually temporary errors.\n\nIf package listing is completely broken, the test consuming this won\u0027t pass. If there is a reason to test adb or package listing, IMO it can have a separate test.\n\nTrying to reduce the flaky failures in the tests due to unrelated reasons listing packages failing is one of such failures. I\u0027ve reproduced this twice on my machine where the command succeeds after failing.\n\nEven if we were waiting for service to be up, we would be polling for it.",
      "parentUuid": "211942f2_ae7d8943",
      "revId": "0ad6f729c2086b29937161a9396849a5c6b1d1bd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6a3e17d1_2076ec5b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1399098
      },
      "writtenOn": "2022-04-12T00:36:19Z",
      "side": 1,
      "message": "Tests failing due to failing to list packages: https://stainless.corp.google.com/search?view\u003dmatrix\u0026row\u003dtest\u0026col\u003dbuild\u0026first_date\u003d2022-03-30\u0026last_date\u003d2022-04-12\u0026master_builder_name\u003d%5Emaster-release%24\u0026branch\u003d%5Emain%24\u0026status\u003dFAIL\u0026reason\u003d.*listing+packages+failed.*\u0026exclude_cts\u003dfalse\u0026exclude_not_run\u003dfalse\u0026exclude_non_release\u003dtrue\u0026exclude_au\u003dtrue\u0026exclude_acts\u003dtrue\u0026exclude_retried\u003dfalse\u0026exclude_non_production\u003dfalse\u0026exclude_non_critical\u003dfalse",
      "parentUuid": "340f90d9_0b2495a6",
      "revId": "0ad6f729c2086b29937161a9396849a5c6b1d1bd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "40a93494_36af5c77",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2022-04-12T13:16:33Z",
      "side": 1,
      "message": "Thank you for sharing. Looking at the log, the most failure is time out. Thus, polling more wouldn\u0027t help I think?\nIn some cases, the tests fail with status 224, which is adb server error probably. Could you file a bug and investigate it?",
      "parentUuid": "6a3e17d1_2076ec5b",
      "revId": "0ad6f729c2086b29937161a9396849a5c6b1d1bd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b01fd6b2_7dd8ddc1",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1399098
      },
      "writtenOn": "2022-04-12T19:17:50Z",
      "side": 1,
      "message": "Correct, the timeouts are happening due to failure of installing packages and are being investigated already and this change is not intended to address that.\n\nThe intention for this change is to not fail the calling test due to failure to list packages which I\u0027ve observed in my local runs to happen when Play Store is updating and the call succeeds afterwards i.e. it is like a transient failure.\n\nI can add a check on the message to contain that status code 244 or 245 just like the existing code was doing. I figured, if I just remove the check and retry regardless, we\u0027ll cover all transient errors and non-transient ones are going to fail anyway and won\u0027t be missed.\n\nI can also abandon this change and file a bug to investigate the transient adb failure during Play Store update but won\u0027t have the capacity to investigate it. Please let me know what do you prefer.",
      "parentUuid": "40a93494_36af5c77",
      "revId": "0ad6f729c2086b29937161a9396849a5c6b1d1bd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7ecb8065_5da004e2",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2022-04-13T11:54:00Z",
      "side": 1,
      "message": "\u003e Correct, the timeouts are happening due to failure of installing packages and are being investigated already and this change is not intended to address that.\n\u003e \n\u003e The intention for this change is to not fail the calling test due to failure to list packages which I\u0027ve observed in my local runs to happen when Play Store is updating and the call succeeds afterwards i.e. it is like a transient failure.\n\u003e \n\u003e I can add a check on the message to contain that status code 244 or 245 just like the existing code was doing. I figured, if I just remove the check and retry regardless, we\u0027ll cover all transient errors and non-transient ones are going to fail anyway and won\u0027t be missed.\n\u003e \n\nIt depends on why the transient errors (other than Play Store update) happen.\nIf it is very clear and has good reasons, we can do like this, but we should be more likely stricter to avoid passing tests incorrectly.\n\n\u003e I can also abandon this change and file a bug to investigate the transient adb failure during Play Store update but won\u0027t have the capacity to investigate it. Please let me know what do you prefer.\n\nI\u0027m ok to keep this CL opened, but investigation of the error is needed, I think.",
      "parentUuid": "b01fd6b2_7dd8ddc1",
      "revId": "0ad6f729c2086b29937161a9396849a5c6b1d1bd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}