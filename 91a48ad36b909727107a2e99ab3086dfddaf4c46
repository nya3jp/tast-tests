{
  "comments": [
    {
      "key": {
        "uuid": "c1128518_48f67834",
        "filename": "/COMMIT_MSG",
        "patchSetId": 5
      },
      "lineNbr": 13,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-08-20T04:14:15Z",
      "side": 1,
      "message": "wifi now?",
      "range": {
        "startLine": 13,
        "startChar": 22,
        "endLine": 13,
        "endChar": 29
      },
      "revId": "91a48ad36b909727107a2e99ab3086dfddaf4c46",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6aada97d_e845b207",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1132414
      },
      "writtenOn": "2020-08-19T23:55:42Z",
      "side": 1,
      "message": "I think this looks pretty reasonable, apart from the existing concerns (e.g., chrome.go; whether or not to keep using UI poking for Bluetooth; perhaps some bikeshedding over names). Is there more for reviewers to contribute right now?",
      "revId": "91a48ad36b909727107a2e99ab3086dfddaf4c46",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "04827b2c_956e59f2",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-08-20T04:14:15Z",
      "side": 1,
      "message": "First round of review on the test body but not yet the gRPCs. Need some more time to look into the details of bluetooth/ui operations.",
      "revId": "91a48ad36b909727107a2e99ab3086dfddaf4c46",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "940ee2df_b30cae44",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/bluetooth_service.go",
        "patchSetId": 5
      },
      "lineNbr": 53,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-08-20T08:22:27Z",
      "side": 1,
      "message": "What is this Sleep waiting for? Can you add some comments for that?",
      "revId": "91a48ad36b909727107a2e99ab3086dfddaf4c46",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ab559aea_8b366f25",
        "filename": "src/chromiumos/tast/local/chrome/chrome.go",
        "patchSetId": 5
      },
      "lineNbr": 737,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-08-20T04:14:15Z",
      "side": 1,
      "message": "I haven\u0027t tried the test myself. Is this change necessary for toggleBluetooth? I suspect this can break some tests of/using chrome...",
      "revId": "91a48ad36b909727107a2e99ab3086dfddaf4c46",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ca42c1a9_27770e38",
        "filename": "src/chromiumos/tast/local/chrome/chrome.go",
        "patchSetId": 5
      },
      "lineNbr": 737,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-08-20T08:22:27Z",
      "side": 1,
      "message": "resolve this one and have the discussion on another comment.",
      "parentUuid": "ab559aea_8b366f25",
      "revId": "91a48ad36b909727107a2e99ab3086dfddaf4c46",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f7e69d46_df093067",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/persistence_bluetooth_sans_wifi.go",
        "patchSetId": 5
      },
      "lineNbr": 60,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-08-20T04:14:15Z",
      "side": 1,
      "message": "This seems to be the same as the one in the other test. Probably good to extract it into a utility function in bundles/cros/wifi/wifiutil ? (I encountered a similar case and have the wifiutil package created in my CL crrev.com/c/2328091, but it is still CQ-ing)",
      "range": {
        "startLine": 60,
        "startChar": 1,
        "endLine": 60,
        "endChar": 18
      },
      "revId": "91a48ad36b909727107a2e99ab3086dfddaf4c46",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1763510b_552e69a3",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/persistence_bluetooth_sans_wifi.go",
        "patchSetId": 5
      },
      "lineNbr": 122,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-08-20T04:14:15Z",
      "side": 1,
      "message": "This line can be removed?",
      "revId": "91a48ad36b909727107a2e99ab3086dfddaf4c46",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "96f266d8_d5114741",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/persistence_wifi_sans_bluetooth.go",
        "patchSetId": 5
      },
      "lineNbr": 33,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-08-20T04:14:15Z",
      "side": 1,
      "message": "The rpc.Client is not closed. Probably you can also wrap the gRPC operations before Reboot into a function if you want to avoid the possibility of rpc.Client.Close got messed up after Reboot. e.g.\n\n  defer func(ctx context.Context) {\n    // Global clean up.\n  } (ctx)\n\n  // ...\n\n  func (ctx context.Context) {\n    r, err :\u003d rpc.Dial(ctx, d, s.RPCHint(), \"cros\")\n    if err !\u003d nil {\n      s.Fatal(\"rpc.Dial failed: \", err)\n    }\n    defer r.Close()\n    // ... the operations in line 115-133.\n  }\n\n  d.Reboot(ctx)\n\n  // ... other operations after reboot.",
      "range": {
        "startLine": 33,
        "startChar": 1,
        "endLine": 33,
        "endChar": 2
      },
      "revId": "91a48ad36b909727107a2e99ab3086dfddaf4c46",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "54547ad8_68198135",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/persistence_wifi_sans_bluetooth.go",
        "patchSetId": 5
      },
      "lineNbr": 50,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-08-20T04:14:15Z",
      "side": 1,
      "message": "I guess it\u0027ll be nice to have logs (or even s.Error()) when this gRPC failed? (also for the SetBluetoothStatus below.)",
      "revId": "91a48ad36b909727107a2e99ab3086dfddaf4c46",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3978e3c4_53e2a423",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/persistence_wifi_sans_bluetooth.go",
        "patchSetId": 5
      },
      "lineNbr": 69,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-08-20T04:14:15Z",
      "side": 1,
      "message": "nit: Not sure if it worth to have Error here.",
      "range": {
        "startLine": 69,
        "startChar": 6,
        "endLine": 69,
        "endChar": 9
      },
      "revId": "91a48ad36b909727107a2e99ab3086dfddaf4c46",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ffc0bfc7_c52c495f",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/persistence_wifi_sans_bluetooth.go",
        "patchSetId": 5
      },
      "lineNbr": 108,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-08-20T04:14:15Z",
      "side": 1,
      "message": "nit: I guess when we reach here, the interface should be guaranteed to exist? Otherwise, the connection above should have failed? But we can still verify it anyway.",
      "revId": "91a48ad36b909727107a2e99ab3086dfddaf4c46",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a7dcca5f_65bc00bc",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/persistence_wifi_sans_bluetooth.go",
        "patchSetId": 5
      },
      "lineNbr": 129,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-08-20T08:22:27Z",
      "side": 1,
      "message": "Tried the test a little bit, it seems this check might fail. I guess there\u0027s a potential race condition here: SetBluetoothStatus toggle the status from UI but the status might not yet changed in underlying service and the status we get here can still be ON.",
      "revId": "91a48ad36b909727107a2e99ab3086dfddaf4c46",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c56a2c3a_970926ae",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/persistence_wifi_sans_bluetooth.go",
        "patchSetId": 5
      },
      "lineNbr": 141,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-08-20T04:14:15Z",
      "side": 1,
      "message": "This rpc.Client is not closed.",
      "range": {
        "startLine": 141,
        "startChar": 1,
        "endLine": 141,
        "endChar": 2
      },
      "revId": "91a48ad36b909727107a2e99ab3086dfddaf4c46",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "54476547_2efcae93",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/persistence_wifi_sans_bluetooth.go",
        "patchSetId": 5
      },
      "lineNbr": 141,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-08-20T04:14:15Z",
      "side": 1,
      "message": "This err is not handled.",
      "range": {
        "startLine": 141,
        "startChar": 4,
        "endLine": 141,
        "endChar": 7
      },
      "revId": "91a48ad36b909727107a2e99ab3086dfddaf4c46",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2058f36b_9c8a88d2",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/persistence_wifi_sans_bluetooth.go",
        "patchSetId": 5
      },
      "lineNbr": 146,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-08-20T04:14:15Z",
      "side": 1,
      "message": "err is nil here and not related to this Fatal?",
      "range": {
        "startLine": 146,
        "startChar": 51,
        "endLine": 146,
        "endChar": 54
      },
      "revId": "91a48ad36b909727107a2e99ab3086dfddaf4c46",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0b31a407_87d2ae90",
        "filename": "src/chromiumos/tast/services/cros/network/wifi_service.proto",
        "patchSetId": 5
      },
      "lineNbr": 207,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-08-20T08:22:27Z",
      "side": 1,
      "message": "I think you want to share the request for similar enable/disable gRPC calls. We had a related discussion before in https://crrev.com/c/2156192/14/src/chromiumos/tast/services/cros/network/wifi.proto#22\n\nCopied from the thread there:\n\"Typically gRPC client/server might have different versions, so for version compatibility and extensibility it is recommended to use different messages for different methods. OTOH Tast always builds gRPC client/server from the same snapshot of source code so some of those best practices might not apply. But I still think it\u0027s good and less confusing to follow the established best practices.\"\n\nSo probably SetWifiStatusRequest is preferred?\n\n(BluetoothStatus{Request,Response} in bluetooth_service.proto is similar cases)",
      "range": {
        "startLine": 207,
        "startChar": 8,
        "endLine": 207,
        "endChar": 31
      },
      "revId": "91a48ad36b909727107a2e99ab3086dfddaf4c46",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}