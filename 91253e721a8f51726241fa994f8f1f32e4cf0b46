{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "78cafedc_86888247",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/gtk.go",
        "patchSetId": 1
      },
      "lineNbr": 96,
      "author": {
        "id": 1132414
      },
      "writtenOn": "2020-12-05T02:52:03Z",
      "side": 1,
      "message": "you probably want longer than a second, no? the rekey period is 5+ seconds",
      "range": {
        "startLine": 96,
        "startChar": 0,
        "endLine": 96,
        "endChar": 57
      },
      "revId": "91253e721a8f51726241fa994f8f1f32e4cf0b46",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d28825f6_9fa2eef3",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/gtk.go",
        "patchSetId": 1
      },
      "lineNbr": 96,
      "author": {
        "id": 1243287
      },
      "writtenOn": "2020-12-05T03:04:16Z",
      "side": 1,
      "message": "Yeah, I was playing around with the timeout and accidentally left it at 1 second. I updated it to 20 seconds, but the duration of this test is closer to 5+20+20\u003d45 seconds I think. I\u0027ll update it again.",
      "parentUuid": "78cafedc_86888247",
      "range": {
        "startLine": 96,
        "startChar": 0,
        "endLine": 96,
        "endChar": 57
      },
      "revId": "91253e721a8f51726241fa994f8f1f32e4cf0b46",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f10a178c_3c9e06d2",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/gtk.go",
        "patchSetId": 1
      },
      "lineNbr": 104,
      "author": {
        "id": 1132414
      },
      "writtenOn": "2020-12-05T02:52:03Z",
      "side": 1,
      "message": "it feels a bit odd to treat all errors as passing; is there some better way of determining that it was definitely a timeout error? and can we guarantee that we\u0027ve flushed out any buffered property changes? It\u0027d also be nice if this could be checked after all the network tests (so down at line 115?), except then it\u0027d be nicer to have better answers to the previous two questions, so we can guarantee that if we see a timeout error, that means we\u0027ve really checked the property stream, and not just that the gRPC stream was too slow.\n\nSorry if those are too open-ended of questions; I genuinely don\u0027t have great solutions right now. Maybe those who\u0027ve developed the ExpectShillProperty() service would have better hints.",
      "range": {
        "startLine": 104,
        "startChar": 30,
        "endLine": 104,
        "endChar": 40
      },
      "revId": "91253e721a8f51726241fa994f8f1f32e4cf0b46",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9c5469ab_bedf58af",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/gtk.go",
        "patchSetId": 1
      },
      "lineNbr": 104,
      "author": {
        "id": 1243287
      },
      "writtenOn": "2020-12-05T03:04:16Z",
      "side": 1,
      "message": "Yeah that\u0027s a good point. We could probably parse the error, but that seems too hacky. +Yenlin, do you have any ideas here?",
      "parentUuid": "f10a178c_3c9e06d2",
      "range": {
        "startLine": 104,
        "startChar": 30,
        "endLine": 104,
        "endChar": 40
      },
      "revId": "91253e721a8f51726241fa994f8f1f32e4cf0b46",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f81ae773_e13fd72c",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/gtk.go",
        "patchSetId": 1
      },
      "lineNbr": 104,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-12-07T02:26:48Z",
      "side": 1,
      "message": "Detecting specific errors from gRPC is difficult as the error will lose their type and the \"wrap\" structure after marshaling. i.e. caller cannot use errors.Is. I don\u0027t have a better solution than strings.Contains for the ExpectShillProperty usage here.\n\nOne alternative here is to create another watcher gRPC with a stop function (so it\u0027ll be a bi-directional streaming gRPC). This has a few benefits:\n  1. Caller can actively stop the watcher instead of waiting for the timeout. Also, we might be able to separate the \"no signal\" from other errors. e.g. return empty array + no error.\n  2. dbus signal and gRPC stream are both async, it is possible that ExpectShillProperty might miss a signal due to racing. With stop function, we can send out a dummy dbus signal and wait for that as boundary. (possible solution to Brian\u0027s \"check buffer flushed\" question)\n\nHowever, this might be quite much work, so I\u0027m not sure if it worth the effort/complexity.\n\n+Arowa as I remember we discussed a similar gRPC idea before. Maybe he had some old PoC that can be used here.",
      "parentUuid": "9c5469ab_bedf58af",
      "range": {
        "startLine": 104,
        "startChar": 30,
        "endLine": 104,
        "endChar": 40
      },
      "revId": "91253e721a8f51726241fa994f8f1f32e4cf0b46",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}