{
  "comments": [
    {
      "key": {
        "uuid": "1df54781_add4d486",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/two_shills.go",
        "patchSetId": 2
      },
      "lineNbr": 18,
      "author": {
        "id": 1132414
      },
      "writtenOn": "2019-10-07T17:45:27Z",
      "side": 1,
      "message": "I did find a handful of timeouts:\n\nhttps://stainless.corp.google.com/search?view\u003dmatrix\u0026row\u003dboard_model\u0026col\u003dbuild\u0026first_date\u003d2019-09-10\u0026last_date\u003d2019-10-07\u0026test\u003d%5Etast%5C.network%5C.TwoShills%24\u0026status\u003dWARN\u0026status\u003dFAIL\u0026status\u003dERROR\u0026exclude_cts\u003dfalse\u0026exclude_not_run\u003dfalse\u0026exclude_non_release\u003dfalse\u0026exclude_au\u003dtrue\u0026exclude_acts\u003dtrue\u0026exclude_retried\u003dfalse\u0026exclude_non_production\u003dfalse\n\nProbably should look into those.\n\nLooking a little closer on at least one of those:\nhttps://stainless.corp.google.com/browse/chromeos-autotest-results/340881524-chromeos-test/\nIt looks like Shill crashed on an earlier test (probably should investigate that?) and we didn\u0027t notice. Then, I believe that gives us a race condition: that if Shill is actively restarting while we\u0027re running this test, our --foreground instance might actually win out, and so we\u0027ll hang at line 34 (while shill is \"running\").\n\nI\u0027ll file a bug for this, so it doesn\u0027t get lost in review.",
      "range": {
        "startLine": 18,
        "startChar": 12,
        "endLine": 18,
        "endChar": 21
      },
      "revId": "2326a614557ae4b6cf722db05aa13f6fc469bfcf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b831c7c1_5ad7e948",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/two_shills.go",
        "patchSetId": 2
      },
      "lineNbr": 18,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2019-10-08T00:14:56Z",
      "side": 1,
      "message": "Interesting. I didn\u0027t aware that a test pass master build will fail on release build later. \n\nWhen shill is restarting (because of crash or other reason), is there any way we can know that? Can we know that from inspecting some log?",
      "parentUuid": "1df54781_add4d486",
      "range": {
        "startLine": 18,
        "startChar": 12,
        "endLine": 18,
        "endChar": 21
      },
      "revId": "2326a614557ae4b6cf722db05aa13f6fc469bfcf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d1cd9010_3fe2cd28",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/two_shills.go",
        "patchSetId": 2
      },
      "lineNbr": 18,
      "author": {
        "id": 1132414
      },
      "writtenOn": "2019-10-08T00:45:12Z",
      "side": 1,
      "message": "\u003e Interesting. I didn\u0027t aware that a test pass master build will fail on release build later. \n\nFlaky tests will flake anywhere :)\n\n\u003e When shill is restarting (because of crash or other reason), is there any way we can know that? Can we know that from inspecting some log?\n\nYes, test logs include the contents of /var/log/message and /var/log/net.log, both of which should have this detail.\n\nBut what\u0027s important to *this* test is that Shill might have recently restarted due to explicit actions from a previous test. It is *this* test\u0027s job to guard against that, and to wait for the appropriate \"precondition\" (i.e., wait until our primary Shill instance is fully ready).",
      "parentUuid": "b831c7c1_5ad7e948",
      "range": {
        "startLine": 18,
        "startChar": 12,
        "endLine": 18,
        "endChar": 21
      },
      "revId": "2326a614557ae4b6cf722db05aa13f6fc469bfcf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3249854a_6f3f12cc",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/two_shills.go",
        "patchSetId": 2
      },
      "lineNbr": 27,
      "author": {
        "id": 1132414
      },
      "writtenOn": "2019-10-07T17:45:27Z",
      "side": 1,
      "message": "this is probably not a sufficient condition to wait for. We should wait until Shill is responding on D-Bus -- otherwise, the second instance won\u0027t even know the \"first\" one is there.",
      "range": {
        "startLine": 27,
        "startChar": 0,
        "endLine": 27,
        "endChar": 67
      },
      "revId": "2326a614557ae4b6cf722db05aa13f6fc469bfcf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "10db3fa7_0324dda6",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/two_shills.go",
        "patchSetId": 2
      },
      "lineNbr": 27,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2019-10-08T00:14:56Z",
      "side": 1,
      "message": "Noted. I\u0027ll add the check in another CL.",
      "parentUuid": "3249854a_6f3f12cc",
      "range": {
        "startLine": 27,
        "startChar": 0,
        "endLine": 27,
        "endChar": 67
      },
      "revId": "2326a614557ae4b6cf722db05aa13f6fc469bfcf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "56e29efa_a7340a84",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/two_shills.go",
        "patchSetId": 2
      },
      "lineNbr": 32,
      "author": {
        "id": 1132414
      },
      "writtenOn": "2019-10-07T17:45:27Z",
      "side": 1,
      "message": "this timeout doesn\u0027t appear to be working correctly. the timeouts I see take over a minute.",
      "range": {
        "startLine": 32,
        "startChar": 0,
        "endLine": 32,
        "endChar": 61
      },
      "revId": "2326a614557ae4b6cf722db05aa13f6fc469bfcf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a82c64e4_f2b5241d",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/two_shills.go",
        "patchSetId": 2
      },
      "lineNbr": 32,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2019-10-08T00:14:56Z",
      "side": 1,
      "message": "If so, we shall expect seeing \"Invocation of second shill instance should have failed\" error log.",
      "parentUuid": "56e29efa_a7340a84",
      "range": {
        "startLine": 32,
        "startChar": 0,
        "endLine": 32,
        "endChar": 61
      },
      "revId": "2326a614557ae4b6cf722db05aa13f6fc469bfcf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "25b6c7c7_36c09178",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/two_shills.go",
        "patchSetId": 2
      },
      "lineNbr": 32,
      "author": {
        "id": 1132414
      },
      "writtenOn": "2019-10-08T00:45:12Z",
      "side": 1,
      "message": "But we don\u0027t. Look at the bug I assigned to you -- no such log message.",
      "parentUuid": "a82c64e4_f2b5241d",
      "range": {
        "startLine": 32,
        "startChar": 0,
        "endLine": 32,
        "endChar": 61
      },
      "revId": "2326a614557ae4b6cf722db05aa13f6fc469bfcf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}