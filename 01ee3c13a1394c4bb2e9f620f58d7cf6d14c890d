{
  "comments": [
    {
      "key": {
        "uuid": "2ffec847_2e009141",
        "filename": "src/chromiumos/tast/local/bundles/cros/wilco/ec_event.go",
        "patchSetId": 4
      },
      "lineNbr": 53,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-10-16T15:01:39Z",
      "side": 1,
      "message": "nit/style:\n\nexpectedECEvent :\u003d []byte{ ... }",
      "range": {
        "startLine": 53,
        "startChar": 1,
        "endLine": 53,
        "endChar": 22
      },
      "revId": "01ee3c13a1394c4bb2e9f620f58d7cf6d14c890d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "335491f4_9ebac7b7",
        "filename": "src/chromiumos/tast/local/bundles/cros/wilco/ec_event.go",
        "patchSetId": 4
      },
      "lineNbr": 53,
      "author": {
        "id": 1311094
      },
      "writtenOn": "2019-10-16T16:55:23Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "2ffec847_2e009141",
      "range": {
        "startLine": 53,
        "startChar": 1,
        "endLine": 53,
        "endChar": 22
      },
      "revId": "01ee3c13a1394c4bb2e9f620f58d7cf6d14c890d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "84358a00_b9177c07",
        "filename": "src/chromiumos/tast/local/bundles/cros/wilco/ec_event.go",
        "patchSetId": 4
      },
      "lineNbr": 60,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-10-16T15:01:39Z",
      "side": 1,
      "message": "Could you avoid skipping the test on runtime check?\nInstead, could you properly set the expected dependency? In which condition would this happen?\nIf this runtime check is needed, instead,\n- could you set the dependency, and\n- report an error (instead of skipping) if there\u0027s no file at /sys/kernel/...?",
      "range": {
        "startLine": 57,
        "startChar": 1,
        "endLine": 60,
        "endChar": 2
      },
      "revId": "01ee3c13a1394c4bb2e9f620f58d7cf6d14c890d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "574001fc_27413c59",
        "filename": "src/chromiumos/tast/local/bundles/cros/wilco/ec_event.go",
        "patchSetId": 4
      },
      "lineNbr": 60,
      "author": {
        "id": 1311094
      },
      "writtenOn": "2019-10-16T16:55:23Z",
      "side": 1,
      "message": "A little bit of context:\n\nIn order for this test to work, the EC firmware needs to have the ability to send test events. This feature was added in FW 41 in https://crrev.com/i/1918307 a few days ago. djkurtz was concerned that the firmware of the DUTs in the lab would not be updated at the same cadence as the OS image, so therefore we could not guarantee that the FW contains this feature yet.\n\nHowever, after talking with tbegin and martinroth, I don\u0027t think this is true. As soon as FW 41 landed a few days ago, the new feature was present in the built images, and I would assume that the lab DUTs would update their firmware. Therefore, I think we can actually remove this check all the way.\n\nAs a note, if we can\u0027t remove the check, then the only way tbegin or I could think of for adding a dependency would require adding a wilco_ec_test_event USE flag to the wilco EC FW ebuild (http://cs/chromeos_internal/src/private-overlays/overlay-sarien-private/chromeos-base/chromeos-ec-firmware-sarien-private/chromeos-ec-firmware-sarien-private-0.0.1.ebuild?l\u003d6), which seemed to us like overkill.",
      "parentUuid": "84358a00_b9177c07",
      "range": {
        "startLine": 57,
        "startChar": 1,
        "endLine": 60,
        "endChar": 2
      },
      "revId": "01ee3c13a1394c4bb2e9f620f58d7cf6d14c890d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3c6e2f7b_13214b1f",
        "filename": "src/chromiumos/tast/local/bundles/cros/wilco/ec_event.go",
        "patchSetId": 4
      },
      "lineNbr": 60,
      "author": {
        "id": 1000018
      },
      "writtenOn": "2019-10-17T09:11:12Z",
      "side": 1,
      "message": "No, lab DUTs do not have their Firmware updated automatically, it requires a special request and procedure to update lab AP/EC Firmware.  See go/cros-lab-firmware.\n\nThe new *OS image* has a new \"AP Firmware image\" (w/ corresponding \"EC Firmware image\" embedded within it), however, this is just a payload in the OS image, it isn\u0027t actually written to the SPI Flash and therefore isn\u0027t the running AP firmware image (and consequently, the EC\u0027s Flash isn\u0027t updated via EC SOFTWARE SYNC by the AP Firmware at boot).\n\nSo, yes, you need to solve the case where of any existing lab DUTs with AP/EC firmware without the required feature.  The solution could be handling it here in the test, or alternatively, you could qual AP/EC Firmware with all required features and fully deploy that to the lab.",
      "parentUuid": "574001fc_27413c59",
      "range": {
        "startLine": 57,
        "startChar": 1,
        "endLine": 60,
        "endChar": 2
      },
      "revId": "01ee3c13a1394c4bb2e9f620f58d7cf6d14c890d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cc791c7e_3fdd4a24",
        "filename": "src/chromiumos/tast/local/bundles/cros/wilco/ec_event.go",
        "patchSetId": 4
      },
      "lineNbr": 60,
      "author": {
        "id": 1311094
      },
      "writtenOn": "2019-10-17T18:05:19Z",
      "side": 1,
      "message": "Thanks Daniel for the clarification. OK, I filed a bug to update the lab DUTs\u0027 FW at https://crbug.com/1015497. If we don\u0027t get a nice resolution in a few days then I would say we should keep this check here, and then we could remove it in a few months when the FW is automatically updated.",
      "revId": "01ee3c13a1394c4bb2e9f620f58d7cf6d14c890d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f8ca96a1_0b904534",
        "filename": "src/chromiumos/tast/local/bundles/cros/wilco/ec_event.go",
        "patchSetId": 4
      },
      "lineNbr": 60,
      "author": {
        "id": 1311094
      },
      "writtenOn": "2019-10-23T23:56:55Z",
      "side": 1,
      "message": "OK, that bug is being slow.\n\nI re-added the check, with a TODO pointing to the bug. Let me know if that is acceptable.",
      "parentUuid": "cc791c7e_3fdd4a24",
      "revId": "01ee3c13a1394c4bb2e9f620f58d7cf6d14c890d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "daed9e93_df858e81",
        "filename": "src/chromiumos/tast/local/bundles/cros/wilco/ec_event.go",
        "patchSetId": 4
      },
      "lineNbr": 60,
      "author": {
        "id": 1000018
      },
      "writtenOn": "2019-10-24T03:37:11Z",
      "side": 1,
      "message": "LGTM",
      "parentUuid": "f8ca96a1_0b904534",
      "revId": "01ee3c13a1394c4bb2e9f620f58d7cf6d14c890d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8efc26ef_3a12aad8",
        "filename": "src/chromiumos/tast/local/bundles/cros/wilco/ec_event.go",
        "patchSetId": 4
      },
      "lineNbr": 60,
      "author": {
        "id": 1311094
      },
      "writtenOn": "2019-10-24T23:14:34Z",
      "side": 1,
      "message": "I\u0027d like Hidehiko or a Tast owner to sign off on this before I push it in",
      "parentUuid": "daed9e93_df858e81",
      "revId": "01ee3c13a1394c4bb2e9f620f58d7cf6d14c890d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fd1ab731_7f2fbec6",
        "filename": "src/chromiumos/tast/local/bundles/cros/wilco/ec_event.go",
        "patchSetId": 4
      },
      "lineNbr": 85,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-10-16T15:01:39Z",
      "side": 1,
      "message": "There\u0027s no guarantee that Read() reads all bytes until passed bytes are full.\n- Could you handle return value properly? E.g., the slice you\u0027re checking at L90 should be shorter.\n- If you need to read all bytes, then maybe LimitedReader and iotuil.ReadAll() may help you to simplify the code.",
      "revId": "01ee3c13a1394c4bb2e9f620f58d7cf6d14c890d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cc55bdfe_c4d2c0cc",
        "filename": "src/chromiumos/tast/local/bundles/cros/wilco/ec_event.go",
        "patchSetId": 4
      },
      "lineNbr": 85,
      "author": {
        "id": 1311094
      },
      "writtenOn": "2019-10-16T16:55:23Z",
      "side": 1,
      "message": "Yes, approach 1 sounds good.",
      "parentUuid": "fd1ab731_7f2fbec6",
      "revId": "01ee3c13a1394c4bb2e9f620f58d7cf6d14c890d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}