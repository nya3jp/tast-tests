{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "3b7f8c43_8dab2720",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/task_manager.go",
        "patchSetId": 1
      },
      "lineNbr": 75,
      "author": {
        "id": 1000532
      },
      "writtenOn": "2021-04-02T20:06:16Z",
      "side": 1,
      "message": "First, does it make sense to poll for app in task manager, rather than always wait 30 seconds?\n\nSecond, what is meant by \"in first page\" here? If the app needs to appear in the first N entries of the task manager (which defaults to sorting by CPU usage), this test will potentially fail if the other processes are consuming lots of CPU. Would be better to devise a strategy that scans the entire task list IMO\n\nIt also might be worthwhile (if other tast tests look for things in task manager) to have a more general utility for querying task manager status - is this test the only one that does such a thing?",
      "revId": "18648bc6cd38f88a998fd3337fb440d9b30b3400",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6d4909bc_5a67db88",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/task_manager.go",
        "patchSetId": 1
      },
      "lineNbr": 75,
      "author": {
        "id": 1474010
      },
      "writtenOn": "2021-04-05T19:48:57Z",
      "side": 1,
      "message": "Although polls is preferred over sleep, couldn\u0027t use in this case. The app doesn\u0027t always appear in the first page of the task manager list if it is launched immediately post app launch. Hence polls waiting for ARC entry times-out.\n\nWhen Task Manager is opened once the device is stabilized after app launch then the test is consistently stable.\n\nNot sure if there is any way to scan the entire list when some items invisible in 2nd page. Added a TODO to investigate this. As of now there is not much task manager tests except task manager crostini test which appears to have this flaky issue.",
      "parentUuid": "3b7f8c43_8dab2720",
      "revId": "18648bc6cd38f88a998fd3337fb440d9b30b3400",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "39e495db_67db4fc3",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/task_manager.go",
        "patchSetId": 1
      },
      "lineNbr": 75,
      "author": {
        "id": 1000532
      },
      "writtenOn": "2021-04-09T22:07:05Z",
      "side": 1,
      "message": "I\u0027m still somewhat confused here. In cases where the test fails without the 30 second Sleep, is the app running but happens to be in a later page of the task manager? I\u0027d think ui.WaitUntilExists would wait long enough though.   Or does the Sleep help by avoiding some weird race condition where the app ends up over the task maanger and that causes the test code that tries to scan the task manager to fail incorrectly? Or something else?\n\nI looked at crostini/task_manager.go and it seems to get by without the Sleep.\n\nIf we can\u0027t sort this out, is there a shorter sleep value that works instead?",
      "parentUuid": "6d4909bc_5a67db88",
      "revId": "18648bc6cd38f88a998fd3337fb440d9b30b3400",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "03a11196_5e71e1eb",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/task_manager.go",
        "patchSetId": 1
      },
      "lineNbr": 75,
      "author": {
        "id": 1474010
      },
      "writtenOn": "2021-04-09T22:57:14Z",
      "side": 1,
      "message": "In cases where test fails without sleep, the app is running and it is always in later page of task manager list and ui.WaitUntilExists timeout and fails (I verified this by increasing the timeout value from 300ms to 30secs) . I am not sure why task manager doesn\u0027t refresh bringing the app to front page even after waiting 30 seconds.(Might be a bug in task manager).\n\nThe crostini/task_manager also has this failure (https://stainless.corp.google.com/search?view\u003dmatrix\u0026row\u003dboard_model\u0026col\u003dbuild\u0026first_date\u003d2021-04-03\u0026last_date\u003d2021-04-09\u0026test\u003d%5Etast%5C.crostini%5C.TaskManager*.*\u0026status\u003dFAIL\u0026status\u003dERROR\u0026status\u003dABORT\u0026reason\u003dFailed+to+test+Crostini+in+Task+Manager%3A+failed+to+open+Task+Manager+and+look+for+Crostini\u0026exclude_cts\u003dtrue\u0026exclude_not_run\u003dfalse\u0026exclude_non_release\u003dtrue\u0026exclude_au\u003dtrue\u0026exclude_acts\u003dtrue\u0026exclude_retried\u003dfalse\u0026exclude_non_production\u003dfalse)\n\nI am sure a 30secs sleep between App Launch and Task Manager Launch is fixing this issue and Task Manager has this application listed in first page. \n\nI will try with lower sleep and check.",
      "parentUuid": "39e495db_67db4fc3",
      "revId": "18648bc6cd38f88a998fd3337fb440d9b30b3400",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}