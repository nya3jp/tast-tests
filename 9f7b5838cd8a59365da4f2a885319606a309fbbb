{
  "comments": [
    {
      "key": {
        "uuid": "42ef7faa_d3e4dd4d",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 32,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-04-16T03:15:39Z",
      "side": 1,
      "message": "Mind declaring these regexps with regexp.MustCompile?\n\n var (\n   ImagePattern \u003d regexp.MustCompile(...)\n   VideoPattern \u003d regexp.MustCompile(...)\n )\n\nThen these variables will have Regexp type and we can ensure type safety.\n\n(I also suggest renaming s/Format/Pattern/g; in fact you refer them as pat below :))\n\nAlso, I believe you need to use ^ and $ to make sure regexps are matched to the entire file name, not its substring.",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 32,
        "endChar": 37
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "818ae812_645225ad",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 32,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-16T10:09:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "42ef7faa_d3e4dd4d",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 32,
        "endChar": 37
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "29148768_64991412",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 47,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-04-16T03:15:39Z",
      "side": 1,
      "message": "Please avoid passing testing.State to utility functions. Since it contains many things, it makes harder to tell which information this function needs.\n\nhttps://chromium.googlesource.com/chromiumos/platform/tast/+/HEAD/docs/writing_tests.md#test-subpackages\n\nFor this function, you can return error, and call s.Fatal in the test body function instead.",
      "range": {
        "startLine": 47,
        "startChar": 37,
        "endLine": 47,
        "endChar": 53
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0a696cfa_63e9a007",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 47,
      "author": {
        "id": 1273836
      },
      "writtenOn": "2019-04-16T08:06:34Z",
      "side": 1,
      "message": "(I suggested to call s.Fatal in helper functions in the previous patch. Sorry!)",
      "parentUuid": "29148768_64991412",
      "range": {
        "startLine": 47,
        "startChar": 37,
        "endLine": 47,
        "endChar": 53
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "df487e26_e0573d4d",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 47,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-16T10:09:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "29148768_64991412",
      "range": {
        "startLine": 47,
        "startChar": 37,
        "endLine": 47,
        "endChar": 53
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e15a229c_b781f26c",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 61,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-04-16T03:15:39Z",
      "side": 1,
      "message": "Could you use WaitForExists with an explicit timeout instead? The default time is ctx\u0027s timeout, and it\u0027s often too long. Same below.",
      "range": {
        "startLine": 61,
        "startChar": 24,
        "endLine": 61,
        "endChar": 55
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b8d77cbb_f6b445b6",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 61,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-16T10:09:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e15a229c_b781f26c",
      "range": {
        "startLine": 61,
        "startChar": 24,
        "endLine": 61,
        "endChar": 55
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4a50c4c1_ef94a9a9",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 63,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-04-16T03:15:39Z",
      "side": 1,
      "message": "Please drop this else clause to reduce nesting.",
      "range": {
        "startLine": 63,
        "startChar": 2,
        "endLine": 63,
        "endChar": 9
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d0e31c1e_a998e8a9",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 63,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-16T10:09:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "4a50c4c1_ef94a9a9",
      "range": {
        "startLine": 63,
        "startChar": 2,
        "endLine": 63,
        "endChar": 9
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4324d7b4_0bc48017",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 67,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-04-16T03:15:39Z",
      "side": 1,
      "message": "Do we need to match with the description? I think ID match is sufficient. I\u0027m rather afraid this test won\u0027t work on non-English locales.",
      "range": {
        "startLine": 67,
        "startChar": 45,
        "endLine": 67,
        "endChar": 79
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "615790b3_1742bfaa",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 67,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-16T10:09:10Z",
      "side": 1,
      "message": "Yes we need to with this approach. GCA uses the same button for image capturing and recording\nI thought about the locale issue. If Tast is expected to be run on a different locale, I guess the reasonable approach would probably be changing the content description of something unfocusable to an English-only description and querying that object for the information.\nI\u0027m not sure what the standard practice is. UIAutomator only supports description but not tags (https://developer.android.com/reference/android/view/View#tags). It looks like I can only go for this approach.\n\nFor this case, I think I can use waitUntilGone.\nhttps://developer.android.com/reference/androidx/test/uiautomator/UiObject.html#waituntilgone\nHowever, the wrapper hasn\u0027t implemented it yet.\nhttps://cs.corp.google.com/chromeos_public/src/platform/tast-tests/src/chromiumos/tast/local/arc/ui/object.go?l\u003d61\nI\u0027ll prepare a CL to to add it (along with WaitUntilGoneWithDefaultTimeout)\n\nFor other cases, I might still need to use contentDescription to differentiate.",
      "parentUuid": "4324d7b4_0bc48017",
      "range": {
        "startLine": 67,
        "startChar": 45,
        "endLine": 67,
        "endChar": 79
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5752e38e_cfcd2693",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 67,
      "author": {
        "id": 1132275
      },
      "writtenOn": "2019-04-16T11:16:44Z",
      "side": 1,
      "message": "Per our gchat discussion, can we add some hidden elements in the app so that we can depend on the presence of the element of certain ID to determine the current mode?",
      "parentUuid": "615790b3_1742bfaa",
      "range": {
        "startLine": 67,
        "startChar": 45,
        "endLine": 67,
        "endChar": 79
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "77a90169_63113212",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 67,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-17T05:38:52Z",
      "side": 1,
      "message": "I think waitUntilGone is best for this scenario. But for camera facing, we need some code changes in GCA.",
      "parentUuid": "5752e38e_cfcd2693",
      "range": {
        "startLine": 67,
        "startChar": 45,
        "endLine": 67,
        "endChar": 79
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c1d12943_39d5f44c",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 67,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-04-17T21:26:53Z",
      "side": 1,
      "message": "Thanks for explanation, it makes sense. Could you describe it briefly in the code comments too for future readers?",
      "parentUuid": "77a90169_63113212",
      "range": {
        "startLine": 67,
        "startChar": 45,
        "endLine": 67,
        "endChar": 79
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "67eeb337_475c3a20",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 86,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-04-16T03:15:39Z",
      "side": 1,
      "message": "You can pass chrome.Chrome (or just user) instead.",
      "range": {
        "startLine": 86,
        "startChar": 37,
        "endLine": 86,
        "endChar": 53
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "821d5d36_b80af87f",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 86,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-16T10:09:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "67eeb337_475c3a20",
      "range": {
        "startLine": 86,
        "startChar": 37,
        "endLine": 86,
        "endChar": 53
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ffa24473_b09b0446",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 101,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-04-16T03:15:39Z",
      "side": 1,
      "message": "nit: Mind using the guard style to reduce nesting? That is:\n\n if file.ModTime().Before(ts) {\n   continue\n }\n ...",
      "range": {
        "startLine": 101,
        "startChar": 3,
        "endLine": 101,
        "endChar": 32
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "701d17ce_111536c8",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 101,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-16T10:09:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ffa24473_b09b0446",
      "range": {
        "startLine": 101,
        "startChar": 3,
        "endLine": 101,
        "endChar": 32
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "252d181b_8924f549",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 103,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-04-16T03:15:39Z",
      "side": 1,
      "message": "nit: re.MatchString should be enough since we don\u0027t care about indices.",
      "range": {
        "startLine": 103,
        "startChar": 10,
        "endLine": 103,
        "endChar": 38
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5c80ded5_01dc0bc0",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 103,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-16T10:09:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "252d181b_8924f549",
      "range": {
        "startLine": 103,
        "startChar": 10,
        "endLine": 103,
        "endChar": 38
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "995d50ca_5ecced7a",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 109,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-04-16T03:15:39Z",
      "side": 1,
      "message": "err should be always nil in this case. Please use errors.New instead.\n\nAlso nit: it might be better to explicitly say there was no matching file, rather than simply saying \"failed to find\".",
      "range": {
        "startLine": 109,
        "startChar": 21,
        "endLine": 109,
        "endChar": 24
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "54cc5ced_7f682c03",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 109,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-16T10:09:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "995d50ca_5ecced7a",
      "range": {
        "startLine": 109,
        "startChar": 21,
        "endLine": 109,
        "endChar": 24
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f5295d85_edb2ac9f",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 116,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-04-16T03:15:39Z",
      "side": 1,
      "message": "As for this function, you can pass arc.ARC instead of testing.State. Logging can be done with testing.ContextLog.",
      "range": {
        "startLine": 116,
        "startChar": 38,
        "endLine": 116,
        "endChar": 54
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0dd4b8dd_2e483808",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 116,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-16T10:09:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f5295d85_edb2ac9f",
      "range": {
        "startLine": 116,
        "startChar": 38,
        "endLine": 116,
        "endChar": 54
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6c7f8e01_294c2dd5",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 118,
      "author": {
        "id": 1001646
      },
      "writtenOn": "2019-04-15T13:08:58Z",
      "side": 1,
      "message": "duplicated would",
      "range": {
        "startLine": 118,
        "startChar": 33,
        "endLine": 118,
        "endChar": 44
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "aeaab0d6_c8a4b577",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 118,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-16T10:09:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "6c7f8e01_294c2dd5",
      "range": {
        "startLine": 118,
        "startChar": 33,
        "endLine": 118,
        "endChar": 44
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c7ba8724_26b61bd4",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 159,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-04-16T03:15:39Z",
      "side": 1,
      "message": "In this case d.Close() is not called. Generally, we usually don\u0027t want to do early-return for tear-down functions. One typical way is:\n\n func TearDownDevice(...) error {\n   var firstErr error\n \n   if d !\u003d nil {\n     defer d.Close()\n\n     if err :\u003d a.Command(...); err !\u003d nil {\n       err \u003d errors.Wrap(err, \"failed to close GCA\")\n       testing.ContextLog(ctx, \"Error during teardown: \", err)\n       if firstErr \u003d\u003d nil {\n         firstErr \u003d err\n       }\n     }\n   }\n\n   ...\n\n   return firstErr\n }",
      "range": {
        "startLine": 159,
        "startChar": 3,
        "endLine": 159,
        "endChar": 40
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "67907b55_6ece90cc",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca/gca.go",
        "patchSetId": 9
      },
      "lineNbr": 159,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-16T10:09:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c7ba8724_26b61bd4",
      "range": {
        "startLine": 159,
        "startChar": 3,
        "endLine": 159,
        "endChar": 40
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e9524b02_1e446c4d",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_recording.go",
        "patchSetId": 9
      },
      "lineNbr": 22,
      "author": {
        "id": 1001886
      },
      "writtenOn": "2019-04-16T03:19:51Z",
      "side": 1,
      "message": "There is no camera on some devices such as chromeboxes. Should we add caps.BuiltinCamera here? (from chromiumos/tast/local/bundles/cros/video/lib/caps)",
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "62be9b4c_5b1f7d2a",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_recording.go",
        "patchSetId": 9
      },
      "lineNbr": 22,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-16T10:09:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e9524b02_1e446c4d",
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "25190159_70fedb38",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_recording.go",
        "patchSetId": 9
      },
      "lineNbr": 31,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-04-16T03:15:39Z",
      "side": 1,
      "message": "Typically in Go, APIs are designed so that callers don\u0027t need to call a cleanup function if a setup function returns a non-nil error; it is the callee\u0027s responsibility to roll back the setup. Could you try to design gca.SetUpDevice/TearDownDevice accordingly?\n\nOne way would be like:\n\n func SetUpDevice(...) (*ui.Device, error) {\n   success :\u003d false\n   defer func() {\n     if !success {\n       TearDownDevice(...)\n     }\n   }\n \n   ...\n \n   success \u003d true\n   return d, nil\n }",
      "range": {
        "startLine": 29,
        "startChar": 0,
        "endLine": 31,
        "endChar": 31
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5924712f_a1a7369c",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_recording.go",
        "patchSetId": 9
      },
      "lineNbr": 31,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-16T10:09:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "25190159_70fedb38",
      "range": {
        "startLine": 29,
        "startChar": 0,
        "endLine": 31,
        "endChar": 31
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f325ef59_5669a1f2",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_recording.go",
        "patchSetId": 9
      },
      "lineNbr": 37,
      "author": {
        "id": 1273836
      },
      "writtenOn": "2019-04-16T08:06:34Z",
      "side": 1,
      "message": "You need to use shortened ctx to save time for TearDownDevice here and below.\n\ne.g.\n\n...\ndefer gca.TearDownDevice(ctx, s, d)\n\n// Shorten context to save time for cleaning up the environment.\n// (I\u0027m not sure 10 seconds are enough for TearDownDevice, though)\nshortCtx, cancel \u003d ctxutil.Shorten(ctx, 10 * time.Second)\ndefer cancel()\n\n// Use shortCtx instead of ctx below\n...",
      "range": {
        "startLine": 37,
        "startChar": 16,
        "endLine": 37,
        "endChar": 19
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "09402892_66eb4c36",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_recording.go",
        "patchSetId": 9
      },
      "lineNbr": 37,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-16T10:09:10Z",
      "side": 1,
      "message": "Can we just override ctx? Or is this bad practice.\nI.e., ctx, cancel \u003d ctxutil.Shorten(ctx, 10 * time.Second)",
      "parentUuid": "f325ef59_5669a1f2",
      "range": {
        "startLine": 37,
        "startChar": 16,
        "endLine": 37,
        "endChar": 19
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b17d454c_6c0dc4f2",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_recording.go",
        "patchSetId": 9
      },
      "lineNbr": 37,
      "author": {
        "id": 1273836
      },
      "writtenOn": "2019-04-16T10:39:25Z",
      "side": 1,
      "message": "Ah, overwriting should be better. Thanks!\n\nWe already did the same thing at several places:\ne.g.\nhttps://cs.corp.google.com/chromeos_public/src/platform/tast-tests/src/chromiumos/tast/local/bundles/cros/video/encode/accel_video.go?rcl\u003d3c3e87bffab5ea48ddb844409451033d9c77c7ad\u0026l\u003d165",
      "parentUuid": "09402892_66eb4c36",
      "range": {
        "startLine": 37,
        "startChar": 16,
        "endLine": 37,
        "endChar": 19
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4717e9e9_9d50fa7b",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_recording.go",
        "patchSetId": 9
      },
      "lineNbr": 37,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-17T05:38:52Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b17d454c_6c0dc4f2",
      "range": {
        "startLine": 37,
        "startChar": 16,
        "endLine": 37,
        "endChar": 19
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5cb20918_b0f1f568",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_recording.go",
        "patchSetId": 9
      },
      "lineNbr": 37,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-17T11:48:02Z",
      "side": 1,
      "message": "Oops... We cannot actually overwrite it.\nReason:\n\tdefer func() {\n\t\tif err :\u003d tearDownDevice(ctx, a, d); err !\u003d nil {\n\t\t\ts.Fatal(\"Failed to tear down device: \", err)\n\t\t}\n\t}()\n\n\tctx, cancel :\u003d ctxutil.Shorten(ctx, 10*time.Second)\n\tdefer cancel()\n\ncancel() will be run before tearDownDevice(ctx, ...)\ncancel() cancels the context so tearDownDevice will fail.\n\nSo the ARC Video tests would fail if they added an error check on the tearing down routines.\nI just tested \u0027video.ARCEncodeAccelH264I420\u0027 and it did fail after I inserted an error check in\nhttps://cs.corp.google.com/chromeos_public/src/platform/tast-tests/src/chromiumos/tast/local/bundles/cros/video/encode/accel_video.go?l\u003d163\nWhatever this is removing, I guess it isn\u0027t actually removed?\n\n\nAlso, with this added, I think it\u0027s best to encapsulate them. I\u0027ve restored the original RunTest approach to handle this.\nReasons:\n- Less code duplication (we\u0027ll need to copy and paste SetUpDevice, TearDownDevice, ctxutil.Shorten every time we create a new test)\n- No need to use \"shortCtx\" in the test body. Code looks cleaner.",
      "parentUuid": "4717e9e9_9d50fa7b",
      "range": {
        "startLine": 37,
        "startChar": 16,
        "endLine": 37,
        "endChar": 19
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c1bf8d64_928e4eff",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_recording.go",
        "patchSetId": 9
      },
      "lineNbr": 37,
      "author": {
        "id": 1273836
      },
      "writtenOn": "2019-04-17T13:07:15Z",
      "side": 1,
      "message": "make sense. It sounds reasonable to me. Thank you for the clear explanation!",
      "parentUuid": "5cb20918_b0f1f568",
      "range": {
        "startLine": 37,
        "startChar": 16,
        "endLine": 37,
        "endChar": 19
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "df3d5fe7_1928197e",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_recording.go",
        "patchSetId": 9
      },
      "lineNbr": 43,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-04-16T03:15:39Z",
      "side": 1,
      "message": "Thanks for using this new function :)\n\nCould you also check the returned error? It can return non-nil error if we hit ctx timeout.\n\n if err :\u003d testing.Sleep(ctx, 3*time.Second); err !\u003d nil {\n   s.Fatal(\"Timed out on recording video: \", err)\n }",
      "range": {
        "startLine": 43,
        "startChar": 1,
        "endLine": 43,
        "endChar": 34
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bc80f55a_da4c6a7f",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_recording.go",
        "patchSetId": 9
      },
      "lineNbr": 43,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-16T10:09:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "df3d5fe7_1928197e",
      "range": {
        "startLine": 43,
        "startChar": 1,
        "endLine": 43,
        "endChar": 34
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c99ff684_342c294a",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_recording.go",
        "patchSetId": 9
      },
      "lineNbr": 51,
      "author": {
        "id": 1132275
      },
      "writtenOn": "2019-04-16T11:16:44Z",
      "side": 1,
      "message": "Don\u0027t need to address in this CL, but I think having some checks to validate the produced video files will be helpful. It can prevent bugs like https://b.corp.google.com/issues/126769611 from happening.",
      "range": {
        "startLine": 51,
        "startChar": 0,
        "endLine": 51,
        "endChar": 1
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0fb28102_8d584cd1",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_recording.go",
        "patchSetId": 9
      },
      "lineNbr": 51,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-17T05:38:52Z",
      "side": 1,
      "message": "Yes, I did think of the bug. That was why I left comments about needing a utility library to examine the metadata of a media file. We don\u0027t have one last time I checked. https://cs.corp.google.com/chromeos_public/src/platform/tast-tests/src/chromiumos/tast/local/bundles/cros/video/lib/",
      "parentUuid": "c99ff684_342c294a",
      "range": {
        "startLine": 51,
        "startChar": 0,
        "endLine": 51,
        "endChar": 1
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1f21799d_396f3f0a",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_still_capture.go",
        "patchSetId": 9
      },
      "lineNbr": 22,
      "author": {
        "id": 1001886
      },
      "writtenOn": "2019-04-16T03:19:51Z",
      "side": 1,
      "message": "There is no camera on some devices such as chromeboxes. Should we add caps.BuiltinCamera here? (from chromiumos/tast/local/bundles/cros/video/lib/caps)",
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a16ed821_bd5f5202",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_still_capture.go",
        "patchSetId": 9
      },
      "lineNbr": 22,
      "author": {
        "id": 1001886
      },
      "writtenOn": "2019-04-16T03:27:46Z",
      "side": 1,
      "message": "Ah, as GCA works with external camera now, it should be caps.BuiltinOrVividCamera if possible. You can test it on Betty.",
      "parentUuid": "1f21799d_396f3f0a",
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6505406c_457ad2a2",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_still_capture.go",
        "patchSetId": 9
      },
      "lineNbr": 22,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-16T10:09:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a16ed821_bd5f5202",
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "37e472a4_05ae85b6",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_still_capture.go",
        "patchSetId": 9
      },
      "lineNbr": 22,
      "author": {
        "id": 1132275
      },
      "writtenOn": "2019-04-16T11:16:44Z",
      "side": 1,
      "message": "It seems that caps.BuiltinOrVividCamera is not added?",
      "parentUuid": "6505406c_457ad2a2",
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "223c5b55_52102b8b",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_still_capture.go",
        "patchSetId": 9
      },
      "lineNbr": 22,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-17T05:38:52Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "37e472a4_05ae85b6",
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5caca641_535ab498",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_still_capture.go",
        "patchSetId": 9
      },
      "lineNbr": 28,
      "author": {
        "id": 1132275
      },
      "writtenOn": "2019-04-16T11:16:44Z",
      "side": 1,
      "message": "Please document this function, such as how it determines whether the still capture is successful (An image file is created? Does it validate the image file? Does it validate the content of the image?) and what stream it uses (real camera stream or faked stream from video file?).",
      "range": {
        "startLine": 28,
        "startChar": 5,
        "endLine": 28,
        "endChar": 20
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0c359a97_bf4835bf",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_still_capture.go",
        "patchSetId": 9
      },
      "lineNbr": 28,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-17T05:38:52Z",
      "side": 1,
      "message": "Well I don\u0027t see other tests do that. I say we do that in the description above (Line 19).",
      "parentUuid": "5caca641_535ab498",
      "range": {
        "startLine": 28,
        "startChar": 5,
        "endLine": 28,
        "endChar": 20
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "548e7c3e_efdb44df",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_still_capture.go",
        "patchSetId": 9
      },
      "lineNbr": 28,
      "author": {
        "id": 1132275
      },
      "writtenOn": "2019-04-18T04:07:30Z",
      "side": 1,
      "message": "I see. Then please add these to line 19 mentioning that this test only checks the existence of captured image. It doesn\u0027t validate the file format or content inside it.",
      "parentUuid": "0c359a97_bf4835bf",
      "range": {
        "startLine": 28,
        "startChar": 5,
        "endLine": 28,
        "endChar": 20
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4fea177f_978a6e41",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_still_capture.go",
        "patchSetId": 9
      },
      "lineNbr": 34,
      "author": {
        "id": 1132275
      },
      "writtenOn": "2019-04-16T11:16:44Z",
      "side": 1,
      "message": "Can we move this line before \"if\" so we can get rid of line 31?",
      "range": {
        "startLine": 34,
        "startChar": 1,
        "endLine": 34,
        "endChar": 36
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fc8f5302_2b5313d4",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_still_capture.go",
        "patchSetId": 9
      },
      "lineNbr": 34,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-17T05:38:52Z",
      "side": 1,
      "message": "This is addressed in another comment by nya.",
      "parentUuid": "4fea177f_978a6e41",
      "range": {
        "startLine": 34,
        "startChar": 1,
        "endLine": 34,
        "endChar": 36
      },
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "74e5b6b2_dccbf698",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_still_capture.go",
        "patchSetId": 9
      },
      "lineNbr": 35,
      "author": {
        "id": 1132275
      },
      "writtenOn": "2019-04-16T11:16:44Z",
      "side": 1,
      "message": "Can we call gca.SwitchMode(ctx, s, d, gca.PhotoMode) here (and make SwitchMode() more defensive by doing nothing when the current mode is the same as the requested mode)? Otherwise we have an implicit assumption that the default mode is photo mode after app starts. If it\u0027s not true, the test will fail. It kind of violates the one-test-for-one-thing principle. We can have a separate test to check whether default mode is photo mode so that the regression in one case will not mess up with the others.",
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7474a7fd_8c5cc138",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/gca_still_capture.go",
        "patchSetId": 9
      },
      "lineNbr": 35,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2019-04-17T05:38:52Z",
      "side": 1,
      "message": "This was an approach I considered (that was why SwitchMode originally only printed out a log message). But since we\u0027re halting development on GCA, we basically won\u0027t be expecting anything else. I think for a typical test, it does make more sense to explicitly switch to photo mode.\nI\u0027ll change it back.",
      "parentUuid": "74e5b6b2_dccbf698",
      "revId": "9f7b5838cd8a59365da4f2a885319606a309fbbb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}