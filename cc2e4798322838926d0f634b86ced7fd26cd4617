{
  "comments": [
    {
      "key": {
        "uuid": "579610a5_bdc5b0f2",
        "filename": "src/chromiumos/tast/local/arc/arc.go",
        "patchSetId": 5
      },
      "lineNbr": 34,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-06-11T09:08:45Z",
      "side": 1,
      "message": "Could you comment the reference to each IP.",
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bae03c8a_d686bb69",
        "filename": "src/chromiumos/tast/local/arc/arc.go",
        "patchSetId": 5
      },
      "lineNbr": 176,
      "author": {
        "id": 1299948
      },
      "writtenOn": "2019-06-13T05:17:36Z",
      "side": 1,
      "message": "Is this necessary because of b/134962894, or why do we have to create the home directory? If it\u0027s for that bug, I thought this would affect adb usage in general, is there a reason this is only for VM and not for ARC++?",
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b4f91ecf_3055eadf",
        "filename": "src/chromiumos/tast/local/arc/arc.go",
        "patchSetId": 5
      },
      "lineNbr": 181,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-06-11T09:08:45Z",
      "side": 1,
      "message": "killall --wait would take longer time, so it\u0027s nice to add a logging line before hand.\n\ntesting.ContextLogf(ctx, \"Stopping existing adb server\")",
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bba95340_596ace66",
        "filename": "src/chromiumos/tast/local/arc/arc.go",
        "patchSetId": 5
      },
      "lineNbr": 182,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-06-11T09:08:45Z",
      "side": 1,
      "message": "Could you handle the error properly. And DumpLog on error?\n\nif err :\u003d testexec.CommandContext(ctx, \"killall\", ...).Run(testexec.DumpLogOnError); err !\u003d nil {\n  ...\n}",
      "range": {
        "startLine": 182,
        "startChar": 2,
        "endLine": 182,
        "endChar": 84
      },
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8d5726e6_1fb5fa9d",
        "filename": "src/chromiumos/tast/local/arc/arc.go",
        "patchSetId": 5
      },
      "lineNbr": 183,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-06-11T09:08:45Z",
      "side": 1,
      "message": "Similary, nice to have a logging.\n\ntesting.ContextLogf(ctx, \"Starting adb server\")",
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fe987c1d_e3c8b798",
        "filename": "src/chromiumos/tast/local/arc/arc.go",
        "patchSetId": 5
      },
      "lineNbr": 188,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-06-11T09:08:45Z",
      "side": 1,
      "message": "This is not the regression, but could you also add a log line here?\n\ntesting.ContextLogf(ctx, \"Waiting for the ADB auth is set up\")",
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a569579e_6f8dc824",
        "filename": "src/chromiumos/tast/local/arc/arc.go",
        "patchSetId": 5
      },
      "lineNbr": 273,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-06-11T09:08:45Z",
      "side": 1,
      "message": "optional: Maybe guestMode() (with avoiding the naming conflict)? First of all, I was thinking \"guest\" is some guest user or something, but it\u0027s not actually.",
      "range": {
        "startLine": 273,
        "startChar": 5,
        "endLine": 273,
        "endChar": 13
      },
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "786f5db4_5c4fd1bd",
        "filename": "src/chromiumos/tast/local/arc/arc.go",
        "patchSetId": 5
      },
      "lineNbr": 278,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-06-11T09:08:45Z",
      "side": 1,
      "message": "In this case, creating the set looks redundant.\n\nfor _, a :\u003d range args {\n  if a \u003d\u003d \"--enable-arcvm\" {\n    return vm, nil\n  }\n  if ... {\n    return container, nil\n  }\n  return none, errors.New(...)\n}\n\n\n(offtopic): to use map as a set, it\u0027s nice to have struct{} as a value type, because that will be optimized to 0-byte.",
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1c8fd579_c6ada102",
        "filename": "src/chromiumos/tast/local/arc/arc.go",
        "patchSetId": 5
      },
      "lineNbr": 278,
      "author": {
        "id": 1346383
      },
      "writtenOn": "2019-06-11T20:21:55Z",
      "side": 1,
      "message": "ARCVM also have the ARC flags and the map approach was made for readability purpose. Here is the previous discussion: https://chromium-review.googlesource.com/c/chromiumos/platform/tast-tests/+/1637171/4/src/chromiumos/tast/local/arc/arc.go#283?\n\nIf it\u0027s better to do \u0027if check\u0027 I\u0027m down to change it.",
      "parentUuid": "786f5db4_5c4fd1bd",
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bf1abc5e_85e47af4",
        "filename": "src/chromiumos/tast/local/arc/arc.go",
        "patchSetId": 5
      },
      "lineNbr": 278,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-06-13T07:48:44Z",
      "side": 1,
      "message": "Thank you for explanation. (And, I now understand your comment at L283).\nOk, then I\u0027m fine with the set or two for-stmt.\nThough, could you take my \"offtopic\" part above if you choose set?",
      "parentUuid": "1c8fd579_c6ada102",
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "795c86f2_ececd20c",
        "filename": "src/chromiumos/tast/local/arc/arc.go",
        "patchSetId": 5
      },
      "lineNbr": 329,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-06-11T09:08:45Z",
      "side": 1,
      "message": "Clar: does \"adb wait-for-device\" work for your purpose?",
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5035720a_5b39806a",
        "filename": "src/chromiumos/tast/local/arc/arc.go",
        "patchSetId": 5
      },
      "lineNbr": 329,
      "author": {
        "id": 1346383
      },
      "writtenOn": "2019-06-11T20:21:55Z",
      "side": 1,
      "message": "\u003e Clar: does \"adb wait-for-device\" work for your purpose?\n\n\"wait-for-device\" doesn\u0027t work because the connection to vsock is not yet there.\nHowever, \"adb connect\" may be an alternative to this.\n\nThe difference would be \u0027android-sh\u0027 directly connect to vsock while \u0027adb\u0027 (in my patch) connect to a proxy. What I am doing is running \u0027android-sh\u0027 for Bootstrap and eventually moving it to \u0027adb\u0027 for further connections. \n\nAn alternative would be to revert using \u0027android-sh\u0027 and fallback \u0027Command\u0027 on \u0027BootstrapCommand\u0027 like my past patchset.\n\nWhat do you think about this?",
      "parentUuid": "795c86f2_ececd20c",
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "01bf44e4_292c1048",
        "filename": "src/chromiumos/tast/local/arc/arc.go",
        "patchSetId": 5
      },
      "lineNbr": 329,
      "author": {
        "id": 1299948
      },
      "writtenOn": "2019-06-13T02:03:06Z",
      "side": 1,
      "message": "Are you seeing the the timeout happen in waitProp without this change? I was hoping the 10+ seconds of waiting/retrying done in android-sh would be enough :(\n\nInstead of this change, maybe it makes sense to go a step further and check the login state and wait for a longer duration in android-sh for login.",
      "parentUuid": "5035720a_5b39806a",
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9fcd8395_6da9af2c",
        "filename": "src/chromiumos/tast/local/arc/arc.go",
        "patchSetId": 5
      },
      "lineNbr": 330,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-06-11T09:08:45Z",
      "side": 1,
      "message": "In this case, you\u0027re explicitly calling \"adb\", so Command() instead?",
      "range": {
        "startLine": 330,
        "startChar": 10,
        "endLine": 330,
        "endChar": 57
      },
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "67966334_71386c95",
        "filename": "src/chromiumos/tast/local/arc/arc.go",
        "patchSetId": 5
      },
      "lineNbr": 330,
      "author": {
        "id": 1346383
      },
      "writtenOn": "2019-06-11T20:21:55Z",
      "side": 1,
      "message": "Command() work, but this is done to run \u0027android-sh\u0027 instead of \u0027adb\u0027. See previous comment.",
      "parentUuid": "9fcd8395_6da9af2c",
      "range": {
        "startLine": 330,
        "startChar": 10,
        "endLine": 330,
        "endChar": 57
      },
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cfaedc92_49dafe1d",
        "filename": "src/chromiumos/tast/local/arc/arc.go",
        "patchSetId": 5
      },
      "lineNbr": 331,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-06-11T09:08:45Z",
      "side": 1,
      "message": "Clar: ARCVM boot sometimes takes more time than one second? Is it enough...?",
      "range": {
        "startLine": 331,
        "startChar": 26,
        "endLine": 331,
        "endChar": 48
      },
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "da23d2d3_d3dc279d",
        "filename": "src/chromiumos/tast/local/arc/arc.go",
        "patchSetId": 5
      },
      "lineNbr": 331,
      "author": {
        "id": 1346383
      },
      "writtenOn": "2019-06-11T20:21:55Z",
      "side": 1,
      "message": "I believe retrying every one second is reasonable. \u0027android-sh\u0027 have it\u0027s own retry-if-fail system and the BootstrapCommand above on my machine usually only need to run twice.\n\nI think even a lower interval can work just fine.",
      "parentUuid": "cfaedc92_49dafe1d",
      "range": {
        "startLine": 331,
        "startChar": 26,
        "endLine": 331,
        "endChar": 48
      },
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a63de3f6_39adfb0a",
        "filename": "src/chromiumos/tast/local/arc/arc.go",
        "patchSetId": 5
      },
      "lineNbr": 363,
      "author": {
        "id": 1299948
      },
      "writtenOn": "2019-06-13T05:17:36Z",
      "side": 1,
      "message": "Since adb is done over vsock, is it necessary for VM to wait for networking?",
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "97de9fe4_a2ee8f4e",
        "filename": "src/chromiumos/tast/local/arc/arc.go",
        "patchSetId": 5
      },
      "lineNbr": 368,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-06-11T09:08:45Z",
      "side": 1,
      "message": "Could you use Wrapf, instead?\nerrors.Wrapf(err, \"ping %s failed\", ip)",
      "range": {
        "startLine": 368,
        "startChar": 10,
        "endLine": 368,
        "endChar": 48
      },
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a4abacf8_6666cfa8",
        "filename": "src/chromiumos/tast/local/arc/commands.go",
        "patchSetId": 5
      },
      "lineNbr": 39,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-06-11T09:08:45Z",
      "side": 1,
      "message": "Could you keep android-sh interface consistent between container and VM?\nIf it is not now, could you fix that first?",
      "range": {
        "startLine": 34,
        "startChar": 1,
        "endLine": 39,
        "endChar": 2
      },
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c5196994_7796773d",
        "filename": "src/chromiumos/tast/local/arc/commands.go",
        "patchSetId": 5
      },
      "lineNbr": 39,
      "author": {
        "id": 1346383
      },
      "writtenOn": "2019-06-11T20:21:55Z",
      "side": 1,
      "message": "There are some discussions / bugs that talk about this: b/123308422, b/123306389#comment9, go/arcvm-sh.\nHowever, it might be possible for them not be implemented. One possible scenario is if \u0027adb\u0027 is supported on -user build.\n\n\u003e Could you keep android-sh interface consistent between container and VM?\n\nSupporting Tast for ARCVM might have a higher priority now. Would it be okay to land ARCVM Tast first?\nAlso, are there any concerns, other than the divergence for the code, that I can take for consideration (to have consistent interface)?",
      "parentUuid": "a4abacf8_6666cfa8",
      "range": {
        "startLine": 34,
        "startChar": 1,
        "endLine": 39,
        "endChar": 2
      },
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1901e4b5_95faf7ff",
        "filename": "src/chromiumos/tast/local/arc/commands.go",
        "patchSetId": 5
      },
      "lineNbr": 39,
      "author": {
        "id": 1299948
      },
      "writtenOn": "2019-06-13T02:03:06Z",
      "side": 1,
      "message": "+1 on keeping it consistent. Is it possible to change the android-sh-vm script so that escaping is not necessary? This would be a better fix imo as there could be other usages of android-sh that might not know escaping is now necessary.",
      "parentUuid": "c5196994_7796773d",
      "range": {
        "startLine": 34,
        "startChar": 1,
        "endLine": 39,
        "endChar": 2
      },
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d05c254b_75f20b5f",
        "filename": "src/chromiumos/tast/local/arc/commands.go",
        "patchSetId": 5
      },
      "lineNbr": 39,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-06-13T07:48:44Z",
      "side": 1,
      "message": "Yes, regardless of the plan, you can now move the shell escape to android-sh.",
      "parentUuid": "1901e4b5_95faf7ff",
      "range": {
        "startLine": 34,
        "startChar": 1,
        "endLine": 39,
        "endChar": 2
      },
      "revId": "cc2e4798322838926d0f634b86ced7fd26cd4617",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}