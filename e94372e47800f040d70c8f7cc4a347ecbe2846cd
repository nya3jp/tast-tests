{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "32919ebd_21e332d6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1243287
      },
      "writtenOn": "2020-10-09T21:49:19Z",
      "side": 1,
      "message": "Thanks for doing this! LGTM for the most part. I\u0027m not sure how others feel but I think I have a slight preference for directly opening up a socket to the control interface as opposed to using wpa_cli as a proxy, but I\u0027m guessing that\u0027ll require more gRPC plumbing than it\u0027s worth.",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "300ede97_4e89f2b3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-13T07:52:46Z",
      "side": 1,
      "message": "Yeah, and there is no plumbing infra in Tast so that would be a lot of work.",
      "parentUuid": "32919ebd_21e332d6",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d4e333eb_52b66e62",
        "filename": "src/chromiumos/tast/remote/wificell/test_fixture.go",
        "patchSetId": 1
      },
      "lineNbr": 477,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-12T05:36:44Z",
      "side": 1,
      "message": "nit: WPA?",
      "range": {
        "startLine": 477,
        "startChar": 28,
        "endLine": 477,
        "endChar": 31
      },
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "050b26f2_18958936",
        "filename": "src/chromiumos/tast/remote/wificell/test_fixture.go",
        "patchSetId": 1
      },
      "lineNbr": 477,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-13T07:52:46Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d4e333eb_52b66e62",
      "range": {
        "startLine": 477,
        "startChar": 28,
        "endLine": 477,
        "endChar": 31
      },
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6cef507f_18191fe4",
        "filename": "src/chromiumos/tast/remote/wificell/test_fixture.go",
        "patchSetId": 1
      },
      "lineNbr": 489,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-12T05:36:44Z",
      "side": 1,
      "message": "I guess this is for the caller to reserve time for stop. Maybe you can just shorten the context in this function?",
      "range": {
        "startLine": 489,
        "startChar": 4,
        "endLine": 489,
        "endChar": 25
      },
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a7af157d_bb3c9d94",
        "filename": "src/chromiumos/tast/remote/wificell/test_fixture.go",
        "patchSetId": 1
      },
      "lineNbr": 489,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-13T07:52:46Z",
      "side": 1,
      "message": "That would be more complicated, as I would have to return both new context and the cancel function of shortening (to defer it from the caller).\nCurrently the caller code is:\n       wpaMonitor, stop, stopTimeout, err :\u003d tf.StartWpaMonitor(ctx)\n       if err !\u003d nil {\n               s.Fatal(\"Faled to start wpa monitor: \", err)\n       }\n       defer stop()\n       ctx, cancel \u003d ctxutil.Shorten(ctx, stopTimeout)\n       defer cancel()",
      "parentUuid": "6cef507f_18191fe4",
      "range": {
        "startLine": 489,
        "startChar": 4,
        "endLine": 489,
        "endChar": 25
      },
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "90a11e25_e1fcc975",
        "filename": "src/chromiumos/tast/remote/wificell/test_fixture.go",
        "patchSetId": 1
      },
      "lineNbr": 489,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-13T09:32:54Z",
      "side": 1,
      "message": "How about in the function:\n\n  // ...\n  sCtx, sCancel :\u003d ctxutil.Shorten(ctx, wpaMonitorStopTimeout)\n  return wpaMonitor, func() {\n    sCancel()\n    timeoutCtx, cancel :\u003d context.WithTimeout(ctx, wpaMonitorStopTimeout)\n    defer cancel()\n    wpaMonitor.Stop(timeoutCtx)\n  }, sCtx, nil\n\nAnd the caller:\n\n  wpaMonitor, stop, ctx, err :\u003d tf.StartWpaMonitor(ctx)\n  if err !\u003d nil {\n    s.Fatal(\"Faled to start wpa monitor: \", err)\n  }\n  defer stop()\n\nWDYT?",
      "parentUuid": "a7af157d_bb3c9d94",
      "range": {
        "startLine": 489,
        "startChar": 4,
        "endLine": 489,
        "endChar": 25
      },
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "82877ee2_f11b7222",
        "filename": "src/chromiumos/tast/remote/wificell/test_fixture.go",
        "patchSetId": 1
      },
      "lineNbr": 489,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-13T11:09:48Z",
      "side": 1,
      "message": "Yeah, should be fine.",
      "parentUuid": "90a11e25_e1fcc975",
      "range": {
        "startLine": 489,
        "startChar": 4,
        "endLine": 489,
        "endChar": 25
      },
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6e43aafa_c0ca8b08",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 20,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-12T05:36:44Z",
      "side": 1,
      "message": "This will be in package scope, so I\u0027m hesitant to have this here. Or, it should have a more specific name.",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9bf8c2b2_aa42bf96",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 20,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-13T07:52:46Z",
      "side": 1,
      "message": "Renamed",
      "parentUuid": "6e43aafa_c0ca8b08",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5250cf5f_8c4e38b0",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 22,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-12T05:36:44Z",
      "side": 1,
      "message": "nit: end the sentence with period? (similar below)",
      "range": {
        "startLine": 22,
        "startChar": 62,
        "endLine": 22,
        "endChar": 63
      },
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8b204ffc_c075b946",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 22,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-12T05:36:44Z",
      "side": 1,
      "message": "I think the name is too general for wificell package. I wonder if we should move these into a sub-package? (so that the \"debug\" will also make sense)",
      "range": {
        "startLine": 22,
        "startChar": 3,
        "endLine": 22,
        "endChar": 8
      },
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4d25c435_bee36fe2",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 22,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-13T07:52:46Z",
      "side": 1,
      "message": "I\u0027m not sure it deserved a dedicated package :) so I have changed the name.",
      "parentUuid": "8b204ffc_c075b946",
      "range": {
        "startLine": 22,
        "startChar": 3,
        "endLine": 22,
        "endChar": 8
      },
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "87f461cd_f1a237e5",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 22,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-13T07:52:46Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5250cf5f_8c4e38b0",
      "range": {
        "startLine": 22,
        "startChar": 62,
        "endLine": 22,
        "endChar": 63
      },
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "48de8f89_2140a321",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 55,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-12T05:36:44Z",
      "side": 1,
      "message": "I personally slightly prefer having error return here so the caller can identify the problem (and perhaps dumps the whole line for better debugging). And utilities can be like:\n\n  func atoi(s string, firstErr *error) {\n    val, err :\u003d strconv.Atoi(str)\n    if err !\u003d nil \u0026\u0026 *firstErr \u003d\u003d nil {\n      *firstErr \u003d err\n    }\n    return val\n  }\n\nThen caller can remain simple:\n\n  var firstErr error\n  event :\u003d \u0026Event{\n    Field: atoi(matches[1], \u0026firstErr),\n    ...\n  }\n  if firstErr !\u003d nil {\n    return nil, firstErr\n  }\n  return event, nil\n\nWDYT?",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2ff0c24b_7877f284",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 55,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-13T07:52:46Z",
      "side": 1,
      "message": "I\u0027m not sure it\u0027s needed. These events are only used for log/stats purposes, so parsing errors here don\u0027t have to be fatal. When something breaks, e.g. after a change in wpa_supplicant, some of the stats will be missing, but some may still be useful to have.",
      "parentUuid": "48de8f89_2140a321",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e825ba86_a456e093",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 55,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-13T09:32:54Z",
      "side": 1,
      "message": "Yeah, I don\u0027t think the error has to be fatal either. But my point is, when there\u0027s parsing error:\n1. we probably shouldn\u0027t return the event.\n2. it might be more informative to dump the whole line instead of only the sub-match.",
      "parentUuid": "2ff0c24b_7877f284",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4870e612_c020ce28",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 55,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-13T11:09:48Z",
      "side": 1,
      "message": "1. my point is that we should return it and move forward with it. the test still completes, with partial results, and that can be useful during the time till a fix comes. kind of defensive programming\n2. why? the problem is in parsing one token, not the whole line. if the whole line is somewhat broken/incompatible, then it will not pass the matcher.",
      "parentUuid": "e825ba86_a456e093",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "25ffaf6d_cf29cef6",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 55,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-14T05:19:10Z",
      "side": 1,
      "message": "1. This might depend on how the events will be used. One case I have: if there\u0027s an atoi error, the field will be 0 and when it is checked in some condition, the test might wrongly pass, which means we might miss some signal when things really got broken.\n\n2. My thought is: the current error message might be something like: \u0027\"1-23\" is not an integer\u0027, but with only the sub-match, we\u0027re not sure where it is from and make it harder to debug. I had a similar parsing bug that is hard to reproduce, and the sub-match didn\u0027t give me much clue so maybe I think too much here.",
      "parentUuid": "4870e612_c020ce28",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "96160b42_46bce259",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 55,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-14T08:52:20Z",
      "side": 1,
      "message": "Fine, though I chose to still return the event alongside the error, the caller can decide what to do.",
      "parentUuid": "25ffaf6d_cf29cef6",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2b2377dc_301225bb",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 60,
      "author": {
        "id": 1243287
      },
      "writtenOn": "2020-10-09T21:49:19Z",
      "side": 1,
      "message": "can we try to consolidate some of these repeated strings/code?",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6330fa9b_1fb8f138",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 60,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-13T07:52:46Z",
      "side": 1,
      "message": "yes we should :)",
      "parentUuid": "2b2377dc_301225bb",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "847f1a90_0c49437a",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 75,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-12T05:36:44Z",
      "side": 1,
      "message": "maybe the following is simpler?\n\n  event :\u003d \u0026RoamEvent{\n    CurBSSID: matches[1],\n    ...\n    Skip: false,\n  }",
      "range": {
        "startLine": 66,
        "startChar": 0,
        "endLine": 75,
        "endChar": 21
      },
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "eecddf41_b80ed15b",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 75,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-13T07:52:46Z",
      "side": 1,
      "message": "right, thanks",
      "parentUuid": "847f1a90_0c49437a",
      "range": {
        "startLine": 66,
        "startChar": 0,
        "endLine": 75,
        "endChar": 21
      },
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1dd10164_8656b5b3",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 149,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-12T05:36:44Z",
      "side": 1,
      "message": "The \"true\" value seems unused. Maybe just defer close(w.done) in the beginning and the type can be chan struct{}? you may also consider close(w.lines) so WaitForEvent can identify the EOF case.",
      "range": {
        "startLine": 149,
        "startChar": 2,
        "endLine": 149,
        "endChar": 16
      },
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4d8ea6b2_dd6c0b25",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 149,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-13T07:52:46Z",
      "side": 1,
      "message": "Will this work? I need to catch done in the Stop function, if I close, this won\u0027t be signaled, right? And I can\u0027t find a way to signal on struct{}.\nAnyway - this done channel is not needed at all, we can use Wait in Stop intead.",
      "parentUuid": "1dd10164_8656b5b3",
      "range": {
        "startLine": 149,
        "startChar": 2,
        "endLine": 149,
        "endChar": 16
      },
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5b00f633_6a5633eb",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 158,
      "author": {
        "id": 1243287
      },
      "writtenOn": "2020-10-09T21:49:19Z",
      "side": 1,
      "message": "nit: combine.",
      "range": {
        "startLine": 157,
        "startChar": 1,
        "endLine": 158,
        "endChar": 14
      },
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "99cc6170_cd56bb47",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 158,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-13T07:52:46Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5b00f633_6a5633eb",
      "range": {
        "startLine": 157,
        "startChar": 1,
        "endLine": 158,
        "endChar": 14
      },
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e2a44695_1f806da3",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 160,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-12T05:36:44Z",
      "side": 1,
      "message": "maybe also w.stdin.Close()?",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6148142d_82ca7c00",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 160,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-13T07:52:46Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e2a44695_1f806da3",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5e607d68_963d7d6e",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 161,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-12T05:36:44Z",
      "side": 1,
      "message": "I think we have to call w.cmd.Wait here.",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4775008b_2bebef25",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 161,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-13T07:52:46Z",
      "side": 1,
      "message": "Right, I missed that function.",
      "parentUuid": "5e607d68_963d7d6e",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8cb11a5b_c463785b",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 170,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-12T05:36:44Z",
      "side": 1,
      "message": "Hmm..., I\u0027m not really sure the intention of this function. When will this be called?",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "84c4356e_bdd93500",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 170,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-13T07:52:46Z",
      "side": 1,
      "message": "In a test you may need to discard any events so far and start collecting only new. I actually use it in one of the upcoming tests.\nI have clarified the comment a bit.",
      "parentUuid": "8cb11a5b_c463785b",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0c40fe78_d4b01fc0",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 170,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-13T09:32:54Z",
      "side": 1,
      "message": "Some things I worried about the usage here is:\n1. As the data source is not closed, if the event comes fast, we might spend unlimited amount of time here.\n2. It is not really guaranteed that all events are dropped. For example, some messages might be still buffered in the scanner/reader/socket... If the Scan routine does not get scheduled when we consume \"lines\" channel, it is possible that some events are not dropped.\n\nDo you think spawning a WPAMonitor every time is too heavy?",
      "parentUuid": "84c4356e_bdd93500",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d923bae7_428683be",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 170,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-13T11:09:48Z",
      "side": 1,
      "message": "Right, your first point is a concern. Very unlikely in this case, but still... How about a deadline on completion of this loop?\nThe other point is not as fatal, and it\u0027s hard to really resolve, especially as there is no timestamps in the output from wpa_cli. Restarting the whole thing seems like an overkill and it may actually result in skipping some events (they are not buffered while wpa_cli is not consuming).",
      "parentUuid": "0c40fe78_d4b01fc0",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0a27c64e_20f871de",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 170,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-14T05:19:10Z",
      "side": 1,
      "message": "\u003e How about a deadline on completion of this loop?\n\nThis also depends on the usage. If the other point is not a problem, this might be OK. (But then I wonder how much or why we need to ClearEvent.)\n\n\u003e Restarting the whole thing seems like an overkill\n\nYes, it might be much overhead so it is not the best solution if we have some others. \n\n\u003e it may actually result in skipping some events\n\nClearEvents will just drop all events so I think another New should be the same if the timing of New and ClearEvents is the same?\n\nHowever, this reminds me that we don\u0027t actually wait until wpa_cli getting ready for watching events. cmd.Start will return when the process is created but it is not guaranteed that initialization of wpa_cli is finished. We suffered a similar problem with \"iw event\" which prints nothing after initialization. Is there any message we can know wpa_cli is ready?",
      "parentUuid": "d923bae7_428683be",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fa15d800_3a4b6da5",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 170,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-14T08:52:20Z",
      "side": 1,
      "message": "It is fine for the purpose of my tests, so I would leave it.\nI have added timeout to avoid deadlock and clarified limitations in the comment.\nAnd yes, good catch with the ready check - added in Start.",
      "parentUuid": "0a27c64e_20f871de",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ed1b599e_b2aaea2a",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 186,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-12T05:36:44Z",
      "side": 1,
      "message": "The behavior sounds a little weird to me. Personally, I would expect (nil, ctx.Err()) in this case. May I know the usage that needs this behavior?",
      "range": {
        "startLine": 186,
        "startChar": 0,
        "endLine": 186,
        "endChar": 59
      },
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8d5ae290_4f02a416",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 186,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-13T07:52:46Z",
      "side": 1,
      "message": "A timeout here is not an error. You wait for an event for specific time (context deadline) and if nothing comes in then you move forward. This is actual case in the upcoming RoamNatural test - check if any roams happened during specific time after changing attenuation, and log them, or move forward if nothing happened.",
      "parentUuid": "ed1b599e_b2aaea2a",
      "range": {
        "startLine": 186,
        "startChar": 0,
        "endLine": 186,
        "endChar": 59
      },
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4d4ef480_1113b18f",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 186,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-13T09:32:54Z",
      "side": 1,
      "message": "The caller can still check the timeout error but for the specific usage, this design might make sense. But then I\u0027m thinking if we still need the error in return (always nil for now).",
      "parentUuid": "8d5ae290_4f02a416",
      "range": {
        "startLine": 186,
        "startChar": 0,
        "endLine": 186,
        "endChar": 59
      },
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f6dd2462_a3deb907",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 186,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-13T11:09:48Z",
      "side": 1,
      "message": "Right, now the error is not needed.",
      "parentUuid": "4d4ef480_1113b18f",
      "range": {
        "startLine": 186,
        "startChar": 0,
        "endLine": 186,
        "endChar": 59
      },
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dbab83a8_1839897c",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 199,
      "author": {
        "id": 1243287
      },
      "writtenOn": "2020-10-09T21:49:19Z",
      "side": 1,
      "message": "nit: combine.",
      "range": {
        "startLine": 198,
        "startChar": 4,
        "endLine": 199,
        "endChar": 21
      },
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f4d562fe_708f96e9",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 199,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-13T07:52:46Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "dbab83a8_1839897c",
      "range": {
        "startLine": 198,
        "startChar": 4,
        "endLine": 199,
        "endChar": 21
      },
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e1b3ce9f_29617422",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 207,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-12T05:36:44Z",
      "side": 1,
      "message": "Is this reachable? If not, I guess `go vet` will complain about this.",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "852f13b4_49fdbc34",
        "filename": "src/chromiumos/tast/remote/wificell/wpa_monitor.go",
        "patchSetId": 1
      },
      "lineNbr": 207,
      "author": {
        "id": 1431109
      },
      "writtenOn": "2020-10-13T07:52:46Z",
      "side": 1,
      "message": "It does not complain, but you\u0027re right, not needed.",
      "parentUuid": "e1b3ce9f_29617422",
      "revId": "e94372e47800f040d70c8f7cc4a347ecbe2846cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}