{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "50e7368d_149a1aff",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1412245
      },
      "writtenOn": "2020-10-13T15:19:32Z",
      "side": 1,
      "message": "I looked up the source, Stadia seems to be using Wiz framework[1], calling wiz_progress() and wiz_tick to load controller and renderer[2]. I suspect that the progress bar indicating the loading of controller and renderer, which we should wait for it to be done. document.readyState can\u0027t be an indicator here, thus webutil.WaitForQuiescence also shouldn\u0027t work accurately.\n\nFor now, I can\u0027t think of any other way to wait for wiz loading instead of using Sleep()...\n\n[1] https://g3doc.corp.google.com/java/com/google/chrome/cloudcast/partnerportal/g3doc/development.md?cl\u003dhead#wiz-client-side-and-server-side-rendering\n[2] https://screenshot.googleplex.com/7kL8FvH7pNCMXog.png",
      "revId": "6353d46a4ee68e8c532ac974049f463b1302868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9b33ca5b_478517fd",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1000101
      },
      "writtenOn": "2020-10-13T16:24:25Z",
      "side": 1,
      "message": "If we could identity the DOM node we want in the desired UI state, it does not really matter of which JS library is used. We could poll the DOM tree and wait for the element to show up.\n\nn.DescendantWithTimeout is supposed to do that. If that is not working because the element is hidden in ax tree, we could use WaitForExpr etc to inject JS to find the desired element.",
      "parentUuid": "50e7368d_149a1aff",
      "revId": "6353d46a4ee68e8c532ac974049f463b1302868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b98f9d8b_8811a5ab",
        "filename": "src/chromiumos/tast/local/bundles/cros/ui/stadiacuj/stadia_util.go",
        "patchSetId": 4
      },
      "lineNbr": 45,
      "author": {
        "id": 1000101
      },
      "writtenOn": "2020-10-05T19:13:47Z",
      "side": 1,
      "message": "Generally we want to avoid sleep with random time. Do we know why n.DescendantWithTimeout does not work? \n\nIf n.DescendantWithTimeout failure is expected, is there anything on the page that we could wait for?\ne.g.\n\n  conn.WaitForExpr(ctx, \"some condition in the page\u0027s context\")\n\nOr maybe we should bring back webutil.WaitForQuiescence but ignore its timeout error (since the page could be streaming things and never be quiet).",
      "revId": "6353d46a4ee68e8c532ac974049f463b1302868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e4f0e453_8535496d",
        "filename": "src/chromiumos/tast/local/bundles/cros/ui/stadiacuj/stadia_util.go",
        "patchSetId": 4
      },
      "lineNbr": 45,
      "author": {
        "id": 1412245
      },
      "writtenOn": "2020-10-05T19:23:23Z",
      "side": 1,
      "message": "From what I observed, the game page is redirected to other pages (such as the former All Games page) after clicking the gamePlayButton. Just feel like it\u0027s too quick to click the gamePlayButton even it is already existing on the game page.",
      "parentUuid": "b98f9d8b_8811a5ab",
      "revId": "6353d46a4ee68e8c532ac974049f463b1302868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1f69e4b5_66406578",
        "filename": "src/chromiumos/tast/local/bundles/cros/ui/stadiacuj/stadia_util.go",
        "patchSetId": 4
      },
      "lineNbr": 45,
      "author": {
        "id": 1000101
      },
      "writtenOn": "2020-10-05T19:28:24Z",
      "side": 1,
      "message": "If page url is changed, it implies a document load. Maybe we should do this [1] before trying to find and click gamePlayButton.\n\n[1] https://source.corp.google.com/chromeos_public/src/platform/tast-tests/src/chromiumos/tast/local/chrome/chrome.go;l\u003d962",
      "parentUuid": "e4f0e453_8535496d",
      "revId": "6353d46a4ee68e8c532ac974049f463b1302868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0546ff8d_11c69166",
        "filename": "src/chromiumos/tast/local/bundles/cros/ui/stadiacuj/stadia_util.go",
        "patchSetId": 4
      },
      "lineNbr": 45,
      "author": {
        "id": 1000479
      },
      "writtenOn": "2020-10-05T21:13:57Z",
      "side": 1,
      "message": "you could also check location.href with testing.Poll to ensure that the URL is updated.",
      "parentUuid": "1f69e4b5_66406578",
      "revId": "6353d46a4ee68e8c532ac974049f463b1302868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fdb3297d_307f07b1",
        "filename": "src/chromiumos/tast/local/bundles/cros/ui/stadiacuj/stadia_util.go",
        "patchSetId": 4
      },
      "lineNbr": 45,
      "author": {
        "id": 1412245
      },
      "writtenOn": "2020-10-06T21:12:58Z",
      "side": 1,
      "message": "From my observed[1], it seems like the tab is still loading (14s) even when document.readyState is \u0027complete\u0027 (11s).\n\nMaybe webutil.WaitForQuiescence approach is more doable in this case?\n\n[1] https://drive.google.com/file/d/19QBq3uBVBpNTCdRKdBuSMnOiyz3nJbQY/view?usp\u003dsharing",
      "parentUuid": "0546ff8d_11c69166",
      "revId": "6353d46a4ee68e8c532ac974049f463b1302868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1e3c27f4_e8a16710",
        "filename": "src/chromiumos/tast/local/bundles/cros/ui/stadiacuj/stadia_util.go",
        "patchSetId": 4
      },
      "lineNbr": 45,
      "author": {
        "id": 1000101
      },
      "writtenOn": "2020-10-06T21:50:02Z",
      "side": 1,
      "message": "From the video, it seem there might be no actual page load. It would be like youtube page that URL change is more like the app pushing its state into history. document.readyState would not work if there is no page load.\n\nI wonder why n.DescendantWithTimeout below does not work. It seems like the case it should support, wait until a node mathces the FindParams to show up. What is |timeout|? 10s? Maybe it is not long enough?\n\nFor webutil.WaitForQuiescence, think we had it before and removed because it causes timeout (maybe because the page is loading network resources continuously). I don\u0027t object to putting it back but that timeout might come back.",
      "parentUuid": "fdb3297d_307f07b1",
      "revId": "6353d46a4ee68e8c532ac974049f463b1302868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a251710b_d7465b5c",
        "filename": "src/chromiumos/tast/local/bundles/cros/ui/stadiacuj/stadia_util.go",
        "patchSetId": 4
      },
      "lineNbr": 45,
      "author": {
        "id": 1412245
      },
      "writtenOn": "2020-10-06T23:12:45Z",
      "side": 1,
      "message": "I think it did find the gamePlayButton as you can see that the mouse hovered over the \"Play\" button. After clicking the \"Play\" button, the page jumped back to the former page with the game list, which is pretty weird...\nlet me find some other solutions for waiting...",
      "parentUuid": "1e3c27f4_e8a16710",
      "revId": "6353d46a4ee68e8c532ac974049f463b1302868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}