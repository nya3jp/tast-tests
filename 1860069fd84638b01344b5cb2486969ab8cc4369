{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "acbb3273_ee10c3d9",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1507611
      },
      "writtenOn": "2022-03-16T00:16:03Z",
      "side": 1,
      "message": "+edcourtney hidehiko for the lacros tast review",
      "revId": "1860069fd84638b01344b5cb2486969ab8cc4369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "26baffaa_a2b67640",
        "filename": "src/chromiumos/tast/local/bundles/cros/lacros/variation_smoke.go",
        "patchSetId": 4
      },
      "lineNbr": 6,
      "author": {
        "id": 1507611
      },
      "writtenOn": "2022-03-16T00:16:03Z",
      "side": 1,
      "message": "Is there a reason to have the lacros smoke test separated from `ui.ChromeVariationSmoke`? Is it possible to expand it as parameterized tests to work for both ash-chrome and lacros-chrome? \nIMO if the majority of the test code is in common it would help reduce the maintenance cost and keep them consistent between two browser targets.\nhttp://go/lacros-tast-porting if it helps.",
      "range": {
        "startLine": 6,
        "startChar": 0,
        "endLine": 6,
        "endChar": 14
      },
      "revId": "1860069fd84638b01344b5cb2486969ab8cc4369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "026afee5_80690eb6",
        "filename": "src/chromiumos/tast/local/bundles/cros/lacros/variation_smoke.go",
        "patchSetId": 4
      },
      "lineNbr": 6,
      "author": {
        "id": 1390967
      },
      "writtenOn": "2022-03-16T00:36:46Z",
      "side": 1,
      "message": "One of the big parts of `ui.ChromeVariationsSmoke` is checking that the user session can start without crashing, since the finch seed is loaded and applied when the user logs in. If lacros loads Finch seeds independently of the OS, then I think the browser check in `ui.ChromeVariationsSmoke` will become unnecessary when lacros becomes the only browser, so these tests will be testing two different things at that point (validity of the finch seed for the OS session vs. validity of a different finch seed for the browser).\n\nBased on that I feel like they should be separate tests, but perhaps some of the shared utilities could be moved to a supporting package. WDYT?",
      "parentUuid": "26baffaa_a2b67640",
      "range": {
        "startLine": 6,
        "startChar": 0,
        "endLine": 6,
        "endChar": 14
      },
      "revId": "1860069fd84638b01344b5cb2486969ab8cc4369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c27af7cf_d53113a3",
        "filename": "src/chromiumos/tast/local/bundles/cros/lacros/variation_smoke.go",
        "patchSetId": 4
      },
      "lineNbr": 6,
      "author": {
        "id": 1507611
      },
      "writtenOn": "2022-03-16T00:54:24Z",
      "side": 1,
      "message": "I see. IIUC ideally it could be parameterized tests that verify the finch seed for the OS session in common then verify a different finch seed for each browser type specified with different params (ash-chrome vs lacros-chrome).\nBy the way, migrating the use case like `ui.ChromeVariationsSmoke` (chrome.New with no fixture) is not currently supported by the lacros porting guidelines until a planned refactoring is completed.\n\n+edcourtney, hidehiko for any insights into this.",
      "parentUuid": "026afee5_80690eb6",
      "range": {
        "startLine": 6,
        "startChar": 0,
        "endLine": 6,
        "endChar": 14
      },
      "revId": "1860069fd84638b01344b5cb2486969ab8cc4369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "43d2eeba_8bc916dd",
        "filename": "src/chromiumos/tast/local/bundles/cros/lacros/variation_smoke.go",
        "patchSetId": 4
      },
      "lineNbr": 6,
      "author": {
        "id": 1509752
      },
      "writtenOn": "2022-03-16T21:03:59Z",
      "side": 1,
      "message": "Hi Hyung Tae, thanks for point it out. This test is part of the finch and lacros effort. This is the related design doc https://docs.google.com/document/d/1RYoX2bEKlx4UGRfJFmAzGxsRseKSqpYf6G-7XzFXLbU/edit#heading\u003dh.vjradtbjung9 and we also have a OKR for this. https://screenshot.googleplex.com/7WCRmyikEXsndUN Since (chrome.New with no fixture) is not currently supported by the lacros porting guidelines. Could we keep them both for now?",
      "parentUuid": "c27af7cf_d53113a3",
      "range": {
        "startLine": 6,
        "startChar": 0,
        "endLine": 6,
        "endChar": 14
      },
      "revId": "1860069fd84638b01344b5cb2486969ab8cc4369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9a4e2182_461e3b55",
        "filename": "src/chromiumos/tast/local/bundles/cros/lacros/variation_smoke.go",
        "patchSetId": 4
      },
      "lineNbr": 6,
      "author": {
        "id": 1507611
      },
      "writtenOn": "2022-03-16T21:34:02Z",
      "side": 1,
      "message": "Fine with me if that\u0027s what you\u0027re aware of.\n\nIIUC (correct me if I\u0027m mistaken) what you\u0027d like to verify on each combination of OS/Lacros builds is the seed for three targets - (1) OS session, (2) ash-chrome as system browser and (3) lacros-chrome as web browser.\n\nui.ChromeVariationsSmoke \u003d\u003e covers (1) and (2)\nlacros.VariationSmoke \u003d\u003e covers (3), but not together with (1)\n\nI guess it should be fine as long as all of them are covered across those tests since making ui.ChromeVariationsSmoke work for both browsers seems to have been blocked, which could be a TODO for the future.\nI\u0027ll probably defer to +hidehiko, edcourtney for the view from the lacros team\u0027s perspective since they are making some changes to lacros launch strategy, which likely conflict with this CL.",
      "parentUuid": "43d2eeba_8bc916dd",
      "range": {
        "startLine": 6,
        "startChar": 0,
        "endLine": 6,
        "endChar": 14
      },
      "revId": "1860069fd84638b01344b5cb2486969ab8cc4369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "14af8e73_699c8f50",
        "filename": "src/chromiumos/tast/local/bundles/cros/lacros/variation_smoke.go",
        "patchSetId": 4
      },
      "lineNbr": 6,
      "author": {
        "id": 1390967
      },
      "writtenOn": "2022-03-19T01:08:38Z",
      "side": 1,
      "message": "Yeah I think it would be best to get some input from those more familiar with finch on lacros. My feeling is that lacros.VariationSmoke shouldn\u0027t need to cover (1) in favor of testing both finch mechanisms independently, unless it\u0027s conceivable that an OS finch experiment could break lacros while not affecting the OS session.",
      "parentUuid": "9a4e2182_461e3b55",
      "range": {
        "startLine": 6,
        "startChar": 0,
        "endLine": 6,
        "endChar": 14
      },
      "revId": "1860069fd84638b01344b5cb2486969ab8cc4369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "04123771_24d4a61a",
        "filename": "src/chromiumos/tast/local/bundles/cros/lacros/variation_smoke.go",
        "patchSetId": 4
      },
      "lineNbr": 31,
      "author": {
        "id": 1507611
      },
      "writtenOn": "2022-03-16T00:16:03Z",
      "side": 1,
      "message": "nit: \"lacrosPrimary\" would be preferred given the current milestone",
      "range": {
        "startLine": 31,
        "startChar": 17,
        "endLine": 31,
        "endChar": 23
      },
      "revId": "1860069fd84638b01344b5cb2486969ab8cc4369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "35c732c6_fb38592b",
        "filename": "src/chromiumos/tast/local/bundles/cros/lacros/variation_smoke.go",
        "patchSetId": 4
      },
      "lineNbr": 31,
      "author": {
        "id": 1509752
      },
      "writtenOn": "2022-03-16T21:03:59Z",
      "side": 1,
      "message": "This tast test will be run on Lacros CI builder, I think they want to use the stateful lacros instead of rootFS lacros.",
      "parentUuid": "04123771_24d4a61a",
      "range": {
        "startLine": 31,
        "startChar": 17,
        "endLine": 31,
        "endChar": 23
      },
      "revId": "1860069fd84638b01344b5cb2486969ab8cc4369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "69788b9d_74be7c3e",
        "filename": "src/chromiumos/tast/local/bundles/cros/lacros/variation_smoke.go",
        "patchSetId": 4
      },
      "lineNbr": 31,
      "author": {
        "id": 1507611
      },
      "writtenOn": "2022-03-16T21:34:02Z",
      "side": 1,
      "message": "AFAICT \u0027lacrosPrimary\u0027 is set to use lacros as a primary browser, thus still necessary unless you\u0027re testing lacros side-by-side. Whether rootfs-lacros vs. stateful is rather determined by the one specified with the runtime var in Lacros CI.",
      "parentUuid": "35c732c6_fb38592b",
      "range": {
        "startLine": 31,
        "startChar": 17,
        "endLine": 31,
        "endChar": 23
      },
      "revId": "1860069fd84638b01344b5cb2486969ab8cc4369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "69a8bee9_b470f57e",
        "filename": "src/chromiumos/tast/local/bundles/cros/lacros/variation_smoke.go",
        "patchSetId": 4
      },
      "lineNbr": 31,
      "author": {
        "id": 1509752
      },
      "writtenOn": "2022-03-17T18:15:13Z",
      "side": 1,
      "message": "Fixed",
      "parentUuid": "69788b9d_74be7c3e",
      "range": {
        "startLine": 31,
        "startChar": 17,
        "endLine": 31,
        "endChar": 23
      },
      "revId": "1860069fd84638b01344b5cb2486969ab8cc4369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f9003db5_942d56e2",
        "filename": "src/chromiumos/tast/local/bundles/cros/lacros/variation_smoke.go",
        "patchSetId": 4
      },
      "lineNbr": 136,
      "author": {
        "id": 1507611
      },
      "writtenOn": "2022-03-16T00:16:03Z",
      "side": 1,
      "message": "If it needs to pass in custom chrome options, you can probably consider adding your own fixture with those options passed in. then call a browserfixt.SetUp* method to get a browser instance that works for both browsers.",
      "range": {
        "startLine": 132,
        "startChar": 0,
        "endLine": 136,
        "endChar": 0
      },
      "revId": "1860069fd84638b01344b5cb2486969ab8cc4369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "aa4b2d0f_2235f2c3",
        "filename": "src/chromiumos/tast/local/bundles/cros/lacros/variation_smoke.go",
        "patchSetId": 4
      },
      "lineNbr": 136,
      "author": {
        "id": 1509752
      },
      "writtenOn": "2022-03-16T21:03:59Z",
      "side": 1,
      "message": "I see. Thanks. I think these args are not chrome options. They are parameters used when running a launch lacros script. https://source.chromium.org/chromiumos/chromiumos/codesearch/+/main:src/platform/tast-tests/src/chromiumos/tast/local/chrome/lacros/launch.go;l\u003d131-151?q\u003dlacros%2Flaunch.go",
      "parentUuid": "f9003db5_942d56e2",
      "range": {
        "startLine": 132,
        "startChar": 0,
        "endLine": 136,
        "endChar": 0
      },
      "revId": "1860069fd84638b01344b5cb2486969ab8cc4369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ae27dabf_f368c186",
        "filename": "src/chromiumos/tast/local/bundles/cros/lacros/variation_smoke.go",
        "patchSetId": 4
      },
      "lineNbr": 136,
      "author": {
        "id": 1507611
      },
      "writtenOn": "2022-03-16T21:34:02Z",
      "side": 1,
      "message": "You may refer to some examples of the custom fixtures at http://cs/chromeos_public/src/platform/tast-tests/src/chromiumos/tast/local/chrome/lacros/lacrosfixt/fixtimpl.go and use it just for your test.\n\n```\ntesting.AddFixture(\u0026testing.Fixture{\n\tName:     \"lacrosForYourNeed\",  // can name this.\n\tImpl: NewFixture(Rootfs, func(ctx context.Context, s *testing.FixtState) ([]chrome.Option, error) {\n\t\treturn []chrome.Option{chrome.LacrosExtraArgs(\"--variations-server-url\")}, nil\n\t\t}),\n\tVars:            []string{LacrosDeployedBinary},\n})\n```",
      "parentUuid": "aa4b2d0f_2235f2c3",
      "range": {
        "startLine": 132,
        "startChar": 0,
        "endLine": 136,
        "endChar": 0
      },
      "revId": "1860069fd84638b01344b5cb2486969ab8cc4369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6a187572_88e0ef77",
        "filename": "src/chromiumos/tast/local/bundles/cros/lacros/variation_smoke.go",
        "patchSetId": 4
      },
      "lineNbr": 136,
      "author": {
        "id": 1509752
      },
      "writtenOn": "2022-03-17T17:56:48Z",
      "side": 1,
      "message": "Thanks for the suggestion. I fixed it.",
      "parentUuid": "ae27dabf_f368c186",
      "range": {
        "startLine": 132,
        "startChar": 0,
        "endLine": 136,
        "endChar": 0
      },
      "revId": "1860069fd84638b01344b5cb2486969ab8cc4369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1f961145_fb3898e3",
        "filename": "src/chromiumos/tast/local/chrome/lacros/launch.go",
        "patchSetId": 4
      },
      "lineNbr": 134,
      "author": {
        "id": 1507611
      },
      "writtenOn": "2022-03-16T00:16:03Z",
      "side": 1,
      "message": "If it\u0027s specific to the variation test, it could move to your test package rather than here in the lacros package?",
      "range": {
        "startLine": 132,
        "startChar": 0,
        "endLine": 134,
        "endChar": 18
      },
      "revId": "1860069fd84638b01344b5cb2486969ab8cc4369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0321e6ad_9c516921",
        "filename": "src/chromiumos/tast/local/chrome/lacros/launch.go",
        "patchSetId": 4
      },
      "lineNbr": 134,
      "author": {
        "id": 1509752
      },
      "writtenOn": "2022-03-16T21:03:59Z",
      "side": 1,
      "message": "Do you suggest to create a separate package for variation test? I saw most lacros related tast tests are under this package. Could we keep it here?",
      "parentUuid": "1f961145_fb3898e3",
      "range": {
        "startLine": 132,
        "startChar": 0,
        "endLine": 134,
        "endChar": 18
      },
      "revId": "1860069fd84638b01344b5cb2486969ab8cc4369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "eb9462a2_c57263cf",
        "filename": "src/chromiumos/tast/local/chrome/lacros/launch.go",
        "patchSetId": 4
      },
      "lineNbr": 134,
      "author": {
        "id": 1507611
      },
      "writtenOn": "2022-03-16T21:34:02Z",
      "side": 1,
      "message": "Does it make sense moving this to the top of your test body post your fixture is set, rather than this library code where it is agnostic to user scenarios?",
      "parentUuid": "0321e6ad_9c516921",
      "range": {
        "startLine": 132,
        "startChar": 0,
        "endLine": 134,
        "endChar": 18
      },
      "revId": "1860069fd84638b01344b5cb2486969ab8cc4369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6b2b0e68_5a017f10",
        "filename": "src/chromiumos/tast/local/chrome/lacros/launch.go",
        "patchSetId": 4
      },
      "lineNbr": 134,
      "author": {
        "id": 1509752
      },
      "writtenOn": "2022-03-17T17:56:48Z",
      "side": 1,
      "message": "I could move \nif err :\u003d os.MkdirAll(userDataDir, 0755); err !\u003d nil {return nil, err } to the fixtureimpl.go. However the userDataDir is also needed to change and used in line 143.",
      "parentUuid": "eb9462a2_c57263cf",
      "range": {
        "startLine": 132,
        "startChar": 0,
        "endLine": 134,
        "endChar": 18
      },
      "revId": "1860069fd84638b01344b5cb2486969ab8cc4369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d35d68bd_9bb813e5",
        "filename": "src/chromiumos/tast/local/chrome/lacros/launch.go",
        "patchSetId": 4
      },
      "lineNbr": 134,
      "author": {
        "id": 1507611
      },
      "writtenOn": "2022-03-17T18:19:31Z",
      "side": 1,
      "message": "To be clear, what I meant was moving to somewhere in variation_smoke.go. Just for a heads-up, this is going to be conflict with a pending CL https://crrev.com/c/3524047 that changes the way of launching lacros (and its user data dir as well) that got me think this line of code may not be necessary once the CL gets in.\nEliot, can you confirm?",
      "parentUuid": "6b2b0e68_5a017f10",
      "range": {
        "startLine": 132,
        "startChar": 0,
        "endLine": 134,
        "endChar": 18
      },
      "revId": "1860069fd84638b01344b5cb2486969ab8cc4369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}