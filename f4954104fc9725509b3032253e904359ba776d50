{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "6325788d_dd303439",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 12,
      "author": {
        "id": 1126309
      },
      "writtenOn": "2022-09-08T22:52:15Z",
      "side": 1,
      "message": "Agreed! There\u0027ll be more differences than commonalities.",
      "range": {
        "startLine": 10,
        "startChar": 17,
        "endLine": 12,
        "endChar": 58
      },
      "revId": "f4954104fc9725509b3032253e904359ba776d50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d8378a8b_40c1b037",
        "filename": "src/chromiumos/tast/local/bundles/cros/cryptohome/add_remove_factors_ephemeral.go",
        "patchSetId": 2
      },
      "lineNbr": 39,
      "author": {
        "id": 1126309
      },
      "writtenOn": "2022-09-08T22:52:15Z",
      "side": 1,
      "message": "Ephemeral users use neither VK nor USS, so in theory this is orthogonal to the test done below, and a single test case would be sufficient.\n\nOr you want to be on the safe side and prevent a possibility of accidentally introducing VK/USS differences in the ephemeral user handling?",
      "revId": "f4954104fc9725509b3032253e904359ba776d50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8cd5d65f_5582205f",
        "filename": "src/chromiumos/tast/local/bundles/cros/cryptohome/add_remove_factors_ephemeral.go",
        "patchSetId": 2
      },
      "lineNbr": 39,
      "author": {
        "id": 1546868
      },
      "writtenOn": "2022-09-08T23:25:29Z",
      "side": 1,
      "message": "I wrote it this way under the premise that it should work with either, and so why not cover both cases. I admit that this is probably influenced by me starting with the original non-ephemeral case.\n\nMaybe it\u0027s not worth it?",
      "parentUuid": "d8378a8b_40c1b037",
      "revId": "f4954104fc9725509b3032253e904359ba776d50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "146f68ec_5aefcee3",
        "filename": "src/chromiumos/tast/local/bundles/cros/cryptohome/add_remove_factors_ephemeral.go",
        "patchSetId": 2
      },
      "lineNbr": 39,
      "author": {
        "id": 1126309
      },
      "writtenOn": "2022-09-08T23:36:20Z",
      "side": 1,
      "message": "OK, I guess it\u0027s fine to have these two sub-tests, given that we know the same files that implement ephemeral users are flooded with \"if USS enabled\" checks.\n\nBut please add a comment somewhere, so that readers of this test file aren\u0027t surprised in the same way as I was. Something like:\n\n    // While the ephemeral user behavior shouldn\u0027t in theory be affected be whether the\n    // UserSecretStash is enabled in cryptohome, we have two separate sub-tests to\n    // actually verify this in both cases.",
      "parentUuid": "8cd5d65f_5582205f",
      "revId": "f4954104fc9725509b3032253e904359ba776d50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7e0db7ad_ed7990a8",
        "filename": "src/chromiumos/tast/local/bundles/cros/cryptohome/add_remove_factors_ephemeral.go",
        "patchSetId": 2
      },
      "lineNbr": 55,
      "author": {
        "id": 1126309
      },
      "writtenOn": "2022-09-08T22:52:15Z",
      "side": 1,
      "message": "I believe a more standard approach is to return the error from the function.\n\nI was also pushed in this direction by Tast reviewers a few times in the past. The arguments IIUC are: that way more context will be added to the error (as, while unwinding the call stack, each frame will likely add more context to the error), or the caller might expect the error in some scenarios, or the caller might want to run a function in a poll loop (until it succeeds).",
      "range": {
        "startLine": 55,
        "startChar": 34,
        "endLine": 55,
        "endChar": 46
      },
      "revId": "f4954104fc9725509b3032253e904359ba776d50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "78e91d8b_14c3abe0",
        "filename": "src/chromiumos/tast/local/bundles/cros/cryptohome/add_remove_factors_ephemeral.go",
        "patchSetId": 2
      },
      "lineNbr": 55,
      "author": {
        "id": 1546868
      },
      "writtenOn": "2022-09-08T23:25:29Z",
      "side": 1,
      "message": "Hmm, I think in the original test it just started out as refactoring a bunch of duplicated checking away, so flowing stuff back up to the top level function didn\u0027t make sense. And this helper is following the same pattern, just stripped down. Maybe if we move it to helpers (more likely, just moving the original version from the original persistent user test) then it would make more sense to have it return instead.",
      "parentUuid": "7e0db7ad_ed7990a8",
      "range": {
        "startLine": 55,
        "startChar": 34,
        "endLine": 55,
        "endChar": 46
      },
      "revId": "f4954104fc9725509b3032253e904359ba776d50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "be312498_9c9308eb",
        "filename": "src/chromiumos/tast/local/bundles/cros/cryptohome/add_remove_factors_ephemeral.go",
        "patchSetId": 2
      },
      "lineNbr": 55,
      "author": {
        "id": 1126309
      },
      "writtenOn": "2022-09-08T23:36:20Z",
      "side": 1,
      "message": "Ack, I guess I\u0027ll just defer this to tast-owners@.",
      "parentUuid": "78e91d8b_14c3abe0",
      "range": {
        "startLine": 55,
        "startChar": 34,
        "endLine": 55,
        "endChar": 46
      },
      "revId": "f4954104fc9725509b3032253e904359ba776d50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d3e7a2fc_690b94b5",
        "filename": "src/chromiumos/tast/local/bundles/cros/cryptohome/add_remove_factors_ephemeral.go",
        "patchSetId": 2
      },
      "lineNbr": 64,
      "author": {
        "id": 1126309
      },
      "writtenOn": "2022-09-08T22:52:15Z",
      "side": 1,
      "message": "This small primitive can be useful in other tests. I\u0027ve just created the src/chromiumos/tast/common/cryptohome/helpers.go (the CL landed yesterday) where such helpers could be put I think.",
      "revId": "f4954104fc9725509b3032253e904359ba776d50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "db379e08_14117970",
        "filename": "src/chromiumos/tast/local/bundles/cros/cryptohome/add_remove_factors_ephemeral.go",
        "patchSetId": 2
      },
      "lineNbr": 64,
      "author": {
        "id": 1546868
      },
      "writtenOn": "2022-09-08T23:25:29Z",
      "side": 1,
      "message": "Hmm, a bit tricky to refactor generically, though, because it needs to make a less function? I\u0027ll think about if there\u0027s a way I can refactor the comparison code into something we can reuse, but I\u0027m not so sure there\u0027s a good way to make calling cmp and cmpopts more reusable than what they already provide.",
      "parentUuid": "d3e7a2fc_690b94b5",
      "revId": "f4954104fc9725509b3032253e904359ba776d50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bab68623_4e839ecc",
        "filename": "src/chromiumos/tast/local/bundles/cros/cryptohome/add_remove_factors_ephemeral.go",
        "patchSetId": 2
      },
      "lineNbr": 64,
      "author": {
        "id": 1126309
      },
      "writtenOn": "2022-09-08T23:36:20Z",
      "side": 1,
      "message": "Golang doesn\u0027t allow to make very generic helpers IIUC, but we could have a helper speicifcally for `AuthFactorType`s, similarly to the `ExpectAuthIntents()` function in the file I quoted above. Just as a ready-to-use tool that can tell you whether two sets of types are equal, and if not format the difference appropriately.",
      "parentUuid": "db379e08_14117970",
      "revId": "f4954104fc9725509b3032253e904359ba776d50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5475de22_d3b03051",
        "filename": "src/chromiumos/tast/local/bundles/cros/cryptohome/add_remove_factors_ephemeral.go",
        "patchSetId": 2
      },
      "lineNbr": 131,
      "author": {
        "id": 1126309
      },
      "writtenOn": "2022-09-08T22:52:15Z",
      "side": 1,
      "message": "nit: \"ephemeral\". Ditto in the log in line 137.",
      "range": {
        "startLine": 131,
        "startChar": 25,
        "endLine": 131,
        "endChar": 35
      },
      "revId": "f4954104fc9725509b3032253e904359ba776d50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "78aba050_2fde48ec",
        "filename": "src/chromiumos/tast/local/bundles/cros/cryptohome/add_remove_factors_ephemeral.go",
        "patchSetId": 2
      },
      "lineNbr": 131,
      "author": {
        "id": 1546868
      },
      "writtenOn": "2022-09-08T23:25:29Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5475de22_d3b03051",
      "range": {
        "startLine": 131,
        "startChar": 25,
        "endLine": 131,
        "endChar": 35
      },
      "revId": "f4954104fc9725509b3032253e904359ba776d50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0cb14817_6f71065e",
        "filename": "src/chromiumos/tast/local/bundles/cros/cryptohome/add_remove_factors_ephemeral.go",
        "patchSetId": 2
      },
      "lineNbr": 136,
      "author": {
        "id": 1126309
      },
      "writtenOn": "2022-09-08T22:52:15Z",
      "side": 1,
      "message": "nit: Remove `/*ecryptfs\u003d*/`.",
      "range": {
        "startLine": 136,
        "startChar": 59,
        "endLine": 136,
        "endChar": 72
      },
      "revId": "f4954104fc9725509b3032253e904359ba776d50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4fd20306_1ab40a4b",
        "filename": "src/chromiumos/tast/local/bundles/cros/cryptohome/add_remove_factors_ephemeral.go",
        "patchSetId": 2
      },
      "lineNbr": 136,
      "author": {
        "id": 1546868
      },
      "writtenOn": "2022-09-08T23:25:29Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "0cb14817_6f71065e",
      "range": {
        "startLine": 136,
        "startChar": 59,
        "endLine": 136,
        "endChar": 72
      },
      "revId": "f4954104fc9725509b3032253e904359ba776d50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7d859bf2_0d6b0b72",
        "filename": "src/chromiumos/tast/local/bundles/cros/cryptohome/add_remove_factors_ephemeral.go",
        "patchSetId": 2
      },
      "lineNbr": 141,
      "author": {
        "id": 1126309
      },
      "writtenOn": "2022-09-08T22:52:15Z",
      "side": 1,
      "message": "nit: Not sure how to parse the second sentence - seems unfinished?",
      "range": {
        "startLine": 141,
        "startChar": 56,
        "endLine": 141,
        "endChar": 90
      },
      "revId": "f4954104fc9725509b3032253e904359ba776d50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "baae8db5_cbdaa803",
        "filename": "src/chromiumos/tast/local/bundles/cros/cryptohome/add_remove_factors_ephemeral.go",
        "patchSetId": 2
      },
      "lineNbr": 141,
      "author": {
        "id": 1546868
      },
      "writtenOn": "2022-09-08T23:25:29Z",
      "side": 1,
      "message": "Yeah with the stripped down check it doesn\u0027t make as much sense any more to include all this text.",
      "parentUuid": "7d859bf2_0d6b0b72",
      "range": {
        "startLine": 141,
        "startChar": 56,
        "endLine": 141,
        "endChar": 90
      },
      "revId": "f4954104fc9725509b3032253e904359ba776d50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3096dc88_f2787e97",
        "filename": "src/chromiumos/tast/local/bundles/cros/cryptohome/add_remove_factors_ephemeral.go",
        "patchSetId": 2
      },
      "lineNbr": 153,
      "author": {
        "id": 1126309
      },
      "writtenOn": "2022-09-08T22:52:15Z",
      "side": 1,
      "message": "nit: The comment seems a bit misleading, since the test only checks \"supported\" factors in the reply, not the configured ones.",
      "range": {
        "startLine": 153,
        "startChar": 40,
        "endLine": 153,
        "endChar": 70
      },
      "revId": "f4954104fc9725509b3032253e904359ba776d50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2d26052a_e6083002",
        "filename": "src/chromiumos/tast/local/bundles/cros/cryptohome/add_remove_factors_ephemeral.go",
        "patchSetId": 2
      },
      "lineNbr": 153,
      "author": {
        "id": 1546868
      },
      "writtenOn": "2022-09-08T23:25:29Z",
      "side": 1,
      "message": "Yeah, I\u0027ll trim that down as well.",
      "parentUuid": "3096dc88_f2787e97",
      "range": {
        "startLine": 153,
        "startChar": 40,
        "endLine": 153,
        "endChar": 70
      },
      "revId": "f4954104fc9725509b3032253e904359ba776d50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6104f58b_9858596b",
        "filename": "src/chromiumos/tast/local/bundles/cros/cryptohome/add_remove_factors_ephemeral.go",
        "patchSetId": 2
      },
      "lineNbr": 160,
      "author": {
        "id": 1126309
      },
      "writtenOn": "2022-09-08T22:52:15Z",
      "side": 1,
      "message": "I don\u0027t think the PIN factor is supported for ephemeral users, or was planned to (at least because the in-memory verifier-based checks don\u0027t enforce any rate limiting today).\n\nI suppose this part of the test passes because cryptohome is lax and creates a credential verifier without checking the type (e.g., `AuthSession::AddAuthFactor()` immediately returns a success result for ephemeral users), but that\u0027s what I\u0027m about to fix in my chain of cryptohome CLs.",
      "revId": "f4954104fc9725509b3032253e904359ba776d50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "320524f6_b273ccb8",
        "filename": "src/chromiumos/tast/local/bundles/cros/cryptohome/add_remove_factors_ephemeral.go",
        "patchSetId": 2
      },
      "lineNbr": 160,
      "author": {
        "id": 1546868
      },
      "writtenOn": "2022-09-08T23:25:29Z",
      "side": 1,
      "message": "Yeah, I wasn\u0027t sure about that, seemed like maybe something that just \"worked\" by accident, and not really. Removed.",
      "parentUuid": "6104f58b_9858596b",
      "revId": "f4954104fc9725509b3032253e904359ba776d50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}