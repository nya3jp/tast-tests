{
  "comments": [
    {
      "key": {
        "uuid": "b09b3527_af742fb4",
        "filename": "src/chromiumos/tast/local/vm/crosvm.go",
        "patchSetId": 8
      },
      "lineNbr": 77,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-07-15T15:19:56Z",
      "side": 1,
      "message": "# Very sorry, overlooked here and below in the last iteration...\n\nyou need to close pw at the end of this function.\n(I found that os.exec does not close Stdout if it is *os.File).\nMy recommendation is,\n\ndefer pw.Close()\n\nat L77.",
      "revId": "7e6d9230797a07f10074967cab72f545c6896976",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c1369239_ad91c876",
        "filename": "src/chromiumos/tast/local/vm/crosvm.go",
        "patchSetId": 8
      },
      "lineNbr": 77,
      "author": {
        "id": 1304442
      },
      "writtenOn": "2019-07-16T16:41:53Z",
      "side": 1,
      "message": "Testing this locally works, but I\u0027m a little confused why it works. The defer will close the writing fd when NewCrosvm exits. How is the command\u0027s output still able to write to the fd if it is closed?",
      "parentUuid": "b09b3527_af742fb4",
      "revId": "7e6d9230797a07f10074967cab72f545c6896976",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "28a44a25_d3497569",
        "filename": "src/chromiumos/tast/local/vm/crosvm.go",
        "patchSetId": 8
      },
      "lineNbr": 77,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-07-16T17:26:32Z",
      "side": 1,
      "message": "defer pw.Close() is executed after vm.cmd.Start().\nIn vm.cmd.Start(), the process is cloned, so the fd exists in both this process and the child process.\nThen, pw.Close() happens, so the FD in the parent process is closed, while the one in child process is kept open (and connected to stdout).",
      "parentUuid": "c1369239_ad91c876",
      "revId": "7e6d9230797a07f10074967cab72f545c6896976",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5fb29ecc_25a3c465",
        "filename": "src/chromiumos/tast/local/vm/crosvm.go",
        "patchSetId": 8
      },
      "lineNbr": 81,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-07-15T15:19:56Z",
      "side": 1,
      "message": "pr needs to be closed here. Otherwise leaked.",
      "revId": "7e6d9230797a07f10074967cab72f545c6896976",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ea5257e7_1d5ff704",
        "filename": "src/chromiumos/tast/local/vm/crosvm.go",
        "patchSetId": 8
      },
      "lineNbr": 81,
      "author": {
        "id": 1304442
      },
      "writtenOn": "2019-07-16T16:41:53Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5fb29ecc_25a3c465",
      "revId": "7e6d9230797a07f10074967cab72f545c6896976",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f96bdb33_ea7bf9bc",
        "filename": "src/chromiumos/tast/local/vm/crosvm.go",
        "patchSetId": 8
      },
      "lineNbr": 100,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-07-15T15:19:56Z",
      "side": 1,
      "message": "IIUC, Close() needs to be called regardless of command execution status above.\nThus,\n\ndefer vm.stdout.Close()\n\nat the beginning of the Close() method.",
      "revId": "7e6d9230797a07f10074967cab72f545c6896976",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "688fc73a_55cbf561",
        "filename": "src/chromiumos/tast/local/vm/crosvm.go",
        "patchSetId": 8
      },
      "lineNbr": 100,
      "author": {
        "id": 1304442
      },
      "writtenOn": "2019-07-16T16:41:53Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f96bdb33_ea7bf9bc",
      "revId": "7e6d9230797a07f10074967cab72f545c6896976",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}