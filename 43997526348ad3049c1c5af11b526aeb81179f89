{
  "comments": [
    {
      "key": {
        "uuid": "29ea7e69_2aab15e0",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/data/dormant.js",
        "patchSetId": 33
      },
      "lineNbr": 12,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-11T02:51:53Z",
      "side": 1,
      "message": "nit: could you move down this to just before it is used? (between \"const resourceTimings...\" and \"if (resourceTimings...\")",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "01a767bf_c7f7b961",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/data/dormant.js",
        "patchSetId": 33
      },
      "lineNbr": 12,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:36:57Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "29ea7e69_2aab15e0",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7d7eb7ad_3d430020",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/data/dormant.js",
        "patchSetId": 33
      },
      "lineNbr": 21,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-11T02:51:53Z",
      "side": 1,
      "message": "resourceTimings is sorted by entries\u0027 startTime:\nhttps://developer.mozilla.org/en-US/docs/Web/API/Performance/getEntriesByType\n\nI guess we want to compute the maximum of responseEnd among all entries, rather than considering the last entry only.",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "43746a9a_5a6950fa",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/data/dormant.js",
        "patchSetId": 33
      },
      "lineNbr": 22,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-11T02:51:53Z",
      "side": 1,
      "message": "Do we really want to clear resource timings? This JS snippet is called repeatedly, so I\u0027m afraid this will affect secondary calls in undesired manner.",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d6733fa2_d4051fdc",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/data/dormant.js",
        "patchSetId": 33
      },
      "lineNbr": 22,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:36:57Z",
      "side": 1,
      "message": "No idea.  I was hoping this would be uncontroversial.\n\nShould I try this without clearing?  What are these \"secondary calls\" and what\u0027s the worst that can happen?",
      "parentUuid": "43746a9a_5a6950fa",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a145ab63_506932e1",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/data/dormant.js",
        "patchSetId": 33
      },
      "lineNbr": 22,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-16T08:46:23Z",
      "side": 1,
      "message": "Here\u0027s my understanding, please correct me if I\u0027m wrong:\n\nThis script is called repeatedly against a tab to wait until the tab becomes \"dormant\". The definition of \"dormant\" is that there was no \"resource load end\" event in last two seconds. And there are two types of \"resource\" considered here: one is for the main document itself (indicated by performance.timing.loadEventEnd), and the other is for subresources (computed by performance.getEntriesByType(\u0027resource\u0027)).\n\nGiven that the above understanding is correct, I think we should not call performance.clearResourceTimings() here.\n\nFor example, let\u0027s say we\u0027re loading a document with two resouces: the main doc was loaded at 1.0s (measured from the navigation start), and two resources were loaded at 2.0s and 2.1s. When we call the dormant function at 2.5s, it returns false becaue the last resource load was 0.4s ago. Then let\u0027s say we call the dormant function again at 3.1s. In this case, the actual last resource load is 1.0s ago (the second subresource), but since the first dormant function call cleared the resource events, the function thinks the last resource load was 2.1s ago (the main document), so it incorrectly returns true.",
      "parentUuid": "d6733fa2_d4051fdc",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "563da7da_feb4b9d3",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/data/dormant.js",
        "patchSetId": 33
      },
      "lineNbr": 29,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-11T02:51:53Z",
      "side": 1,
      "message": "This is essentially:\n\n const lastResponseTimeMs \u003d performance.now() - Math.max(lastResourceEnd, loadTime);\n\nwhere lastResourceEnd is lastEntry.responseEnd. So how about something like this:\n\n let lastResourceEnd \u003d 0;\n if (resourceTimings.length \u003e 0) {\n   lastResourceEnd \u003d ...;\n }\n \n const lastResponseTimeMs \u003d performance.now() - Math.max(lastResourceEnd, loadTime);",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "977a8ab5_336810d5",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/data/dormant.js",
        "patchSetId": 33
      },
      "lineNbr": 29,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:36:57Z",
      "side": 1,
      "message": "Is this not good enough?  It seems small enough, clear enough, and (I hope) correct. Does it have to be perfect?",
      "parentUuid": "563da7da_feb4b9d3",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "54b2c78a_61fd9452",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/data/dormant.js",
        "patchSetId": 33
      },
      "lineNbr": 29,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-16T08:46:23Z",
      "side": 1,
      "message": "I see you\u0027re frustrated by my comments, I\u0027m sorry for that.\n\nBut please remember I\u0027m here entirely to help you to improve the CL quality for you and future readers. I suggested the code above because I thought it makes the code slightly easier to follow. Whether to incorporate suggestions should be determined by discussion; reviewers\u0027 comments are never absolute. Please always feel free to start discussion when my comments do not make sense.",
      "parentUuid": "977a8ab5_336810d5",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3083d88e_c103c81a",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 0,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-11T02:51:53Z",
      "side": 1,
      "message": "Generally, this file has many redundant mentions to \"pageFaultMeter\". I guess you intend to add more metrics other than page faults in the future, but let\u0027s keep the naming simpler for now. We can change them any time.",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "eeb14611_5fc0c607",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 1,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-01-11T02:07:34Z",
      "side": 1,
      "message": "nit: 2019",
      "range": {
        "startLine": 1,
        "startChar": 13,
        "endLine": 1,
        "endChar": 17
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "424b5bfd_6feb4ebc",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 1,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "eeb14611_5fc0c607",
      "range": {
        "startLine": 1,
        "startChar": 13,
        "endLine": 1,
        "endChar": 17
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "864929b2_91c1eee3",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 5,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-01-11T02:07:34Z",
      "side": 1,
      "message": "nit: please add a package-level godoc comment, e.g.:\n\n  // Package osmeter is used ...",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "45550301_b627eec4",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 5,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "864929b2_91c1eee3",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "37c9a5e0_2f8d3da0",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 19,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-01-11T02:07:34Z",
      "side": 1,
      "message": "nit: avoid stutter: https://blog.golang.org/package-names\n\nmaybe just call this \"Meter\" or \"Stats\" or something similar?\n\n(also, it\u0027d be \"OS\" since go uses uniform capitalization for acronyms)",
      "range": {
        "startLine": 19,
        "startChar": 5,
        "endLine": 19,
        "endChar": 12
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7d0d3b67_0b69a7f1",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 19,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "37c9a5e0_2f8d3da0",
      "range": {
        "startLine": 19,
        "startChar": 5,
        "endLine": 19,
        "endChar": 12
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "68d6b7e4_1bd3ca30",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 20,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-01-11T02:07:34Z",
      "side": 1,
      "message": "please don\u0027t store contexts in structs: https://golang.org/pkg/context/\n\nthey should passed into the functions that use them instead",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9e10c4a2_c7f03e32",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 20,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "68d6b7e4_1bd3ca30",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "389589ef_321a8075",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 21,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-01-11T02:07:34Z",
      "side": 1,
      "message": "drop the long/repetitive \"pageFaultMeter\" prefix from all of these and just use mutex, startTime, etc.?\n\nor if you plan to add additional types of monitoring later, how about making this be a dedicated PageFaultMeter type and introducing separate structs for the other things later?\n\nplease also consider adding brief end-of-line comments to all of these fields:\n\n  mutex     sync.Mutex // protects foo, bar\n  startTime time.Time  // time at which Foo was called\n  etc.",
      "range": {
        "startLine": 21,
        "startChar": 1,
        "endLine": 21,
        "endChar": 15
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "05caec9f_0ada2669",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 21,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-11T02:51:53Z",
      "side": 1,
      "message": "+1. I suggest variable names like:\n\n mu sync.Mutex\n \n initTime time.Time   // timestamp when the OSMeter initialized\n initPageFaults int64 // page fault count when the OSMeter initialized\n \n lastTime time.Time   // timestamp when the last check was performed\n lastPageFaults int64 // page fault count when the last check was performed\n \n maxPageFaultRate float64 // maximum page faults per second",
      "parentUuid": "389589ef_321a8075",
      "range": {
        "startLine": 21,
        "startChar": 1,
        "endLine": 21,
        "endChar": 15
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "045cbde3_fbddeb51",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 21,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "05caec9f_0ada2669",
      "range": {
        "startLine": 21,
        "startChar": 1,
        "endLine": 21,
        "endChar": 15
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2bc9d214_19f8c103",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 29,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-01-11T02:07:34Z",
      "side": 1,
      "message": "nit: samplePeriod?",
      "range": {
        "startLine": 29,
        "startChar": 6,
        "endLine": 29,
        "endChar": 32
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "371d8ce4_d41d0c5e",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 29,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "2bc9d214_19f8c103",
      "range": {
        "startLine": 29,
        "startChar": 6,
        "endLine": 29,
        "endChar": 32
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0b986321_ec99695b",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 39,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-11T02:51:53Z",
      "side": 1,
      "message": "While OSMeter background goroutine will stop ctx is canceled, it is more common to have an explicit Close method to release resources (stopping the background goroutine in this case). One way to do this is:\n\n type OSMeter struct {\n   cancel func()\n   ...\n }\n\n func New(ctx context.Context) *OSMeter {\n   ctx, cancel :\u003d context.WithCancel(ctx)\n   osmeter :\u003d \u0026OSMeter {\n     cancel: cancel,\n   }\n   ...\n   return osmeter\n }\n\n func (om *OSMeter) Close() {\n   om.cancel()\n }",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b18e0ff1_7bf9408b",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 39,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "Sorry, I don\u0027t completely understand this, but now the goroutine is explicitly exited via request on a channel, so this probably no longer applies.",
      "parentUuid": "0b986321_ec99695b",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2e593bcd_a0d3403a",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 42,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-11T02:51:53Z",
      "side": 1,
      "message": "Please pass ctx here, and make it a function (instead of a method).",
      "range": {
        "startLine": 42,
        "startChar": 24,
        "endLine": 42,
        "endChar": 41
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f945651c_184e41c3",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 42,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-11T02:51:53Z",
      "side": 1,
      "message": "Typically receiver name are kept very short. In this case \"o\", \"m\", or \"om\" would be good.\n\nhttps://github.com/golang/go/wiki/CodeReviewComments#receiver-names",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4542b9d0_4bcc4a87",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 42,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "2e593bcd_a0d3403a",
      "range": {
        "startLine": 42,
        "startChar": 24,
        "endLine": 42,
        "endChar": 41
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5e4d1951_7d0088c0",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 42,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f945651c_184e41c3",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "30cdea75_78c4e8be",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 45,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-01-11T02:07:34Z",
      "side": 1,
      "message": "please make this method return (int64, error) instead of logging errors. this lets callers decide if they want to ignore errors, log them, abort, etc.",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e84e6b53_e4ea06fa",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 45,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-11T02:51:53Z",
      "side": 1,
      "message": "I think it\u0027s super unlikely reading /proc/vmstat fails, but in that case defaulting the value to 0.0 sounds difficult to debug.\n\nHow about panicking when any error occurrs in this function?",
      "parentUuid": "30cdea75_78c4e8be",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f225ba20_89a3b13a",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 45,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e84e6b53_e4ea06fa",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "46cdf1dc_a37069b7",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 49,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-01-11T02:07:34Z",
      "side": 1,
      "message": "nit: this can be simpler (and you should break out of the loop):\n\n  var value string\n  for _, line :\u003d range strings.Split(string(bytes), \"\\n\") {\n      if strings.HasPrefix(line, ...) {\n          value \u003d ...\n          break\n      }\n  }",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1d253b52_a8547ecf",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 49,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "46cdf1dc_a37069b7",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3ba1943b_ab9d8886",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 62,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-01-11T02:07:34Z",
      "side": 1,
      "message": "nit: please quote freeform strings in log messages and errors, and include errors when possible:\n\n  return 0.0, errors.Wrapf(err, \"can\u0027t parse pgmajfault value %q\", value)",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e5b17a7b_725a833d",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 62,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3ba1943b_ab9d8886",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7f929058_f99dae21",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 69,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-01-11T02:07:34Z",
      "side": 1,
      "message": "Reset?",
      "range": {
        "startLine": 69,
        "startChar": 24,
        "endLine": 69,
        "endChar": 43
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "eb5dd1ff_d6df7028",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 69,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-11T02:51:53Z",
      "side": 1,
      "message": "I suggest not supporting Reset. Reusing OSMeter is not really necessary for now, and less features means less bugs.",
      "range": {
        "startLine": 69,
        "startChar": 24,
        "endLine": 69,
        "endChar": 43
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "dc4109b0_ab8f34bb",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 69,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "eb5dd1ff_d6df7028",
      "range": {
        "startLine": 69,
        "startChar": 24,
        "endLine": 69,
        "endChar": 43
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f8d0d782_9ecf5a3b",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 69,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7f929058_f99dae21",
      "range": {
        "startLine": 69,
        "startChar": 24,
        "endLine": 69,
        "endChar": 43
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "88b1dda4_d27eec07",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 76,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-11T02:51:53Z",
      "side": 1,
      "message": "Please call Unlock with defer.\n\n om.mu.Lock()\n defer om.mu.Unlock()",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "84f03c47_1b621ff7",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 76,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "88b1dda4_d27eec07",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "32825203_36da9e37",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 82,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-01-11T02:07:34Z",
      "side": 1,
      "message": "can you just start the goroutine in New so that callers don\u0027t need to care about this implementation detail?",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "90d133bd_cec01001",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 82,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-11T02:51:53Z",
      "side": 1,
      "message": "Please pass ctx to this method.\n\nAlso, could you rename this method to run (or runBackground), and call it from the constructor? That\u0027s easier to use.\n\n func New(ctx context.Context) *OsMeter {\n \tosmeter :\u003d ...\n \tosmeter.Reset()\n \tgo osmeter.run(ctx)\n \treturn osmeter\n }",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b99e56fa_cd1d0489",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 82,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "OK---I could use just New() and PageFaultStats(), and run Start() in New() and Stop() in PageFaultStats().\n\nI wonder if it\u0027s just as well to leave it as is, to make it clearer to a reader that this runs in parallel.  But it\u0027s a small difference---whichever you prefer.",
      "parentUuid": "32825203_36da9e37",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d27ea5cf_81702d9d",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 82,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "90d133bd_cec01001",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c0a270f5_5ac44468",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 86,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-01-11T02:07:34Z",
      "side": 1,
      "message": "instead of checking a context here, how about having a Close() method that signals to the goroutine over a channel? you\u0027d probably want a doneCh field initialized with make(chan struct{}, 1), and then read from it in a case here and write a struct{}{} to it in Close()",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "42ef03b1_5fc9a75c",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 86,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-11T02:51:53Z",
      "side": 1,
      "message": "FYI, we can implement Close while still using ctx to signal exit; please see my comment above.",
      "parentUuid": "c0a270f5_5ac44468",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "867d16d6_06a8e6b9",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 86,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "Please check if my current solution is kosher.",
      "parentUuid": "42ef03b1_5fc9a75c",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4187c862_23df4b59",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 101,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-11T02:51:53Z",
      "side": 1,
      "message": "FYI, optional: This can\u0027t be called with defer since it\u0027s inside a loop. One typical way to make this safer is to create a separate function, e.g.\n\n func (om *OSMeter) run(ctx context.Context) {\n   for {\n     select { ... }\n     om.check()\n   }\n }\n\n func (om *OSMeter) check() {\n   om.mu.Lock()\n   defer om.mu.Unlock()\n   ...\n }\n\nBut the current code is okay, considering the content between Lock and Unlock is fairly short.",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ec892a6f_85366c14",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 101,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "No more locking/unlocking.",
      "parentUuid": "4187c862_23df4b59",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2917665e_0f779149",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 108,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-11T02:51:53Z",
      "side": 1,
      "message": "How about PageFaultStats? Go programs usually don\u0027t call Get* for getters.\n\nhttps://golang.org/doc/effective_go.html#Getters",
      "range": {
        "startLine": 108,
        "startChar": 24,
        "endLine": 108,
        "endChar": 46
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5d9e43ed_5dcf69d2",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 108,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "2917665e_0f779149",
      "range": {
        "startLine": 108,
        "startChar": 24,
        "endLine": 108,
        "endChar": 46
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8afd08cb_13d866dc",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 112,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-11T02:51:53Z",
      "side": 1,
      "message": "This is not a correct way to wait for the first check to happen considering race conditions...\n\nInstead, please signal the first run from the background goroutine. For example:\n\n type OSMeter struct {\n   ...\n   checked chan struct{} // closed when the first check finished\n }\n\n func (om *OSMeter) run() {\n   first :\u003d true\n   for {\n     ...\n     if first {\n       close(om.checked)\n       first \u003d false\n     }\n   }\n }\n\n func (om *OSMeter) PageFaultStats(...) ... {\n   \u003c-om.checked // wait until the first check happens\n   ...\n }",
      "range": {
        "startLine": 111,
        "startChar": 0,
        "endLine": 112,
        "endChar": 27
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8bad8224_19f85fd3",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 112,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "Oh I see.  Channels don\u0027t have those races.  Thanks.",
      "parentUuid": "8afd08cb_13d866dc",
      "range": {
        "startLine": 111,
        "startChar": 0,
        "endLine": 112,
        "endChar": 27
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0c5bc0df_48f39786",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 122,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-01-11T02:07:34Z",
      "side": 1,
      "message": "can you just call time.Duration\u0027s Seconds method here?",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "23097715_70ef69d5",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 122,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "Sorry, not sure what you mean here.  There is time.Since(), but I need the value of time.Now to reset startTime.",
      "parentUuid": "0c5bc0df_48f39786",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "79c447fd_0eb90fe0",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 124,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-11T02:51:53Z",
      "side": 1,
      "message": "It sounds a bit inconsistent to compute the latest count value here but use the max rate value saved in the struct.\n\nI would suggest using the struct value for count too:\n\n faultCount \u003d om.lastPageFaults - om.initPageFaults\n averageRate \u003d float64(faultCount) / om.lastTime.Sub(om.initTime).Seconds()\n maxRate \u003d om.maxPageFaultRate",
      "range": {
        "startLine": 123,
        "startChar": 1,
        "endLine": 124,
        "endChar": 59
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "54233cd2_c14ab062",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 124,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "You are right.  It doesn\u0027t matter in my use, but it is inconsistent.",
      "parentUuid": "79c447fd_0eb90fe0",
      "range": {
        "startLine": 123,
        "startChar": 1,
        "endLine": 124,
        "endChar": 59
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c8781de4_06c8f965",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 127,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-11T02:51:53Z",
      "side": 1,
      "message": "Please call it with \"defer\" just after Lock call. That\u0027s a better way unless the mutex is meant to be unlocked when the function returns.\n\n om.mu.Lock()\n defer om.mu.Unlock()",
      "range": {
        "startLine": 127,
        "startChar": 1,
        "endLine": 127,
        "endChar": 37
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b9de1aff_a9adaf79",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 127,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c8781de4_06c8f965",
      "range": {
        "startLine": 127,
        "startChar": 1,
        "endLine": 127,
        "endChar": 37
      },
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fd67a0b2_c7c5fe2e",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 128,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-01-11T02:07:34Z",
      "side": 1,
      "message": "please return values explicitly instead of using bare returns",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bce70187_c4bd6e53",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/osmeter/osmeter.go",
        "patchSetId": 33
      },
      "lineNbr": 128,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-01-12T01:12:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "fd67a0b2_c7c5fe2e",
      "revId": "43997526348ad3049c1c5af11b526aeb81179f89",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}