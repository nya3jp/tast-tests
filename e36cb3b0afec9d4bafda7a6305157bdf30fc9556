{
  "comments": [
    {
      "key": {
        "uuid": "26d3ba41_69f33ed9",
        "filename": "src/chromiumos/tast/local/arc/README_dumpsys.md",
        "patchSetId": 8
      },
      "lineNbr": 56,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-09-24T07:36:28Z",
      "side": 1,
      "message": "Usually protocol buffer messages should be designed so that messages can be understood without knowledge of their producer version. Hopefully we can fallback to old fields without relying on SDKVersion...",
      "range": {
        "startLine": 46,
        "startChar": 0,
        "endLine": 56,
        "endChar": 3
      },
      "revId": "e36cb3b0afec9d4bafda7a6305157bdf30fc9556",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c07c0dad_dbfed3c5",
        "filename": "src/chromiumos/tast/local/arc/README_dumpsys.md",
        "patchSetId": 8
      },
      "lineNbr": 56,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2019-09-24T16:41:06Z",
      "side": 1,
      "message": "This happened while parsing the windows attributes on Q. windows.visible_frame got deprecated on Q, and is returning nil.\nAlthough I think there is a way to return the app bounds in a compatible way (working on this).\n\nBut the spirit of the message is \"don\u0027t be surprised if message X, that works Ok on Q, doesn\u0027t return valid data on R\".",
      "parentUuid": "26d3ba41_69f33ed9",
      "range": {
        "startLine": 46,
        "startChar": 0,
        "endLine": 56,
        "endChar": 3
      },
      "revId": "e36cb3b0afec9d4bafda7a6305157bdf30fc9556",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d1f3ff8d_287b0456",
        "filename": "src/chromiumos/tast/local/arc/README_dumpsys.md",
        "patchSetId": 8
      },
      "lineNbr": 69,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-09-24T07:36:28Z",
      "side": 1,
      "message": "This is really unexpected in normal usage of protocol buffers; as long as we don\u0027t design protocol buffer messages critically wrongly (go/protodosdonts), messages generated by a newer producer should be parsable with an older consumer.\n\nHave you encountered this case in reality?",
      "range": {
        "startLine": 60,
        "startChar": 0,
        "endLine": 69,
        "endChar": 72
      },
      "revId": "e36cb3b0afec9d4bafda7a6305157bdf30fc9556",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "98be96e5_4393b1e4",
        "filename": "src/chromiumos/tast/local/arc/README_dumpsys.md",
        "patchSetId": 8
      },
      "lineNbr": 69,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2019-09-24T16:41:06Z",
      "side": 1,
      "message": "Yes, I found this case.\nI\u0027m testing Q these days, and when I run \"dumpsys\" on a Q device, and try to parse the output with P schema, it generates the above mentioned error.\n\n\"KeyguardControllerProto.KeyguardOccludedProto\" in Q has more fields than in P, and I guess that is what is causing the error.\n\nIf I try to decode it with \"protoc --decode\" it doesn\u0027t crash or anything like that. It just doesn\u0027t print the name of the message.\nOn Go, it generates an error... which I think is the expected behavior (?).\n\n\nLet me know how to proceed. Should I change the doc in any way? Thanks!",
      "parentUuid": "d1f3ff8d_287b0456",
      "range": {
        "startLine": 60,
        "startChar": 0,
        "endLine": 69,
        "endChar": 72
      },
      "revId": "e36cb3b0afec9d4bafda7a6305157bdf30fc9556",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1045ae19_16069407",
        "filename": "src/chromiumos/tast/local/arc/README_dumpsys.md",
        "patchSetId": 8
      },
      "lineNbr": 69,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2019-09-24T16:55:00Z",
      "side": 1,
      "message": "Mmmm... I dig further and you are right. It should never fail.\nAndroid Q introduced a incompatible change, they changed the type of field :(.\nAnd that\u0027s why it is failing.\n\non P:\nmessage KeyguardControllerProto {\n    option (.android.msg_privacy).dest \u003d DEST_AUTOMATIC;\n\n    optional bool keyguard_showing \u003d 1;\n    optional bool keyguard_occluded \u003d 2;   // \u003c---- LOOK AT THIS ONE\n}\n\n\n\non Q:\n\nmessage KeyguardControllerProto {\n    option (.android.msg_privacy).dest \u003d DEST_AUTOMATIC;\n\n    optional bool keyguard_showing \u003d 1;\n    repeated KeyguardOccludedProto keyguard_occluded_states\u003d 2; // \u003c---- LOOK AT THIS ONE\n    optional bool aod_showing \u003d 3;\n}\n\nmessage KeyguardOccludedProto {\n    option (.android.msg_privacy).dest \u003d DEST_AUTOMATIC;\n\n    optional int32 display_id \u003d 1;\n    optional bool keyguard_occluded \u003d 2;\n}",
      "parentUuid": "98be96e5_4393b1e4",
      "range": {
        "startLine": 60,
        "startChar": 0,
        "endLine": 69,
        "endChar": 72
      },
      "revId": "e36cb3b0afec9d4bafda7a6305157bdf30fc9556",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}