{
  "comments": [
    {
      "key": {
        "uuid": "7f18f99e_f6798c1d",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/multi_networking_connectivity.go",
        "patchSetId": 5
      },
      "lineNbr": 96,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-05-22T22:38:46Z",
      "side": 1,
      "message": "nit: Android",
      "range": {
        "startLine": 96,
        "startChar": 25,
        "endLine": 96,
        "endChar": 32
      },
      "revId": "5ecf928a635863cabb98765d0bf75f82b1fd0df6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "84e53158_98a5c26d",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/multi_networking_connectivity.go",
        "patchSetId": 5
      },
      "lineNbr": 96,
      "author": {
        "id": 1346383
      },
      "writtenOn": "2019-05-27T04:03:00Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7f18f99e_f6798c1d",
      "range": {
        "startLine": 96,
        "startChar": 25,
        "endLine": 96,
        "endChar": 32
      },
      "revId": "5ecf928a635863cabb98765d0bf75f82b1fd0df6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5cefcc70_46a14730",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/multi_networking_connectivity.go",
        "patchSetId": 5
      },
      "lineNbr": 129,
      "author": {
        "id": 1307765
      },
      "writtenOn": "2019-05-26T23:49:54Z",
      "side": 1,
      "message": "Maybe use an errgroup instead?",
      "range": {
        "startLine": 129,
        "startChar": 12,
        "endLine": 129,
        "endChar": 21
      },
      "revId": "5ecf928a635863cabb98765d0bf75f82b1fd0df6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9c2a543a_9c444700",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/multi_networking_connectivity.go",
        "patchSetId": 5
      },
      "lineNbr": 129,
      "author": {
        "id": 1346383
      },
      "writtenOn": "2019-05-27T04:03:00Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5cefcc70_46a14730",
      "range": {
        "startLine": 129,
        "startChar": 12,
        "endLine": 129,
        "endChar": 21
      },
      "revId": "5ecf928a635863cabb98765d0bf75f82b1fd0df6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b1c1a482_3ffd778b",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/multi_networking_connectivity.go",
        "patchSetId": 5
      },
      "lineNbr": 136,
      "author": {
        "id": 1307765
      },
      "writtenOn": "2019-05-26T23:49:54Z",
      "side": 1,
      "message": "do you need a new context for each routine or can you use one for all ?",
      "range": {
        "startLine": 136,
        "startChar": 3,
        "endLine": 136,
        "endChar": 11
      },
      "revId": "5ecf928a635863cabb98765d0bf75f82b1fd0df6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "291d52a8_2b6adfe0",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/multi_networking_connectivity.go",
        "patchSetId": 5
      },
      "lineNbr": 136,
      "author": {
        "id": 1346383
      },
      "writtenOn": "2019-05-27T04:03:00Z",
      "side": 1,
      "message": "Changed it to only uses one.",
      "parentUuid": "b1c1a482_3ffd778b",
      "range": {
        "startLine": 136,
        "startChar": 3,
        "endLine": 136,
        "endChar": 11
      },
      "revId": "5ecf928a635863cabb98765d0bf75f82b1fd0df6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ab174fe9_99d33d87",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/multi_networking_connectivity.go",
        "patchSetId": 5
      },
      "lineNbr": 179,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-05-22T22:38:46Z",
      "side": 1,
      "message": "i think that this could result in your test hanging instead of respecting its timeout. if i\u0027m reading correctly, this runs in a goroutine (launched on L135), and the main goroutine blocks until all of these goroutines exit (L145). the sc.Scan call on this line won\u0027t honor the context\u0027s deadline, so the goroutine can block indefinitely if tcpdump is hanging.\n\ni think that you can avoid this by reworking it to be more like the approach used in http://go/tast-codelab-2. if you scan in a separate goroutine and then pass back the result in a channel, then you can select between that channel and the context, and then kill the tcpdump process (which should also interrupt the scan) if the deadline is reached.",
      "revId": "5ecf928a635863cabb98765d0bf75f82b1fd0df6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ab993bd1_d9937e55",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/multi_networking_connectivity.go",
        "patchSetId": 5
      },
      "lineNbr": 179,
      "author": {
        "id": 1307765
      },
      "writtenOn": "2019-05-26T23:49:54Z",
      "side": 1,
      "message": "I think if you just put the ping \u0026 tcpdump chunk of this into it\u0027s own go routine and block on the ctx then you should be fine. So in the normal case, you find your string and exit, that kills the context and releases the go routine; or the ctx times out and the go routine exits, which releases the Scan call.\n\nDan if you really prefer to have the code match the codelab that\u0027s fine. It just didn\u0027t seem entirely necessary for this.",
      "parentUuid": "ab174fe9_99d33d87",
      "revId": "5ecf928a635863cabb98765d0bf75f82b1fd0df6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8b7325d1_5501cf36",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/multi_networking_connectivity.go",
        "patchSetId": 5
      },
      "lineNbr": 179,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-05-27T02:20:04Z",
      "side": 1,
      "message": "it\u0027s possible that this will work already, if the context\u0027s deadline will be honored by killing the ping and tcpdump commands even if the goroutine that started the processes is blocked. i\u0027ll defer to nya@ for the rest of this review since i think he\u0027s more familiar with that code.",
      "parentUuid": "ab993bd1_d9937e55",
      "revId": "5ecf928a635863cabb98765d0bf75f82b1fd0df6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "95460cb1_e794b0a3",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/multi_networking_connectivity.go",
        "patchSetId": 5
      },
      "lineNbr": 179,
      "author": {
        "id": 1346383
      },
      "writtenOn": "2019-05-27T04:03:00Z",
      "side": 1,
      "message": "Added a goroutine that block and kill the tcpdump process. I put it in the same function. I think separating the function might add complexity of returning cmd or stdout, etc.\n\nThanks for the detailed review for this one. Definitely learned some stuffs about go.",
      "parentUuid": "8b7325d1_5501cf36",
      "revId": "5ecf928a635863cabb98765d0bf75f82b1fd0df6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}