{
  "comments": [
    {
      "key": {
        "uuid": "e948ce36_a2603adb",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/crash/crash.go",
        "patchSetId": 5
      },
      "lineNbr": 83,
      "author": {
        "id": 1117055
      },
      "writtenOn": "2019-07-24T18:55:25Z",
      "side": 1,
      "message": "I prefer filing bugs for this and putting them here instead of just naming someone so this isn\u0027t forgotten.",
      "range": {
        "startLine": 83,
        "startChar": 10,
        "endLine": 83,
        "endChar": 19
      },
      "revId": "ada8ca0e408e5bc4071674ea956e2131f9c150b5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1a7031a6_f7690362",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/crash/crash.go",
        "patchSetId": 5
      },
      "lineNbr": 117,
      "author": {
        "id": 1117055
      },
      "writtenOn": "2019-07-24T18:55:25Z",
      "side": 1,
      "message": "I don\u0027t think you need to do this. fsutil.MoveFile already stats the source file and returns an error if that fails.",
      "range": {
        "startLine": 112,
        "startChar": 0,
        "endLine": 117,
        "endChar": 2
      },
      "revId": "ada8ca0e408e5bc4071674ea956e2131f9c150b5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f550174b_a0993000",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/crash/crash.go",
        "patchSetId": 5
      },
      "lineNbr": 132,
      "author": {
        "id": 1117055
      },
      "writtenOn": "2019-07-24T18:55:25Z",
      "side": 1,
      "message": "this can probably be simplified since fsutil.MoveFile already checks that the source is a regular file",
      "range": {
        "startLine": 125,
        "startChar": 0,
        "endLine": 132,
        "endChar": 2
      },
      "revId": "ada8ca0e408e5bc4071674ea956e2131f9c150b5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b368ae8a_6f63b9f5",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/crash/crash.go",
        "patchSetId": 5
      },
      "lineNbr": 140,
      "author": {
        "id": 1300299
      },
      "writtenOn": "2019-07-24T22:17:54Z",
      "side": 1,
      "message": "Have you considered just running /usr/bin/metrics_client -C ? It sets up consent correctly, and \nexec.Command(\"/usr/bin/metrics_client\", \"-C\").Run()\nis much shorter.\n\nI\u0027ve been having much better luck with this; no corrupted owner.key warnings",
      "range": {
        "startLine": 140,
        "startChar": 0,
        "endLine": 140,
        "endChar": 106
      },
      "revId": "ada8ca0e408e5bc4071674ea956e2131f9c150b5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2b72e459_0b21ec73",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/crash/crash.go",
        "patchSetId": 5
      },
      "lineNbr": 140,
      "author": {
        "id": 1166720
      },
      "writtenOn": "2019-07-25T06:04:54Z",
      "side": 1,
      "message": "Thanks, that sounds a much better solution.\nHowever I could only see that the command only manipulates the consent file.\nNow I am investigating why the existing autotest test case modifies the policy file and key file, in addition to the consent file. Do you know about this?",
      "parentUuid": "b368ae8a_6f63b9f5",
      "range": {
        "startLine": 140,
        "startChar": 0,
        "endLine": 140,
        "endChar": 106
      },
      "revId": "ada8ca0e408e5bc4071674ea956e2131f9c150b5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b7c0548b_5a5e7c15",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/crash/crash.go",
        "patchSetId": 5
      },
      "lineNbr": 140,
      "author": {
        "id": 1166720
      },
      "writtenOn": "2019-07-25T07:41:19Z",
      "side": 1,
      "message": "\u003e why the existing autotest test case modifies the policy file \n\nplatform2/metrics/README.md says “Consent file exists or enabled by policy”, but actually src/platform2/metrics/metrics_library.cc does:\n1. use policy setting if exists\n2. (for enterprise, some special handling)\n3. enable if the consent file is valid\n\nSince the policy setting takes precedence over consent file, we need to manipulate the policy files.",
      "parentUuid": "2b72e459_0b21ec73",
      "range": {
        "startLine": 140,
        "startChar": 0,
        "endLine": 140,
        "endChar": 106
      },
      "revId": "ada8ca0e408e5bc4071674ea956e2131f9c150b5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c0f644a0_9cbc01bc",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/crash/crash.go",
        "patchSetId": 5
      },
      "lineNbr": 151,
      "author": {
        "id": 1117055
      },
      "writtenOn": "2019-07-24T18:55:25Z",
      "side": 1,
      "message": "Maybe instead of doing this, and to fix the issue you made a TODO about on L83, we should do each pushFile/popFile separately here instead of packing them all into one function. Then we could\n\n if err :\u003d pushFile(signedPolicyFile, pushedPolicyFile); err !\u003d nil {\n   s.Fatal(\"Failed to push consent: \", err)\n }\n defer popFile(signedPolicyFile, pushedPolicyFile) // or the wrapper that Fatals on error, etc.\n\nfor each of the three sets of files and it won\u0027t matter if we only partially initialize since we\u0027ll always clean up what we changed.",
      "range": {
        "startLine": 147,
        "startChar": 0,
        "endLine": 151,
        "endChar": 4
      },
      "revId": "ada8ca0e408e5bc4071674ea956e2131f9c150b5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}