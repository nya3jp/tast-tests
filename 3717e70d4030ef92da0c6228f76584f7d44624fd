{
  "comments": [
    {
      "key": {
        "uuid": "3531b499_1f797c81",
        "filename": "/COMMIT_MSG",
        "patchSetId": 4
      },
      "lineNbr": 11,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2020-09-02T16:46:56Z",
      "side": 1,
      "message": "I don\u0027t think that CL is removing the screenshots when the test finished. That CL is from July 2019 and, at least last week, I was able to see the screenshots. e.g:\n\nhttps://stainless.corp.google.com/browse/chromeos-autotest-results/swarming-4e567fdfecb1f010/autoserv_test/tast/results/tests/arc.WindowManagerCUJ.unstable/\n\n\nWhat screenshots are missing? Perhaps there was an infra issue?",
      "range": {
        "startLine": 10,
        "startChar": 40,
        "endLine": 11,
        "endChar": 69
      },
      "revId": "3717e70d4030ef92da0c6228f76584f7d44624fd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9b73f492_3b7b590c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1284845
      },
      "writtenOn": "2020-09-01T19:52:18Z",
      "side": 1,
      "message": "PTAL.",
      "revId": "3717e70d4030ef92da0c6228f76584f7d44624fd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1f300521_e9849f63",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1298257
      },
      "writtenOn": "2020-09-02T03:25:44Z",
      "side": 1,
      "message": "Looks good from wm\u0027s perspective.",
      "revId": "3717e70d4030ef92da0c6228f76584f7d44624fd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "004c72f2_bac3222a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1284845
      },
      "writtenOn": "2020-09-02T17:17:20Z",
      "side": 1,
      "message": "If you check carefully, there are \"chromiumos/tast/local/bundles/cros/arc/screenshot\" and \"chromiumos/tast/local/screenshot\". CUJ is using the second one that didn\u0027t remove the screenshot, while others are using the first one which remove the screenshot.",
      "revId": "3717e70d4030ef92da0c6228f76584f7d44624fd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "eda33ee5_e16c97dc",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2020-09-02T18:38:01Z",
      "side": 1,
      "message": "ah, good point. Now I understand the problem.\n\nThere are possible 3 scenarios:\n\na) Test passes/fails -\u003e never screenshots  (as it is today).\n\nRegardless whether the test passes or fails, no screenshots are being saved.\n\nDownside: no screenshots are being saved when the test fails.\n\n\nb) Test passes/fails -\u003e always screenshot (this CL)\n\nRegardless whether the test passes or fails, screenshots are always saved (assuming \u0027path\u0027 is passed as argument).\n\nDownside: screenshot is being saved, even if the test passes. Adds disk space, and \"noise\" since the screenshot is not needed when the test passes.\n\n\nc) Test passes -\u003e no screenshot; fails -\u003e screenshot (ideal scenario)\n\nIf the test fails, then the screenshot is saved.\nIf the test passes, no screenshot is saved.\n\nNo possible solution is to add a new function to screenshot/screenshot that dumps an image.Image into png.\n\ne.g:\n\n  func DumpImageToPNG(ctx context.Context, path string) error {\n    ...\n  }\n\nand call this function when you detect an error.",
      "parentUuid": "004c72f2_bac3222a",
      "revId": "3717e70d4030ef92da0c6228f76584f7d44624fd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "81d931c6_932b1194",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1284845
      },
      "writtenOn": "2020-09-02T19:31:35Z",
      "side": 1,
      "message": "I\u0027m not clear what you wanna me do here. I\u0027m in #2 now. I\u0027m not sure who to implement #3 systematically, or manually add DumpImageToPNG for each possible fail step?",
      "parentUuid": "eda33ee5_e16c97dc",
      "revId": "3717e70d4030ef92da0c6228f76584f7d44624fd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cd60ba67_f23b13a1",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2020-09-02T19:55:12Z",
      "side": 1,
      "message": "I already mentioned some the issues with #2... one possible solution is to implement #3... or you have better ideas, let me know.\n\nShould you call DumpImageToPNG in any possible fail step? I guess it depends on the test.\nAs an example, I looked at the resize_activity.go and it has one place (where it is already saving Image to PNG).\nquarter_size has 2 places...\n\n(see my comments on resize_activity.go)",
      "parentUuid": "81d931c6_932b1194",
      "revId": "3717e70d4030ef92da0c6228f76584f7d44624fd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0c72ef16_2b6d7eaa",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/resize_activity.go",
        "patchSetId": 4
      },
      "lineNbr": 193,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2020-09-02T19:55:12Z",
      "side": 1,
      "message": "this shouldn\u0027t be needed... besides it is saving the screenshot twice: once in the newly modified screenshot.GrabScreenshot() and a few lines below where it saves the image to PNG.",
      "range": {
        "startLine": 193,
        "startChar": 0,
        "endLine": 193,
        "endChar": 62
      },
      "revId": "3717e70d4030ef92da0c6228f76584f7d44624fd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a859113a_1986cb7a",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/resize_activity.go",
        "patchSetId": 4
      },
      "lineNbr": 224,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2020-09-02T19:55:12Z",
      "side": 1,
      "message": "replace this with a call to DumpImageToPNG()",
      "range": {
        "startLine": 218,
        "startChar": 0,
        "endLine": 224,
        "endChar": 27
      },
      "revId": "3717e70d4030ef92da0c6228f76584f7d44624fd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}