{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "68c530d6_e143f26e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-16T07:20:54Z",
      "side": 1,
      "message": "I think the polling for BT is not very good as we still can\u0027t distinguish disabled or not yet initialized. But good enough as a quick mitigation for this test, I guess. PTAL.",
      "revId": "d9f6418f2e85ff930530de16f204547a37e2f070",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bfa719d0_e77262b8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1432127
      },
      "writtenOn": "2020-10-16T18:35:32Z",
      "side": 1,
      "message": "I think the test should fail regardless whether bluetooth is disabled or is not initialized in time. I think the distinction only matters if we want to recover bluetooth if it\u0027s disabled after reboot; and I don\u0027t think that\u0027s what we want/need to do especially since we want to assert that bluetooth is up on reboot. I think a simple poll is good enough to catch the not initialized condition, and the disabled condition should always fail. I\u0027ll add @abhishekpandit to make sure this isn\u0027t an issue.",
      "parentUuid": "68c530d6_e143f26e",
      "revId": "d9f6418f2e85ff930530de16f204547a37e2f070",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5c5592de_7eec156f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1365249
      },
      "writtenOn": "2020-10-20T02:36:02Z",
      "side": 1,
      "message": "Looking at the way `GetBluetoothPowered` is implemented, you should only get an error if bluez isn\u0027t started. In case an adapter doesn\u0027t exist or it\u0027s powered down, you should get False.\n\nSo this LGTM.",
      "parentUuid": "bfa719d0_e77262b8",
      "revId": "d9f6418f2e85ff930530de16f204547a37e2f070",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4355f197_51691250",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/persistence_bluetooth_sans_wifi.go",
        "patchSetId": 2
      },
      "lineNbr": 133,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-16T07:20:54Z",
      "side": 1,
      "message": "I don\u0027t break poll or fatal here because I guess, although very unlikely, it is also possible that bluez is not yet ready on dbus at this point.",
      "revId": "d9f6418f2e85ff930530de16f204547a37e2f070",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ec409575_52270e64",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/persistence_bluetooth_sans_wifi.go",
        "patchSetId": 2
      },
      "lineNbr": 133,
      "author": {
        "id": 1432127
      },
      "writtenOn": "2020-10-16T18:35:32Z",
      "side": 1,
      "message": "Sounds good to me.",
      "parentUuid": "4355f197_51691250",
      "revId": "d9f6418f2e85ff930530de16f204547a37e2f070",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "259c04a5_d0c4de03",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/persistence_bluetooth_sans_wifi.go",
        "patchSetId": 2
      },
      "lineNbr": 142,
      "author": {
        "id": 1432127
      },
      "writtenOn": "2020-10-16T18:35:32Z",
      "side": 1,
      "message": "nit: Would it be better to move the polling into the GetBluetoothPowered function itself similar to how GetWifiEnabled implicitly polls with the WaitAll() call within the subroutine.",
      "range": {
        "startLine": 131,
        "startChar": 0,
        "endLine": 142,
        "endChar": 55
      },
      "revId": "d9f6418f2e85ff930530de16f204547a37e2f070",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ae808ba4_6c62232f",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/persistence_bluetooth_sans_wifi.go",
        "patchSetId": 2
      },
      "lineNbr": 142,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-19T08:56:22Z",
      "side": 1,
      "message": "I think this way the gRPC can only be used for BT enabled case because if it\u0027s disabled, the gRPC will poll until timeout. (And the behavior is more like WaitBTPowered) OTOH, the WiFi case is a little different, it is a tri-state case: not available, disabled, or enabled. When getting \"if enabled\" setting, it makes sense to wait until \"available\" as otherwise, the setting is still unknown.\n\nHowever, moving the polling into gRPC will make future changes easier, so I\u0027m also not sure which is better. Or, should I just rename it to WaitBTPowered...?",
      "parentUuid": "259c04a5_d0c4de03",
      "range": {
        "startLine": 131,
        "startChar": 0,
        "endLine": 142,
        "endChar": 55
      },
      "revId": "d9f6418f2e85ff930530de16f204547a37e2f070",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "410b8a59_6b1e17a8",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/persistence_bluetooth_sans_wifi.go",
        "patchSetId": 2
      },
      "lineNbr": 142,
      "author": {
        "id": 1432127
      },
      "writtenOn": "2020-10-19T09:04:07Z",
      "side": 1,
      "message": "Yeah, I don\u0027t think the network cost of polling through gRPC is too great and the current implementation works just fine.\n\nI don\u0027t think we will expect too many more bluetooth tests in Tast in the near future. The Bluetooth team hasn\u0027t migrated to Tast (yet?), so I think we can just keep the change as is.",
      "parentUuid": "ae808ba4_6c62232f",
      "range": {
        "startLine": 131,
        "startChar": 0,
        "endLine": 142,
        "endChar": 55
      },
      "revId": "d9f6418f2e85ff930530de16f204547a37e2f070",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5a9989b7_2fb18bbb",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/persistence_bluetooth_sans_wifi.go",
        "patchSetId": 2
      },
      "lineNbr": 142,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-10-19T09:10:42Z",
      "side": 1,
      "message": "Thanks for the quick reply. :) I\u0027ll keep this as is. ACK.",
      "parentUuid": "410b8a59_6b1e17a8",
      "range": {
        "startLine": 131,
        "startChar": 0,
        "endLine": 142,
        "endChar": 55
      },
      "revId": "d9f6418f2e85ff930530de16f204547a37e2f070",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}