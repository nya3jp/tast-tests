{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "7f56db3a_42e3b450",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1454332
      },
      "writtenOn": "2021-01-20T14:20:01Z",
      "side": 1,
      "message": "I think remaining battery capacity + energy before the test starts would always be helpful. (We could have a potential problem when the battery is worn out and stops giving sufficient voltage even when it\u0027s above the `power.LowBatteryShutdownPercent()`.)\n\nAdded logic to fail the tests by looking at the `lowBatteryMargin`, since it\u0027s already provided for all the tests. If you\u0027re ok with this I guess it\u0027d be best to rename it to `expectedMaxCapacityDischarge`.\n\nI tested the battery drain on my nami DUT and it discharged less than 1% when running test for 5 minutes with 100% CPU use. Default `lowBatteryMargin` value is 2%.",
      "revId": "84a69683d1144d6f8e6ba92989f9a2faec33ed47",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "77f02d24_a577705c",
        "filename": "src/chromiumos/tast/local/power/setup/setup_battery.go",
        "patchSetId": 1
      },
      "lineNbr": 84,
      "author": {
        "id": 1412469
      },
      "writtenOn": "2021-01-22T04:59:34Z",
      "side": 1,
      "message": "This logic may make many tests failing since we don\u0027t know the default lowBatteryMargin is sufficient for all the tests.\nHow about introducing this in a later CL after we ensured that the margin is sufficient?",
      "revId": "84a69683d1144d6f8e6ba92989f9a2faec33ed47",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a1ef0a19_32a20fce",
        "filename": "src/chromiumos/tast/local/power/sysfs_battery_metrics.go",
        "patchSetId": 1
      },
      "lineNbr": 105,
      "author": {
        "id": 1412469
      },
      "writtenOn": "2021-01-22T04:59:34Z",
      "side": 1,
      "message": "Let\u0027s implement the same logic here (Use voltage_now if reading voltage_min_design failed).",
      "revId": "84a69683d1144d6f8e6ba92989f9a2faec33ed47",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "62c47a86_0e69e133",
        "filename": "src/chromiumos/tast/local/power/sysfs_battery_metrics.go",
        "patchSetId": 1
      },
      "lineNbr": 223,
      "author": {
        "id": 1412469
      },
      "writtenOn": "2021-01-22T04:59:34Z",
      "side": 1,
      "message": "How about adding a metric like `battery_usage` here instead of logging? (It can make easier to collect the battery usage using SQL)\nYou can use `values.Set(metric, values)` to set the value in Snapshot()\nhttps://source.corp.google.com/chromeos_public/src/platform/tast-tests/src/chromiumos/tast/common/perf/perf.go;l\u003d172\nand capture the initial capacity in Start().",
      "revId": "84a69683d1144d6f8e6ba92989f9a2faec33ed47",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}