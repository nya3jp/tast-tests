{
  "comments": [
    {
      "key": {
        "uuid": "8da8b35e_1df52046",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1294890
      },
      "writtenOn": "2020-09-26T09:48:12Z",
      "side": 1,
      "message": "LGTM. Thanks for the change.\nWe still need a tast-owner to look at the change.",
      "revId": "210eaf5a7533bc0e90609585a27863bfdff86a3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "60b4e006_1f202806",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1386944
      },
      "writtenOn": "2020-09-28T07:17:30Z",
      "side": 1,
      "message": "Tast Shadow Review: LGTM % nit",
      "revId": "210eaf5a7533bc0e90609585a27863bfdff86a3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2b575026_79dd9ce7",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/bootperf/metrics_util.go",
        "patchSetId": 2
      },
      "lineNbr": 102,
      "author": {
        "id": 1000107
      },
      "writtenOn": "2020-09-25T21:58:48Z",
      "side": 1,
      "message": "In theory, you could add a new field and do:\n\n  if !k.Required and (!k.Recommended or (time.time() - start_time \u003e 60)):\n\n...or something like that?\n\nThen\n* If every boot takes up to 60 seconds you\u0027ll still catch.\n* If network fails to be found on every boot, you won\u0027t record but won\u0027t fail the test.  Hopefully someone else will notice.\n* If network comes up in \u003e 60 seconds, one would hope that people would notice and yell loudly?",
      "revId": "210eaf5a7533bc0e90609585a27863bfdff86a3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "60c5b735_252fc26a",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/bootperf/metrics_util.go",
        "patchSetId": 2
      },
      "lineNbr": 102,
      "author": {
        "id": 1294890
      },
      "writtenOn": "2020-09-26T09:48:12Z",
      "side": 1,
      "message": "This sounds a good idea to implement. We can do it in another change. We just need to be careful not to regress the test execution time.\n\nOne question: are we sure that wifi will always get registered on each devices (I suppose the answer is no to cellular)?\n\nIf we have a device without wifi then the device will always take 60 sec to finish the boot test, and this largely increase the chance that the test runs out of its timeout budget of 15 sec. We don\u0027t want the test to run that slow and even to become flaky in running out of time.\n\nIf we want to use a shorter timeout for recommended events, what would be a good value? Is 30 sec enough for wifi or cellular to get registered? Note that one polling condition is bootchart, which stops collection in ~30 sec after boot. A good run generally takes 7 mins to finish. We don\u0027t want to increase that number too much.",
      "parentUuid": "2b575026_79dd9ce7",
      "revId": "210eaf5a7533bc0e90609585a27863bfdff86a3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4757a4a2_14077efc",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/bootperf/metrics_util.go",
        "patchSetId": 2
      },
      "lineNbr": 102,
      "author": {
        "id": 1132414
      },
      "writtenOn": "2020-09-29T01:45:37Z",
      "side": 1,
      "message": "\u003e This sounds a good idea to implement. We can do it in another change. We just need to be careful not to regress the test execution time.\n\u003e \n\u003e One question: are we sure that wifi will always get registered on each devices (I suppose the answer is no to cellular)?\n\nCellular: no, not all devices have it.\nWiFi: ~99%. There are occasional weirdo boxes out there that sometimes accidentally get tests run on them (e.g., I never know what the current status of Moblab is), or VMs (Betty, etc.), but there should not be a single proper Chrome OS system out there with no WiFi.\n\nNow, existing tests will show that there is a baseline of hardware (or software?) issues in the lab that mean the device is not registered reliably, even on systems where they should be reliable:\nhttps://tastboard.corp.google.com/test/network.WLANDriver\n(Most (but not all) of the current errors are experimental boards with known issues.)\nThe current exclusions for that test (see \"Deps\") are only for VMs, moblab, and Kitty [which is known to be flaky]\n\n\u003e If we have a device without wifi then the device will always take 60 sec to finish the boot test, and this largely increase the chance that the test runs out of its timeout budget of 15 sec. We don\u0027t want the test to run that slow and even to become flaky in running out of time.\n\ns/15 sec/ 15 minutes/\n?\n\nOtherwise, I was really confused reading that sentence!\n\n\u003e \n\u003e If we want to use a shorter timeout for recommended events, what would be a good value? Is 30 sec enough for wifi or cellular to get registered? Note that one polling condition is bootchart, which stops collection in ~30 sec after boot. A good run generally takes 7 mins to finish. We don\u0027t want to increase that number too much.\n\n30 seconds is plenty for any expected case for WiFi.\nUnexpected cases can include regressions, or hardware failures (per the above).\n\nSo should I change anything here? It seems like the existing implied minimum of 30 seconds should be OK. But I don\u0027t know if I should force this test to fail (\"Recommended\"), per the above reliability questions.",
      "parentUuid": "60c5b735_252fc26a",
      "revId": "210eaf5a7533bc0e90609585a27863bfdff86a3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "760a3e90_779c6dbc",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/bootperf/metrics_util.go",
        "patchSetId": 2
      },
      "lineNbr": 102,
      "author": {
        "id": 1294890
      },
      "writtenOn": "2020-09-29T11:37:59Z",
      "side": 1,
      "message": "\u003e \n\u003e s/15 sec/ 15 minutes/\n\u003e ?\n\u003e \n\u003e Otherwise, I was really confused reading that sentence!\n\u003e \nYes, I mean 15 minutes.\n\u003e \u003e \n\u003e \u003e If we want to use a shorter timeout for recommended events, what would be a good value? Is 30 sec enough for wifi or cellular to get registered? Note that one polling condition is bootchart, which stops collection in ~30 sec after boot. A good run generally takes 7 mins to finish. We don\u0027t want to increase that number too much.\n\u003e \n\u003e 30 seconds is plenty for any expected case for WiFi.\n\u003e Unexpected cases can include regressions, or hardware failures (per the above).\n\u003e \n\u003e So should I change anything here? It seems like the existing implied minimum of 30 seconds should be OK. But I don\u0027t know if I should force this test to fail (\"Recommended\"), per the above reliability questions.\n\nI think this change is good as-is. The improvement should be done in a separate change.\n\nOr if we can detect whether there will be a wifi device, we can make it a required metric so we can fail the test if the test times out waiting for the metric.",
      "parentUuid": "4757a4a2_14077efc",
      "revId": "210eaf5a7533bc0e90609585a27863bfdff86a3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ea002cc7_6b19124d",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/bootperf/metrics_util.go",
        "patchSetId": 2
      },
      "lineNbr": 102,
      "author": {
        "id": 1132414
      },
      "writtenOn": "2020-09-29T18:10:56Z",
      "side": 1,
      "message": "\u003e I think this change is good as-is. The improvement should be done in a separate change.\n\nAck.\n\n\u003e Or if we can detect whether there will be a wifi device, we can make it a required metric so we can fail the test if the test times out waiting for the metric.\n\nI guess I was asking: is the additional susceptibility to lab hardware failures (and possibly rare SW failures that we haven\u0027t been able to track down) acceptable to make this \"required\"? Even if we\u0027re entirely precise about which systems *should* have WiFi, that doesn\u0027t mean the HW and SW will actually work reliably. Some of our past problems have literally been as dumb as \"there\u0027s tape stuck in the PCI connector\":\nhttps://b.corp.google.com/issues/117898293#comment6\n\nProblems as obvious as that are easy enough to deal with, but I just wanted to inform about the class of problems this invites. Ideally, we could have independent tests for the hardware-dependent and non-hardware-dependent pieces of this test, but given the ~7 minute timeline, I can understand why we won\u0027t.\n\nAnyway, that\u0027s a problem for a future code review.",
      "parentUuid": "760a3e90_779c6dbc",
      "revId": "210eaf5a7533bc0e90609585a27863bfdff86a3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "77bc92f7_00205dc6",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/bootperf/metrics_util.go",
        "patchSetId": 2
      },
      "lineNbr": 215,
      "author": {
        "id": 1386944
      },
      "writtenOn": "2020-09-28T07:17:30Z",
      "side": 1,
      "message": "nit: This last sentence does not seem to be communicating much, now that previous sentence has been updated to \"The following metrics _may_ be recorded:\". \n\nIf the intent is to communicate which metrics are mandatory, maybe add \"(items marked with a ^ are considered mandatory)\" and mark the mandatory items with a \"^\" (or other notation).",
      "range": {
        "startLine": 215,
        "startChar": 3,
        "endLine": 215,
        "endChar": 34
      },
      "revId": "210eaf5a7533bc0e90609585a27863bfdff86a3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "526710d1_12a56ccc",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/bootperf/metrics_util.go",
        "patchSetId": 2
      },
      "lineNbr": 215,
      "author": {
        "id": 1132414
      },
      "writtenOn": "2020-09-29T01:45:37Z",
      "side": 1,
      "message": "I was tempted to delete the entire listing, since there\u0027s a definitive listing a few dozen lines up...\n...but sure, I\u0027ll just delete this sentence.",
      "parentUuid": "77bc92f7_00205dc6",
      "range": {
        "startLine": 215,
        "startChar": 3,
        "endLine": 215,
        "endChar": 34
      },
      "revId": "210eaf5a7533bc0e90609585a27863bfdff86a3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}