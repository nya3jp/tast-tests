{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "d9d2d539_2ebf421c",
        "filename": "/COMMIT_MSG",
        "patchSetId": 9
      },
      "lineNbr": 15,
      "author": {
        "id": 1243287
      },
      "writtenOn": "2020-11-03T23:02:56Z",
      "side": 1,
      "message": "Thanks for doing this! Do you mind explaining why configuring the network this way allows the ping to go through (for me and for posterity)? In particular, what part of the autotest network setup was preventing it?",
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0378c810_f018d8c4",
        "filename": "/COMMIT_MSG",
        "patchSetId": 9
      },
      "lineNbr": 15,
      "author": {
        "id": 1387481
      },
      "writtenOn": "2020-11-05T10:25:53Z",
      "side": 1,
      "message": "I\u0027m not sure which one is the root cause (or maybe both?):\n\n1. In Autotest, router starts two dhcp server with *different* subnet. Since they (including the DUT) are L2 connected, the DUT is able to receive DHCP response from both of them. The dhcpcd on the DUT may be confused then. Also, I\u0027m not that sure how the L3 packet would be sent when the L2 connected interfaces has different subnet...\n\n2. The interfaces are managed by shill on the chromeOS-base routers. shill spawns dhcpcd on the all \"link/ether\" interfaces, except those whose name starts with \"veth\". Unfortunately, bridges are also \"link/ether\"... Thus, the two bridges, who have dhcp servers running on, have also dhcp clients running on -- that\u0027s what Brian observed at https://crbug.com/1070321#c9. Still, I don\u0027t know how it break our network, but it absolutely needs to be prevented.\nFor how to prevent shill from starting dhcp clients, refer the CL: https://crrev.com/c/2498621. It\u0027s also hacky though.",
      "parentUuid": "d9d2d539_2ebf421c",
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b39b7a09_1641819b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-11-02T05:45:00Z",
      "side": 1,
      "message": "only a few nits.\n\nI\u0027m not very familiar with FT, but the test flow looks correct.",
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6d9af77f_45478cb7",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 33,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-11-02T05:45:00Z",
      "side": 1,
      "message": "not sure but looks like this can be inferred by \"mixedSecConfFac !\u003d nil\"?",
      "range": {
        "startLine": 33,
        "startChar": 1,
        "endLine": 33,
        "endChar": 21
      },
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5da085ff_a76cd428",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 33,
      "author": {
        "id": 1387481
      },
      "writtenOn": "2020-11-05T10:25:53Z",
      "side": 1,
      "message": "mixedSecConfFac is only for \"mixed_eap\" subtest due to a bug (See the TODO at line#83). Once that\u0027s fixed, the mixedSecConfFac field should be removed and only one factory should remain.\n\nAdded more comments.",
      "parentUuid": "6d9af77f_45478cb7",
      "range": {
        "startLine": 33,
        "startChar": 1,
        "endLine": 33,
        "endChar": 21
      },
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e966238c_a0291045",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 33,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-11-06T10:45:30Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "5da085ff_a76cd428",
      "range": {
        "startLine": 33,
        "startChar": 1,
        "endLine": 33,
        "endChar": 21
      },
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "86a4624f_48311735",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 114,
      "author": {
        "id": 1243287
      },
      "writtenOn": "2020-11-03T23:02:56Z",
      "side": 1,
      "message": "nit: bound",
      "range": {
        "startLine": 114,
        "startChar": 62,
        "endLine": 114,
        "endChar": 68
      },
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8ae6277e_f98200ed",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 114,
      "author": {
        "id": 1387481
      },
      "writtenOn": "2020-11-05T10:25:53Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "86a4624f_48311735",
      "range": {
        "startLine": 114,
        "startChar": 62,
        "endLine": 114,
        "endChar": 68
      },
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "abccb025_b32cd290",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 142,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-11-02T05:45:00Z",
      "side": 1,
      "message": "nit: as this is a long function, might be nice to have some comment for it.",
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "35e695d1_b09d7f5e",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 142,
      "author": {
        "id": 1387481
      },
      "writtenOn": "2020-11-05T10:25:53Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "abccb025_b32cd290",
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "29b782eb_8a67b7f4",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 146,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-11-02T05:45:00Z",
      "side": 1,
      "message": "nit: maybe use shorten-ed context for this call? See: https://chromium.googlesource.com/chromiumos/platform/tast/+/HEAD/docs/writing_tests.md#Reserve-time-for-clean_up-task\n\nIn WiFi tests, we\u0027re using mixed pattern as context for daemons is a problem... However, I think it is still nice to start using the suggested pattern for non-daemon cases.",
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "67063dc1_b7bcc6bb",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 146,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2020-11-02T06:20:31Z",
      "side": 1,
      "message": "I thought the suggested pattern again. Object constructor, i.e. NewSomething(), should be responsible to clean itself up when the creation process fails. So we don\u0027t need to reserve time for its associate defer call as it is never called in such case. To sum up, the pattern in this CL looks reasonable to me.",
      "parentUuid": "29b782eb_8a67b7f4",
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "092fcb3a_d8b3fee0",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 146,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-11-02T09:11:37Z",
      "side": 1,
      "message": "If New properly handles it, I\u0027m also OK with the it.\n\n(But we still don\u0027t have a proper guideline for when to use each pattern, might need to discuss this in some other place, perhaps a bug?)",
      "parentUuid": "67063dc1_b7bcc6bb",
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "00ecf0b6_4a57a2eb",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 146,
      "author": {
        "id": 1387481
      },
      "writtenOn": "2020-11-05T10:25:53Z",
      "side": 1,
      "message": "In NewBridge/Veth, I follow the old style:\n  func NewBridge {\n    init A\n    if err then return\n    ctx \u003d reserveForDeconfigureA(ctx)\n    defer if retErr !\u003d nil then deconfigure A\n\n    // init other resources...\n  }\n\nI think it\u0027s not good enough under the new guideline, since I didn\u0027t reserve for deconfiguring A before initializing A. I\u0027m thinking if I should fix them in the not-yet-merged CLs...\n\nAnyway, I think we should handle them in the New* functions instead of here. Mark as resolved.",
      "parentUuid": "092fcb3a_d8b3fee0",
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "517c9a8e_18902b4d",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 229,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2020-11-02T06:20:31Z",
      "side": 1,
      "message": "Is this correct?",
      "range": {
        "startLine": 229,
        "startChar": 52,
        "endLine": 229,
        "endChar": 56
      },
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "518061d2_6d4af6d2",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 229,
      "author": {
        "id": 1243287
      },
      "writtenOn": "2020-11-03T23:02:56Z",
      "side": 1,
      "message": "Should be: https://source.corp.google.com/chromeos_public/src/third_party/autotest/files/server/site_tests/network_WiFi_RoamFT/network_WiFi_RoamFT.py;l\u003d128\n\nI forget the details (you can find them documented in the example hostapd.conf file), but you\u0027re supposed to include the keys of the APs you intend to roam to in one of the fields.",
      "parentUuid": "517c9a8e_18902b4d",
      "range": {
        "startLine": 229,
        "startChar": 52,
        "endLine": 229,
        "endChar": 56
      },
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2bcc1487_eef201fa",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 296,
      "author": {
        "id": 1243287
      },
      "writtenOn": "2020-11-03T23:02:56Z",
      "side": 1,
      "message": "Can we leave a TODO(b/171086223) somewhere here? We still have the same problem as with RoamDbus where the BSSID changing only really means we\u0027ve initiated the roam attempt as opposed to actually connecting.",
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ece50224_ac5dc556",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 296,
      "author": {
        "id": 1387481
      },
      "writtenOn": "2020-11-05T10:25:53Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "2bcc1487_eef201fa",
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a761f051_ac2ab2e4",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 335,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-11-02T05:45:00Z",
      "side": 1,
      "message": "I think this part of logic is for this comment in Autotest:\n\n# Check that we don\u0027t disconnect along the way here, in case we\u0027re\n# ping-ponging around APs -- and after the first (failed) roam, the\n# second re-connection will not be testing FT at all.\n\nMight be nice to also have the same comment here.",
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2ff6a47c_a8829564",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 335,
      "author": {
        "id": 1387481
      },
      "writtenOn": "2020-11-05T10:25:53Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a761f051_ac2ab2e4",
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f70ea511_8455453a",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 382,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-11-02T05:45:00Z",
      "side": 1,
      "message": "According to [1], a corner case is that SetXXX takes almost all time in context and cleanup will not really have enough time.\n\nThe pattern in [1] is a little complicated as it needs two context variable. For the usage here, I wonder if it is simpler to re-order the logic to have deferred restore first:\n\n  oldSetting, err :\u003d getXXX(ctx)\n  if err !\u003d nil {\n    s.Fatal(...)\n  }\n  // Restore on leaving.\n  defer func(ctx context.Context) {\n    if err :\u003d setXXX(ctx, oldSetting); err !\u003d nil {\n      s.Error(...)\n    }\n  }(ctx)\n  ctx, cancel \u003d ctxutil.Shorten(ctx, time.Second)\n  defer cancel()\n  // Apply required setting.\n  if err :\u003d setXXX(ctx, requiredSetting); err !\u003d nil {\n    s.Fatal(...)\n  }\n\nWDYT?\n\n[1] https://chromium.googlesource.com/chromiumos/platform/tast/+/HEAD/docs/writing_tests.md#Reserve-time-for-clean_up-task",
      "range": {
        "startLine": 372,
        "startChar": 1,
        "endLine": 382,
        "endChar": 15
      },
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "73aa152b_37fcbba2",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 382,
      "author": {
        "id": 1387481
      },
      "writtenOn": "2020-11-05T10:25:53Z",
      "side": 1,
      "message": "Good idea!",
      "parentUuid": "f70ea511_8455453a",
      "range": {
        "startLine": 372,
        "startChar": 1,
        "endLine": 382,
        "endChar": 15
      },
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5024e42b_d7c961f2",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 392,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-11-02T05:45:00Z",
      "side": 1,
      "message": "nit: perhaps also shorten a little bit here.",
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ed33450f_9095d242",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 392,
      "author": {
        "id": 1387481
      },
      "writtenOn": "2020-11-05T10:25:53Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5024e42b_d7c961f2",
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1f40bb3e_54ea4f07",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 401,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2020-11-02T06:20:31Z",
      "side": 1,
      "message": "Shall we also expect that test will fail if global FT is unset and APs are not in mixed mode?",
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e60bbbf7_977c0acb",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_ft.go",
        "patchSetId": 9
      },
      "lineNbr": 401,
      "author": {
        "id": 1387481
      },
      "writtenOn": "2020-11-05T10:25:53Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1f40bb3e_54ea4f07",
      "revId": "312293f8fc9681c4eeaa6255fef50b0797fb7a90",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}