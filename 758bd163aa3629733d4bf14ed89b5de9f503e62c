{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "1d443414_5afd1d78",
        "filename": "/COMMIT_MSG",
        "patchSetId": 9
      },
      "lineNbr": 7,
      "author": {
        "id": 1394308
      },
      "writtenOn": "2021-09-14T23:48:20Z",
      "side": 1,
      "message": "Most of our perf tests seem to have \"Perf\" in their test names:\nhttps://source.chromium.org/search?q\u003dchromiumos%2Ftast%2Fcommon%2Fperf%20testing%5C.AddTest%20file:tast%2Flocal%2Fbundles%2Fcros%2Farc\nMaybe we should follow the convention? (e.g. arc.MediaScanPerf)",
      "range": {
        "startLine": 7,
        "startChar": 16,
        "endLine": 7,
        "endChar": 33
      },
      "revId": "758bd163aa3629733d4bf14ed89b5de9f503e62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3f4b7233_3cb031c8",
        "filename": "/COMMIT_MSG",
        "patchSetId": 9
      },
      "lineNbr": 7,
      "author": {
        "id": 1221932
      },
      "writtenOn": "2021-09-15T05:05:08Z",
      "side": 1,
      "message": "+1. That will also open up the possibility to add more measurements (e.g., CPU).",
      "parentUuid": "1d443414_5afd1d78",
      "range": {
        "startLine": 7,
        "startChar": 16,
        "endLine": 7,
        "endChar": 33
      },
      "revId": "758bd163aa3629733d4bf14ed89b5de9f503e62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0d5bb267_a6d78b2e",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_time.go",
        "patchSetId": 9
      },
      "lineNbr": 29,
      "author": {
        "id": 1394308
      },
      "writtenOn": "2021-09-14T23:48:20Z",
      "side": 1,
      "message": "Now crrev.com/c/3143248 is merged. You can use arc.MyFilesUUID after rebasing.",
      "revId": "758bd163aa3629733d4bf14ed89b5de9f503e62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "591731bd_d07841fd",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_time.go",
        "patchSetId": 9
      },
      "lineNbr": 51,
      "author": {
        "id": 1394308
      },
      "writtenOn": "2021-09-14T07:58:48Z",
      "side": 1,
      "message": "As I mentioned offline, we should probably specify \"group:crosbolt\" here: https://chromium.googlesource.com/chromiumos/platform/tast/+/HEAD/docs/test_attributes.md",
      "revId": "758bd163aa3629733d4bf14ed89b5de9f503e62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "da35f12c_4daf7f64",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_time.go",
        "patchSetId": 9
      },
      "lineNbr": 51,
      "author": {
        "id": 1519657
      },
      "writtenOn": "2021-09-15T02:22:57Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "591731bd_d07841fd",
      "revId": "758bd163aa3629733d4bf14ed89b5de9f503e62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "32403e5c_221ba69a",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_time.go",
        "patchSetId": 9
      },
      "lineNbr": 51,
      "author": {
        "id": 1221932
      },
      "writtenOn": "2021-09-15T05:05:08Z",
      "side": 1,
      "message": "I think this is not done yet?",
      "parentUuid": "da35f12c_4daf7f64",
      "revId": "758bd163aa3629733d4bf14ed89b5de9f503e62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "246a71e7_6176eece",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_time.go",
        "patchSetId": 9
      },
      "lineNbr": 111,
      "author": {
        "id": 1394308
      },
      "writtenOn": "2021-09-14T07:58:48Z",
      "side": 1,
      "message": "As I mentioned offline, we should use testing.Poll inside this function.\nThis is because the MyFiles volume might not be mounted yet when this function is called. In such a case, the MyFiles volume will not be listed in the output of sm list-volumes.\n\nAn alternative is to wait for the MyFiles volume to be mounted before calling this function. This option seems better because we should actually wait for emulated;0 to be mounted before doing measurement, too. We can pass a function to wait for the target volume to be mounted as a parameter.",
      "revId": "758bd163aa3629733d4bf14ed89b5de9f503e62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "43357b7d_fa4644f3",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_time.go",
        "patchSetId": 9
      },
      "lineNbr": 111,
      "author": {
        "id": 1394308
      },
      "writtenOn": "2021-09-14T23:48:20Z",
      "side": 1,
      "message": "Now crrev.com/c/3143248 is merged. How abount defining two functions arc.MyFilesVolumeID and arc.SdcardVolumeID in src/chromiumos/tast/local/arc/volume.go after rebasing?\n  // In volume.go\n\n  // MyFilesVolumeID returns the volume ID of the MyFiles volume. It waits for\n  // the volume to be mounted if it is not mounted yet.\n  func MyFilesVolumeID(ctx context.Context, a *arc.ARC) (string, error) {\n    [...]\n  }\n\n  // SdcardVolumeID returns the volume ID of the sdcard volume\n  // (/storage/emulated/0). Although the volume ID itself is a constant, the\n  // function waits for the volume to be mounted if it is not mounted yet,\n  // so that the ID is guaranteed to be valid and usable inside ARC.\n  func SdcardVolumeID(ctx context.Context, a *arc.ARC) (string, error) {\n    [...]\n  }",
      "parentUuid": "246a71e7_6176eece",
      "revId": "758bd163aa3629733d4bf14ed89b5de9f503e62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8f60e9ef_add24b28",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_time.go",
        "patchSetId": 9
      },
      "lineNbr": 130,
      "author": {
        "id": 1394308
      },
      "writtenOn": "2021-09-14T07:58:48Z",
      "side": 1,
      "message": "Now we don\u0027t need to unmount the volume before populating it. So, maybe there is no point in doing the following two things in one function: 1) populate the volume with files and 2) remount the volume in one function.\n\nHow about splitting this function into four separate functions:\nA) A function to set up the target directory\nB) A function to wait for MediaStore database to be populated with test files (needed only for MyFiles)\nC) A function to clear MediaStore database (should this be called only for MyFiles, or should we call it for sdcard too?)\nD) A function to trigger a full volume scan\n\nOf course you can put some of these functions into a larger function. For example, functions (A), (B), and (C) do some preparation for the measurement, so it might not be meaningless to put them into one function. It\u0027s your call, so please restructure the entire test as you like.\n\nPlease note that we should probably add some code comment for function (B) because it is not at all trivial why such a step is needed. Maybe it\u0027s better to add some explanation on why (C) is needed, too.",
      "revId": "758bd163aa3629733d4bf14ed89b5de9f503e62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5c6b1892_8423780b",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_time.go",
        "patchSetId": 9
      },
      "lineNbr": 132,
      "author": {
        "id": 1394308
      },
      "writtenOn": "2021-09-14T07:58:48Z",
      "side": 1,
      "message": "1. This won\u0027t work for sdcard, right?\n2. You should use medaScanTimeMyFilesUUID for 0000....CAFEF00D2019.\n3. As mentioned in another comment, we should probably extract this part as a separate function to make the code more understandable.",
      "revId": "758bd163aa3629733d4bf14ed89b5de9f503e62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2d8a2cea_107a993f",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_time.go",
        "patchSetId": 9
      },
      "lineNbr": 132,
      "author": {
        "id": 1519657
      },
      "writtenOn": "2021-09-15T02:22:57Z",
      "side": 1,
      "message": "I think you mentioned inotify is not triggered in sdcard by bug, so should we make this function work for sdcard? Or we don\u0027t have to think of sdcard and let this function work for only MyFiles?",
      "parentUuid": "5c6b1892_8423780b",
      "revId": "758bd163aa3629733d4bf14ed89b5de9f503e62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "17c68274_e5b9920f",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_time.go",
        "patchSetId": 9
      },
      "lineNbr": 132,
      "author": {
        "id": 1394308
      },
      "writtenOn": "2021-09-15T03:00:15Z",
      "side": 1,
      "message": "FileSystemWatcher (inotify) is not attached to sdcard. So this part to wait for MediaStore database won\u0027t work and should not be executed for sdcard.\nYou can mention b:189416284 in a code comment to explain why it should be skipped.",
      "parentUuid": "2d8a2cea_107a993f",
      "revId": "758bd163aa3629733d4bf14ed89b5de9f503e62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cad092c4_6e82f66e",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_time.go",
        "patchSetId": 9
      },
      "lineNbr": 146,
      "author": {
        "id": 1394308
      },
      "writtenOn": "2021-09-14T07:58:48Z",
      "side": 1,
      "message": "Including both numberOfScannedFiles and numberOfCopies to the error message will make it more informative.",
      "revId": "758bd163aa3629733d4bf14ed89b5de9f503e62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "28c2d03f_fc7238d1",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_time.go",
        "patchSetId": 9
      },
      "lineNbr": 164,
      "author": {
        "id": 1394308
      },
      "writtenOn": "2021-09-15T23:51:19Z",
      "side": 1,
      "message": "Shouldn\u0027t we defer capybaraSrc.Close?",
      "revId": "758bd163aa3629733d4bf14ed89b5de9f503e62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fad52460_76b1ded7",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_time.go",
        "patchSetId": 9
      },
      "lineNbr": 177,
      "author": {
        "id": 1394308
      },
      "writtenOn": "2021-09-15T23:51:19Z",
      "side": 1,
      "message": "This dst.Close is not executed until the function returns. You should close each file within the loop body:\n  for i :\u003d 0; i \u003c numberOfCopies; i++ {\n    [...]\n    if _, err :\u003d io.Copy(dst, capybaraSrc); err !\u003d nil {\n      dst.Close()\n      s.Fatal([...])\n    }\n    dst.Close()\n  }",
      "revId": "758bd163aa3629733d4bf14ed89b5de9f503e62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "389318e9_fad56ffa",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_time.go",
        "patchSetId": 9
      },
      "lineNbr": 241,
      "author": {
        "id": 1394308
      },
      "writtenOn": "2021-09-14T07:58:48Z",
      "side": 1,
      "message": "Isn\u0027t it better to launch the test app in a later stage, e.g. after MediaStore database is cleared?",
      "revId": "758bd163aa3629733d4bf14ed89b5de9f503e62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}