{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "eb52b56f_da28ddd5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1132414
      },
      "writtenOn": "2022-08-26T17:47:05Z",
      "side": 1,
      "message": "I think this looks better, thanks. (Still not sure if we\u0027ll fix the problem, but hopefully get closer to debugging it.)\n\nI leave it to you to decide if hidehiko should re-review",
      "revId": "6f2045abf2bfc966697f48109642c96eac1d5583",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d16be36a_091c8984",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1294890
      },
      "writtenOn": "2022-08-29T07:48:40Z",
      "side": 1,
      "message": "hidehiko@, would you please take a look at the changes betw ps#1 and ps#4? Thanks.",
      "revId": "6f2045abf2bfc966697f48109642c96eac1d5583",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2e13eb6e_21479e6d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2022-08-29T16:28:10Z",
      "side": 1,
      "message": "# Unmarking CR+2 just in case. Overall direction still LG, but I\u0027d like to see a few more things.",
      "revId": "6f2045abf2bfc966697f48109642c96eac1d5583",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f38edcca_e3cf6844",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/bootperf/metrics_util.go",
        "patchSetId": 4
      },
      "lineNbr": 184,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2022-08-29T16:28:10Z",
      "side": 1,
      "message": "I think, if it reports an err, it EnsureTlsdatedStateBeforeReboot should return error, too.",
      "range": {
        "startLine": 182,
        "startChar": 2,
        "endLine": 184,
        "endChar": 3
      },
      "revId": "6f2045abf2bfc966697f48109642c96eac1d5583",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b889a878_a7fffe37",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/bootperf/metrics_util.go",
        "patchSetId": 4
      },
      "lineNbr": 184,
      "author": {
        "id": 1294890
      },
      "writtenOn": "2022-08-30T04:02:03Z",
      "side": 1,
      "message": "This error is consumed because we try to recover from this condition. The function works as:\n\n1. The function literal checks a) if tlsdated is running and b) if /tmp/sync-rtc-tlsdated-start is present. If this both are true, just return.\n2. If the check fails, we try to recover by restarting tlsdated to see if /tmp/sync-rtc-tlsdated-start can be generated. If it still fails, return the error: restating tlsdated more may not be helpful.\n\nSince the function restarts tlsdated to recover the error, the original error in 1. that why tlsdated isn\u0027t in a running state, or why upstart fails to check the job status, doesn\u0027t provide much information. I think it\u0027s OK to just consume the error.",
      "parentUuid": "f38edcca_e3cf6844",
      "range": {
        "startLine": 182,
        "startChar": 2,
        "endLine": 184,
        "endChar": 3
      },
      "revId": "6f2045abf2bfc966697f48109642c96eac1d5583",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fa73aeef_e240d2e5",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/bootperf/metrics_util.go",
        "patchSetId": 4
      },
      "lineNbr": 184,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2022-08-30T14:39:52Z",
      "side": 1,
      "message": "I agree most of the parts, except \"it fails on checking upstart\".\nIf it is not running, upstart state should return so, thus if an error is returned, the enclosing function should return it, shouldn\u0027t it?",
      "parentUuid": "b889a878_a7fffe37",
      "range": {
        "startLine": 182,
        "startChar": 2,
        "endLine": 184,
        "endChar": 3
      },
      "revId": "6f2045abf2bfc966697f48109642c96eac1d5583",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "dd06f0c4_d6bf55a4",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/bootperf/metrics_util.go",
        "patchSetId": 4
      },
      "lineNbr": 184,
      "author": {
        "id": 1294890
      },
      "writtenOn": "2022-09-02T07:42:45Z",
      "side": 1,
      "message": "Updated to log debugging info.",
      "parentUuid": "fa73aeef_e240d2e5",
      "range": {
        "startLine": 182,
        "startChar": 2,
        "endLine": 184,
        "endChar": 3
      },
      "revId": "6f2045abf2bfc966697f48109642c96eac1d5583",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "11c99804_ed522c3f",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/bootperf/metrics_util.go",
        "patchSetId": 4
      },
      "lineNbr": 187,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2022-08-29T16:28:10Z",
      "side": 1,
      "message": "clarification: when this happens?\nShould we consider this as critical error? Or, it should not?",
      "revId": "6f2045abf2bfc966697f48109642c96eac1d5583",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "352b4fc8_21f9ab92",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/bootperf/metrics_util.go",
        "patchSetId": 4
      },
      "lineNbr": 187,
      "author": {
        "id": 1294890
      },
      "writtenOn": "2022-08-30T04:02:03Z",
      "side": 1,
      "message": "This file (/tmp/sync-rtc-tlsdated-start) is generated before starting tlsdated. It\u0027s part of the boot process:\nhttps://source.chromium.org/chromiumos/chromiumos/codesearch/+/main:src/third_party/tlsdate/init/tlsdated.conf;l\u003d40?q\u003dtlsdated.conf\u0026ss\u003dchromiumos\n\nThe test treated it as a critical error and failed and this test becomes flaky because the file is sometimes missing, for reasons we still don\u0027t know. It\u0027s unlikely that some other service occupies the RTC hardware device given that the file can be missing in the 2nd or 3rd reboot iteration of the boot performance test. So we\u0027d like to make the test more fault-tolerant by restarting tlsdated to recover from this failure.",
      "parentUuid": "11c99804_ed522c3f",
      "revId": "6f2045abf2bfc966697f48109642c96eac1d5583",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b7f04e32_59c44515",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/bootperf/metrics_util.go",
        "patchSetId": 4
      },
      "lineNbr": 187,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2022-08-30T14:39:52Z",
      "side": 1,
      "message": "\u003e for reasons we still don\u0027t know.\n\nFor stabilization, we should understand the background theory.\nthe workaround should be the last resort of the testing stabilization, IMHO. WDYT?",
      "parentUuid": "352b4fc8_21f9ab92",
      "revId": "6f2045abf2bfc966697f48109642c96eac1d5583",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7c331931_724136e3",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/bootperf/metrics_util.go",
        "patchSetId": 4
      },
      "lineNbr": 187,
      "author": {
        "id": 1294890
      },
      "writtenOn": "2022-08-31T10:27:55Z",
      "side": 1,
      "message": "There can be multiple failure paths when bootstat accesses the RTC device (/dev/rtc). One theory is that the RTC device (/dev/rtc) is busy, but I can\u0027t imagine how.\n\nI think we can add more debugging info w.r.t. /dev/rtc:\n- run fuser /dev/rtc to see if any process is using it\n- if it\u0027s busy, what process is using it.\n- run bootstat --sync\u003drtc (an unused name) to see if bootstat outputs any error\n\nIf all these fails, we may need to use ftrace to trace the user of this device during boot ðŸ˜Š",
      "parentUuid": "b7f04e32_59c44515",
      "revId": "6f2045abf2bfc966697f48109642c96eac1d5583",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f878634b_940b75e8",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/bootperf/metrics_util.go",
        "patchSetId": 4
      },
      "lineNbr": 187,
      "author": {
        "id": 1294890
      },
      "writtenOn": "2022-09-02T07:42:45Z",
      "side": 1,
      "message": "Updated to log debugging info.",
      "parentUuid": "7c331931_724136e3",
      "revId": "6f2045abf2bfc966697f48109642c96eac1d5583",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6b476a9b_ec14675a",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/bootperf/metrics_util.go",
        "patchSetId": 4
      },
      "lineNbr": 201,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2022-08-29T16:28:10Z",
      "side": 1,
      "message": "Another clarification:\nIIUC, tlsdated should create this file. Then, any timing issues?\nI.e., should this file be created \"before\" the tlsdated job is becoming running? Or, if it is created at the beginning of tlsdated daemon, you may want to poll in order to avoid flakiness. Could you double check?",
      "revId": "6f2045abf2bfc966697f48109642c96eac1d5583",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bc1fd00a_28c29223",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/bootperf/metrics_util.go",
        "patchSetId": 4
      },
      "lineNbr": 201,
      "author": {
        "id": 1294890
      },
      "writtenOn": "2022-08-30T04:02:03Z",
      "side": 1,
      "message": "This isn\u0027t suppose to be a race condition because the file is generated in the pre-start stanza of the tlsdated config https://source.chromium.org/chromiumos/chromiumos/codesearch/+/main:src/third_party/tlsdate/init/tlsdated.conf;l\u003d40?q\u003dtlsdated.conf\u0026ss\u003dchromiumos\n\nThe file is generated strictly before upstart starts the tlsdated process.",
      "parentUuid": "6b476a9b_ec14675a",
      "revId": "6f2045abf2bfc966697f48109642c96eac1d5583",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e2b49ab5_dcddfed7",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/bootperf/metrics_util.go",
        "patchSetId": 4
      },
      "lineNbr": 201,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2022-08-30T14:39:52Z",
      "side": 1,
      "message": "Great. Thank you for confirmation!\n\nMaybe nice to mention it briefly here.",
      "parentUuid": "bc1fd00a_28c29223",
      "revId": "6f2045abf2bfc966697f48109642c96eac1d5583",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bedc4ff7_9d69bbd1",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/bootperf/metrics_util.go",
        "patchSetId": 4
      },
      "lineNbr": 201,
      "author": {
        "id": 1294890
      },
      "writtenOn": "2022-09-02T07:42:45Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e2b49ab5_dcddfed7",
      "revId": "6f2045abf2bfc966697f48109642c96eac1d5583",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}