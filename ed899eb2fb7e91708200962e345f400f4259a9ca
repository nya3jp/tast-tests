{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "ad9ea5f8_279d7956",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1550137
      },
      "writtenOn": "2022-10-04T22:38:29Z",
      "side": 1,
      "message": "Hi! I\u0027m a member of the HW security firmware team working on improving CCD capability testing. I\u0027m pretty new to Tast/Go so any feedback on this CL would be much appreciated. Happy to answer any questions and/or make any updates. Thanks in advance!",
      "revId": "ed899eb2fb7e91708200962e345f400f4259a9ca",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bd5fb93d_89a48016",
        "filename": "src/chromiumos/tast/remote/bundles/cros/hwsec/ccd_capabilities_gsc_full_console.go",
        "patchSetId": 5
      },
      "lineNbr": 20,
      "author": {
        "id": 1483403
      },
      "writtenOn": "2022-10-05T18:31:13Z",
      "side": 1,
      "message": "Can you put this in firmware_unstable instead of firmware_cr50 until we know it works?  Also does this test actually require CCD or would a servo_micro work also?",
      "range": {
        "startLine": 20,
        "startChar": 67,
        "endLine": 20,
        "endChar": 80
      },
      "revId": "ed899eb2fb7e91708200962e345f400f4259a9ca",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3c1f1ac9_630010da",
        "filename": "src/chromiumos/tast/remote/bundles/cros/hwsec/ccd_capabilities_gsc_full_console.go",
        "patchSetId": 5
      },
      "lineNbr": 20,
      "author": {
        "id": 1550137
      },
      "writtenOn": "2022-10-10T22:32:24Z",
      "side": 1,
      "message": "Yes, fixed. `servo_micro` should work too, I\u0027ve removed `firmware_ccd`.",
      "parentUuid": "bd5fb93d_89a48016",
      "range": {
        "startLine": 20,
        "startChar": 67,
        "endLine": 20,
        "endChar": 80
      },
      "revId": "ed899eb2fb7e91708200962e345f400f4259a9ca",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "845a1770_66e0a838",
        "filename": "src/chromiumos/tast/remote/bundles/cros/hwsec/ccd_capabilities_gsc_full_console.go",
        "patchSetId": 5
      },
      "lineNbr": 28,
      "author": {
        "id": 1483403
      },
      "writtenOn": "2022-10-05T18:31:13Z",
      "side": 1,
      "message": "You can actually use Var instead of VarDeps, and then when running by hand it will default to localhost:9999",
      "range": {
        "startLine": 28,
        "startChar": 2,
        "endLine": 28,
        "endChar": 9
      },
      "revId": "ed899eb2fb7e91708200962e345f400f4259a9ca",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0086a8b1_105c731c",
        "filename": "src/chromiumos/tast/remote/bundles/cros/hwsec/ccd_capabilities_gsc_full_console.go",
        "patchSetId": 5
      },
      "lineNbr": 28,
      "author": {
        "id": 1550137
      },
      "writtenOn": "2022-10-10T22:32:24Z",
      "side": 1,
      "message": "Ah, fixed!",
      "parentUuid": "845a1770_66e0a838",
      "range": {
        "startLine": 28,
        "startChar": 2,
        "endLine": 28,
        "endChar": 9
      },
      "revId": "ed899eb2fb7e91708200962e345f400f4259a9ca",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "96243377_bd0a038f",
        "filename": "src/chromiumos/tast/remote/bundles/cros/hwsec/ccd_capabilities_gsc_full_console.go",
        "patchSetId": 5
      },
      "lineNbr": 35,
      "author": {
        "id": 1266306
      },
      "writtenOn": "2022-10-05T19:08:00Z",
      "side": 1,
      "message": "if err :\u003d ...; err !\u003d nil {...}, here and elsewhere.",
      "revId": "ed899eb2fb7e91708200962e345f400f4259a9ca",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f19c41d3_428dacc2",
        "filename": "src/chromiumos/tast/remote/bundles/cros/hwsec/ccd_capabilities_gsc_full_console.go",
        "patchSetId": 5
      },
      "lineNbr": 35,
      "author": {
        "id": 1550137
      },
      "writtenOn": "2022-10-10T22:32:24Z",
      "side": 1,
      "message": "Cool, done.",
      "parentUuid": "96243377_bd0a038f",
      "revId": "ed899eb2fb7e91708200962e345f400f4259a9ca",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1b580e5c_0041bee1",
        "filename": "src/chromiumos/tast/remote/bundles/cros/hwsec/ccd_capabilities_gsc_full_console.go",
        "patchSetId": 5
      },
      "lineNbr": 42,
      "author": {
        "id": 1483403
      },
      "writtenOn": "2022-10-05T18:31:13Z",
      "side": 1,
      "message": "This is not what you are setting.",
      "range": {
        "startLine": 42,
        "startChar": 57,
        "endLine": 42,
        "endChar": 63
      },
      "revId": "ed899eb2fb7e91708200962e345f400f4259a9ca",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3688b280_9684f00d",
        "filename": "src/chromiumos/tast/remote/bundles/cros/hwsec/ccd_capabilities_gsc_full_console.go",
        "patchSetId": 5
      },
      "lineNbr": 42,
      "author": {
        "id": 1550137
      },
      "writtenOn": "2022-10-10T22:32:24Z",
      "side": 1,
      "message": "Whoops, fixed this comment.",
      "parentUuid": "1b580e5c_0041bee1",
      "range": {
        "startLine": 42,
        "startChar": 57,
        "endLine": 42,
        "endChar": 63
      },
      "revId": "ed899eb2fb7e91708200962e345f400f4259a9ca",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "babac896_a68f4f99",
        "filename": "src/chromiumos/tast/remote/bundles/cros/hwsec/ccd_capabilities_gsc_full_console.go",
        "patchSetId": 5
      },
      "lineNbr": 45,
      "author": {
        "id": 1266306
      },
      "writtenOn": "2022-10-05T19:08:00Z",
      "side": 1,
      "message": "Consider using table driven test pattern for these: https://chromium.googlesource.com/chromiumos/platform/tast/+/HEAD/docs/writing_tests.md#table_driven-tests",
      "revId": "ed899eb2fb7e91708200962e345f400f4259a9ca",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "067f5e7b_8cb4bbe6",
        "filename": "src/chromiumos/tast/remote/bundles/cros/hwsec/ccd_capabilities_gsc_full_console.go",
        "patchSetId": 5
      },
      "lineNbr": 45,
      "author": {
        "id": 1550137
      },
      "writtenOn": "2022-10-10T22:32:24Z",
      "side": 1,
      "message": "Cool, I\u0027ve refactored this test to use this pattern and made it more exhaustive in the process.",
      "parentUuid": "babac896_a68f4f99",
      "revId": "ed899eb2fb7e91708200962e345f400f4259a9ca",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d06dbb78_a38258f7",
        "filename": "src/chromiumos/tast/remote/bundles/cros/hwsec/ccd_capabilities_gsc_full_console.go",
        "patchSetId": 5
      },
      "lineNbr": 63,
      "author": {
        "id": 1483403
      },
      "writtenOn": "2022-10-05T18:31:13Z",
      "side": 1,
      "message": "This needs a defer call to open ccd again afterwards. A defer call would be good.  Leaving the CCD locked might break later tests.",
      "range": {
        "startLine": 60,
        "startChar": 1,
        "endLine": 63,
        "endChar": 2
      },
      "revId": "ed899eb2fb7e91708200962e345f400f4259a9ca",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3404b636_137c6e2c",
        "filename": "src/chromiumos/tast/remote/bundles/cros/hwsec/ccd_capabilities_gsc_full_console.go",
        "patchSetId": 5
      },
      "lineNbr": 63,
      "author": {
        "id": 1550137
      },
      "writtenOn": "2022-10-10T22:32:24Z",
      "side": 1,
      "message": "Gotcha, added a `defer` call to open CCD.",
      "parentUuid": "d06dbb78_a38258f7",
      "range": {
        "startLine": 60,
        "startChar": 1,
        "endLine": 63,
        "endChar": 2
      },
      "revId": "ed899eb2fb7e91708200962e345f400f4259a9ca",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8a344cfa_b742a496",
        "filename": "src/chromiumos/tast/remote/firmware/helper.go",
        "patchSetId": 5
      },
      "lineNbr": 1187,
      "author": {
        "id": 1266306
      },
      "writtenOn": "2022-10-05T19:08:00Z",
      "side": 1,
      "message": "Is this wrapper even needed?  I don\u0027t see callers checking for zero len matches.",
      "revId": "ed899eb2fb7e91708200962e345f400f4259a9ca",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b69f10c7_1dbecbd8",
        "filename": "src/chromiumos/tast/remote/firmware/helper.go",
        "patchSetId": 5
      },
      "lineNbr": 1187,
      "author": {
        "id": 1550137
      },
      "writtenOn": "2022-10-10T22:32:24Z",
      "side": 1,
      "message": "This wrapper isn\u0027t really needed, but it does include better regex error prints when things do go wrong. For example:\n\n\n```\n2022-10-10T22:02:25.975025Z hwsec.CCDCapabilitiesGscFullConsole.cap_unless_locked [ FAIL ] Failed to match GSC command output, expected command `idle s` to succeed \u003d false: Failed to run `idle s` on GSC, expected regex patterns \u003d {Console is locked|Access Denied}: setting CR50UARTCmd to idle s: setting servo control \"cr50_uart_cmd\" to \"idle s\": xml-rpc fault with code 1: \u003cclass \u0027servo.drv.pty_driver.ptyError\u0027\u003e:PD/Cr50: Timeout waiting for response. There was output: se \u0027ccd help\u0027 to print subcommands, \u003e , \u003e idle s, idle action: sleep, deep sleep count: 24, \u003e\n```\n\nI think this information will be useful when debugging tests in the future (instead of just seeing a \"servo control failure with timeout\" as a root cause) so I\u0027ve left this function as is for now.",
      "parentUuid": "8a344cfa_b742a496",
      "revId": "ed899eb2fb7e91708200962e345f400f4259a9ca",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "83d5e39c_d5c4f3eb",
        "filename": "src/chromiumos/tast/remote/firmware/helper.go",
        "patchSetId": 5
      },
      "lineNbr": 1201,
      "author": {
        "id": 1266306
      },
      "writtenOn": "2022-10-05T19:08:00Z",
      "side": 1,
      "message": "I think this is better put into: https://source.chromium.org/chromiumos/chromiumos/codesearch/+/main:src/platform/tast-tests/src/chromiumos/tast/common/servo/cr50.go and tests should use h.Servo.LockCCD(...).",
      "revId": "ed899eb2fb7e91708200962e345f400f4259a9ca",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "294c9f1c_dde2fb36",
        "filename": "src/chromiumos/tast/remote/firmware/helper.go",
        "patchSetId": 5
      },
      "lineNbr": 1201,
      "author": {
        "id": 1550137
      },
      "writtenOn": "2022-10-10T22:32:24Z",
      "side": 1,
      "message": "Ah yeah, that would be a better location. Moved both functions!",
      "parentUuid": "83d5e39c_d5c4f3eb",
      "revId": "ed899eb2fb7e91708200962e345f400f4259a9ca",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}