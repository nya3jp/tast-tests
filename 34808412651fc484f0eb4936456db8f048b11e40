{
  "comments": [
    {
      "key": {
        "uuid": "05bae11c_cbf9b4d9",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 108,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2019-11-06T18:18:00Z",
      "side": 1,
      "message": "an alternative way to achieve the same thing (perhaps less flaky?), is to launch a maximized activity that only has white background.",
      "range": {
        "startLine": 107,
        "startChar": 1,
        "endLine": 108,
        "endChar": 66
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "15b3903b_49bdfa3a",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 108,
      "author": {
        "id": 1370589
      },
      "writtenOn": "2019-11-07T03:44:16Z",
      "side": 1,
      "message": "Takahashi san gave me the HTTP server solution, it seems very efficient. I dont\u0027 know the flaky and don\u0027t know how to avoid it... so what do nya@ think about it?",
      "parentUuid": "05bae11c_cbf9b4d9",
      "range": {
        "startLine": 107,
        "startChar": 1,
        "endLine": 108,
        "endChar": 66
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b04f81e9_d29ba0a2",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 108,
      "author": {
        "id": 1370589
      },
      "writtenOn": "2019-11-07T03:50:57Z",
      "side": 1,
      "message": "Maybe I can add a testing.Poll here to try setting wallpaper more times if it failure?",
      "parentUuid": "15b3903b_49bdfa3a",
      "range": {
        "startLine": 107,
        "startChar": 1,
        "endLine": 108,
        "endChar": 66
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "331c8371_69280c9c",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 108,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2019-11-07T17:36:03Z",
      "side": 1,
      "message": "deferring to nya@.\n\n(I\u0027d use an activity with a predefined background color since it involves less \"parts\". \nFor reference, we already have an .apk that has a white background:\nhttp://cs/pi-arc-dev/vendor/google_arc/packages/development/ArcBlackFlashTest/\nAnd there is a test already using it:\nhttp://cs/chromeos_public/src/platform/tast-tests/src/chromiumos/tast/local/bundles/cros/arc/black_flash.go\n\n\n\nRegarding whether http + wallpaper flakyness: TBH, I haven\u0027t used it. But since it involves more parts: installing an http server, fetching image from it + changing wallpaper.  So I thought \"more parts, more changes to have an error\".\n\nFine for me if nya@ thinks it is acceptable to use HTTP server here.\n)",
      "parentUuid": "b04f81e9_d29ba0a2",
      "range": {
        "startLine": 107,
        "startChar": 1,
        "endLine": 108,
        "endChar": 66
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1b6421fd_b4aa1fd4",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 108,
      "author": {
        "id": 1370589
      },
      "writtenOn": "2019-11-08T04:41:25Z",
      "side": 1,
      "message": "Had a discussion with nya@, he told me the local HTTP server is fairly stable. I\u0027m going to use it in this CL. If it cause flakiness, I will try to use other way.",
      "parentUuid": "331c8371_69280c9c",
      "range": {
        "startLine": 107,
        "startChar": 1,
        "endLine": 108,
        "endChar": 66
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1fb08edf_7bb9c3d6",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 108,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-11-08T08:14:28Z",
      "side": 1,
      "message": "I\u0027m optimistic that local HTTP server and chrome.wallpaper API (public) are fairly stable.\n\nIIUC Ricardo\u0027s suggestion was to stack two app windows, but I\u0027m afraid that making sure two windows are in the expected order is a bit tricky. Wallpapers will never be on the top of a window, obviously. :)",
      "parentUuid": "1b6421fd_b4aa1fd4",
      "range": {
        "startLine": 107,
        "startChar": 1,
        "endLine": 108,
        "endChar": 66
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f6aec7e1_0b9d6051",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 108,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2019-11-08T17:47:02Z",
      "side": 1,
      "message": "Ok. SGTM.\n\nmy only concern, although not that critical, is that if the Chrome session gets reused, other test will inherit the wallpaper (unless we revert-back to the original wallpaper).\nNot sure whether this can cause any issues... probably not, but perhaps it is worth adding a comment here in this code saying that.",
      "parentUuid": "1fb08edf_7bb9c3d6",
      "range": {
        "startLine": 107,
        "startChar": 1,
        "endLine": 108,
        "endChar": 66
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "da6b6984_688c63a7",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 108,
      "author": {
        "id": 1370589
      },
      "writtenOn": "2019-11-11T02:06:48Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f6aec7e1_0b9d6051",
      "range": {
        "startLine": 107,
        "startChar": 1,
        "endLine": 108,
        "endChar": 66
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "976ff622_02c71c96",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 157,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2019-11-06T18:18:00Z",
      "side": 1,
      "message": "nit: if SetWindowState fails, you can return testing.PollBreak(err)\n\nhttps://chromium.googlesource.com/chromiumos/platform/tast/+/HEAD/docs/writing_tests.md#contexts-and-timeouts",
      "range": {
        "startLine": 157,
        "startChar": 3,
        "endLine": 157,
        "endChar": 21
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "74a24a1c_8c608040",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 157,
      "author": {
        "id": 1370589
      },
      "writtenOn": "2019-11-08T04:41:25Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "976ff622_02c71c96",
      "range": {
        "startLine": 157,
        "startChar": 3,
        "endLine": 157,
        "endChar": 21
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e2d93ce5_2cb445a5",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 158,
      "author": {
        "id": 1001410
      },
      "writtenOn": "2019-11-06T18:40:04Z",
      "side": 1,
      "message": "Don\u0027t we want to do this outside of the polling loop?",
      "range": {
        "startLine": 156,
        "startChar": 0,
        "endLine": 158,
        "endChar": 3
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c382d4e2_e75b1502",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 158,
      "author": {
        "id": 1370589
      },
      "writtenOn": "2019-11-08T04:41:25Z",
      "side": 1,
      "message": "Ack. I\u0027m going to use testing.PollBreak in this CL, for consistency.",
      "parentUuid": "e2d93ce5_2cb445a5",
      "range": {
        "startLine": 156,
        "startChar": 0,
        "endLine": 158,
        "endChar": 3
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f8a3cabc_6d4d8613",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 188,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2019-11-06T18:18:00Z",
      "side": 1,
      "message": "nit:\nconst shadowWidth \u003d 5",
      "range": {
        "startLine": 188,
        "startChar": 1,
        "endLine": 188,
        "endChar": 12
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ae665771_59b4ff66",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 188,
      "author": {
        "id": 1370589
      },
      "writtenOn": "2019-11-07T03:44:16Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f8a3cabc_6d4d8613",
      "range": {
        "startLine": 188,
        "startChar": 1,
        "endLine": 188,
        "endChar": 12
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "211e3f7e_5ee735ce",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 199,
      "author": {
        "id": 1001410
      },
      "writtenOn": "2019-11-06T18:40:04Z",
      "side": 1,
      "message": "There are two ways to get around line 155 - 167 and 194-199:\n\nInstead of this I\u0027d suggest to use either ActivityOptions.setLaunchBounds() in the starting intent - OR - using the companion library function to move the window to a certain bounds on the screen.\n\nThis is important as you do not know the size of the screen and/or the size of the window and it could be anything.",
      "range": {
        "startLine": 194,
        "startChar": 0,
        "endLine": 199,
        "endChar": 2
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d7aeecfe_189c149c",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 199,
      "author": {
        "id": 1370589
      },
      "writtenOn": "2019-11-07T03:44:16Z",
      "side": 1,
      "message": "Yeah, one more sub-test related changing window size. So I\u0027m going to use companion library function to reset window bounds. I want going to add this part when I am writing the set window bounds function test.",
      "parentUuid": "211e3f7e_5ee735ce",
      "range": {
        "startLine": 194,
        "startChar": 0,
        "endLine": 199,
        "endChar": 2
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e79ee6a6_a3c9a27b",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 199,
      "author": {
        "id": 1370589
      },
      "writtenOn": "2019-11-08T04:41:25Z",
      "side": 1,
      "message": "Added TODO in this CL.",
      "parentUuid": "d7aeecfe_189c149c",
      "range": {
        "startLine": 194,
        "startChar": 0,
        "endLine": 199,
        "endChar": 2
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9c98e6a9_fa82b577",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 214,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2019-11-06T18:18:00Z",
      "side": 1,
      "message": "nit, ditto above:\nyou can return testing.PollBreak(err)",
      "range": {
        "startLine": 214,
        "startChar": 10,
        "endLine": 214,
        "endChar": 13
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "49638bd3_caf53566",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 214,
      "author": {
        "id": 1370589
      },
      "writtenOn": "2019-11-07T03:44:16Z",
      "side": 1,
      "message": "I don\u0027t know whether my opinion is right. I found that the tast UI related API isn\u0027t stable, sometimes it may cause random failure when you try \"GetText\" or \"Click\" or something like these. So I don\u0027t break poll here for avoiding these random failure.",
      "parentUuid": "9c98e6a9_fa82b577",
      "range": {
        "startLine": 214,
        "startChar": 10,
        "endLine": 214,
        "endChar": 13
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7ca063ce_8d9a1f3e",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 214,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2019-11-07T17:36:03Z",
      "side": 1,
      "message": "Ok. Fine to leave it as it is.\n\nIt shouldn\u0027t fail in this case, but everything is possible.\n\nSometimes the UIAutomator fails, as you said. But usually it is because the widget that you are looking for is not present yet. One wait to fix it, is by calling obj.WaitForExist().",
      "parentUuid": "49638bd3_caf53566",
      "range": {
        "startLine": 214,
        "startChar": 10,
        "endLine": 214,
        "endChar": 13
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8c39c31c_3d6aa20e",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 214,
      "author": {
        "id": 1370589
      },
      "writtenOn": "2019-11-08T04:41:25Z",
      "side": 1,
      "message": "Added TODO. Because I use a lot of Poll like this in the test. I\u0027m going to fix it in a new CL.",
      "parentUuid": "7ca063ce_8d9a1f3e",
      "range": {
        "startLine": 214,
        "startChar": 10,
        "endLine": 214,
        "endChar": 13
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "788188f6_c5f53fcb",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 257,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2019-11-06T18:18:00Z",
      "side": 1,
      "message": "nit:\ndeclare 50 as constant with descriptive name. e.g:\n\nconst pixelCountThreshold \u003d 50   // or the name that you consider",
      "range": {
        "startLine": 257,
        "startChar": 43,
        "endLine": 257,
        "endChar": 45
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "393f4142_3068f37a",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 257,
      "author": {
        "id": 1370589
      },
      "writtenOn": "2019-11-07T03:44:16Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "788188f6_c5f53fcb",
      "range": {
        "startLine": 257,
        "startChar": 43,
        "endLine": 257,
        "endChar": 45
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "01574e9d_1d69433d",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 793,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2019-11-06T18:18:00Z",
      "side": 1,
      "message": "nit:\nconsider using the new tast.promisify. \ne.g:\n\nexpr :\u003d fmt.Sprintf(`tast.promisify(chrome.wallpaper.setWallpaper)({\n     \u0027url\u0027: ...\n     \u0027layout\u0027: ...\n     \u0027filename\u0027: ...\n)   // no need to pass the callback function.\n...\n\n\ninternals of tast.promisify:\nhttps://cs.corp.google.com/chromeos_public/src/platform/tast-tests/src/chromiumos/tast/local/chrome/extensions.go?q\u003dextensions.go\u0026sq\u003dpackage:%5Echromeos_(public%7Cinternal)\u0026dr\u0026l\u003d107",
      "range": {
        "startLine": 791,
        "startChar": 0,
        "endLine": 793,
        "endChar": 5
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "203c927f_eee70f19",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/companion_library.go",
        "patchSetId": 4
      },
      "lineNbr": 793,
      "author": {
        "id": 1370589
      },
      "writtenOn": "2019-11-07T03:44:16Z",
      "side": 1,
      "message": "Good teach. Done.",
      "parentUuid": "01574e9d_1d69433d",
      "range": {
        "startLine": 791,
        "startChar": 0,
        "endLine": 793,
        "endChar": 5
      },
      "revId": "34808412651fc484f0eb4936456db8f048b11e40",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}