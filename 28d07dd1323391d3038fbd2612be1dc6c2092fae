{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "0d084b01_45b59bbe",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2020-12-17T08:06:53Z",
      "side": 1,
      "message": "My main comment is for HWDeps.",
      "revId": "28d07dd1323391d3038fbd2612be1dc6c2092fae",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "02f4f3dc_beb929a1",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/hal3/hal3_test_config.go",
        "patchSetId": 3
      },
      "lineNbr": 43,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2020-12-17T08:06:53Z",
      "side": 1,
      "message": "nit/style:\n\nconst zslGtestFilter \u003d ...",
      "revId": "28d07dd1323391d3038fbd2612be1dc6c2092fae",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "082c7d80_48843bfe",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/hal3/hal3_test_config.go",
        "patchSetId": 3
      },
      "lineNbr": 43,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2020-12-17T09:29:09Z",
      "side": 1,
      "message": "Removed. Thanks for the notice above!",
      "parentUuid": "02f4f3dc_beb929a1",
      "revId": "28d07dd1323391d3038fbd2612be1dc6c2092fae",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "31b1ddc4_2f2d70ee",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/hal3/hal3_test_config.go",
        "patchSetId": 3
      },
      "lineNbr": 122,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2020-12-17T08:06:53Z",
      "side": 1,
      "message": "nit: this can be simpler.\n\n\"Camera3StillCaptureTest/*:-\" + zslGtestFilter",
      "range": {
        "startLine": 122,
        "startChar": 15,
        "endLine": 122,
        "endChar": 75
      },
      "revId": "28d07dd1323391d3038fbd2612be1dc6c2092fae",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3f8a8581_3ed1ca87",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/hal3/hal3_test_config.go",
        "patchSetId": 3
      },
      "lineNbr": 122,
      "author": {
        "id": 1143539
      },
      "writtenOn": "2020-12-17T09:15:04Z",
      "side": 1,
      "message": "No need to filter the ZSL test since we\u0027ll work on skipping the test on devices that do not support ZSL, right?",
      "parentUuid": "31b1ddc4_2f2d70ee",
      "range": {
        "startLine": 122,
        "startChar": 15,
        "endLine": 122,
        "endChar": 75
      },
      "revId": "28d07dd1323391d3038fbd2612be1dc6c2092fae",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1e689fa8_7d3fa16a",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/hal3/hal3_test_config.go",
        "patchSetId": 3
      },
      "lineNbr": 122,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2020-12-17T09:29:09Z",
      "side": 1,
      "message": "Removed as well. Thanks!",
      "parentUuid": "3f8a8581_3ed1ca87",
      "range": {
        "startLine": 122,
        "startChar": 15,
        "endLine": 122,
        "endChar": 75
      },
      "revId": "28d07dd1323391d3038fbd2612be1dc6c2092fae",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c3bc5287_37efbcb8",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/hal3/hal3_test_config.go",
        "patchSetId": 3
      },
      "lineNbr": 122,
      "author": {
        "id": 1318626
      },
      "writtenOn": "2020-12-17T10:15:52Z",
      "side": 1,
      "message": "Note that if removing this, it will test device-operated ZSL over vendor HAL library if it\u0027s supported.",
      "parentUuid": "1e689fa8_7d3fa16a",
      "range": {
        "startLine": 122,
        "startChar": 15,
        "endLine": 122,
        "endChar": 75
      },
      "revId": "28d07dd1323391d3038fbd2612be1dc6c2092fae",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "639092b9_467ee4d0",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/hal3_still_capture_zsl.go",
        "patchSetId": 3
      },
      "lineNbr": 25,
      "author": {
        "id": 1318626
      },
      "writtenOn": "2020-12-17T07:47:05Z",
      "side": 1,
      "message": "Can this run on every platform?",
      "revId": "28d07dd1323391d3038fbd2612be1dc6c2092fae",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9abc073c_f2ba6f72",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/hal3_still_capture_zsl.go",
        "patchSetId": 3
      },
      "lineNbr": 25,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2020-12-17T07:51:52Z",
      "side": 1,
      "message": "It should, but I think it\u0027s of little use for platforms that don\u0027t support it. To other platforms, \"CONTROL_ENABLE_ZSL\" is essentially a noop.\n\nOr do you mean every model in kukui?",
      "parentUuid": "639092b9_467ee4d0",
      "revId": "28d07dd1323391d3038fbd2612be1dc6c2092fae",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f36178b4_8e29a148",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/hal3_still_capture_zsl.go",
        "patchSetId": 3
      },
      "lineNbr": 25,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2020-12-17T08:06:53Z",
      "side": 1,
      "message": "It is not recommended to restrict the devices to run per Platform.\n1) Could you comment the reason why you need this?\n2) If some special HW feature on kukui is needed, could you start discussing with infra team to put it into their schema with filing a bug + add TODO to get rid of Platform here?",
      "parentUuid": "9abc073c_f2ba6f72",
      "revId": "28d07dd1323391d3038fbd2612be1dc6c2092fae",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1afb01c1_b2a762df",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/hal3_still_capture_zsl.go",
        "patchSetId": 3
      },
      "lineNbr": 25,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2020-12-17T08:44:19Z",
      "side": 1,
      "message": "Thanks for pointing that out. I wasn\u0027t aware this is discouraged.\nTo answer your first question, ZSL requires some advanced capabilities not present on most devices.\n\nTechnically all platforms should pass this test without an issue (but only a few devices will have ZSL turned on). The concern was from a lab resource perspective.\n\nI suppose the router I could instead take (thanks kamesan@ for talking to me offline about it): Determine in the capability in gtest (cros-camera-test) and skip the test if devices don\u0027t support that advanced capability.\nThis is currently being used by portrait mode test: https://source.chromium.org/chromiumos/chromiumos/codesearch/+/main:src/platform2/camera/camera3_test/camera3_frame_test.cc;l\u003d1893-1896;drc\u003d34d10525925863b7dddb3db830d45365b2d7e25a",
      "parentUuid": "f36178b4_8e29a148",
      "revId": "28d07dd1323391d3038fbd2612be1dc6c2092fae",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cb29f03e_6b360fe8",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/hal3_still_capture_zsl.go",
        "patchSetId": 3
      },
      "lineNbr": 25,
      "author": {
        "id": 1143539
      },
      "writtenOn": "2020-12-17T09:15:04Z",
      "side": 1,
      "message": "Agree. I think we can differentiate it by having ENABLE_ZSL set accordingly in the still capture template.",
      "parentUuid": "1afb01c1_b2a762df",
      "revId": "28d07dd1323391d3038fbd2612be1dc6c2092fae",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ceffd5fd_0e1af7f9",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/hal3_still_capture_zsl.go",
        "patchSetId": 3
      },
      "lineNbr": 25,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2020-12-17T09:29:09Z",
      "side": 1,
      "message": "IMO the simpler way to do this would be checking private reprocessing capability. All devices with private reprocessing will support ZSL either through our in-house solution in adapter or through vendor camera HAL.\n\nAnd actually MTK HAL doesn\u0027t put ENABLE_ZSL in the still capture template. We add it in VCD.\n\nI\u0027ve just made the changes so that this tast test is run on every platform, but skipped in gtest if the platform doesn\u0027t support private reprocessing. See: https://chromium-review.googlesource.com/c/chromiumos/platform2/+/2587120/9..10",
      "parentUuid": "cb29f03e_6b360fe8",
      "revId": "28d07dd1323391d3038fbd2612be1dc6c2092fae",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "250087ec_d055502b",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/hal3_still_capture_zsl.go",
        "patchSetId": 3
      },
      "lineNbr": 25,
      "author": {
        "id": 1143539
      },
      "writtenOn": "2020-12-17T09:39:56Z",
      "side": 1,
      "message": "I think we should skip the test on MTK HAL, while running the test over the service on kukui; so private reprocessing capability does not look like an optimal solution. Besides, CoachZ won\u0027t report private reprocessing capability. Why didn\u0027t we add ENABLE_ZSL in the ZSL helper?",
      "parentUuid": "ceffd5fd_0e1af7f9",
      "revId": "28d07dd1323391d3038fbd2612be1dc6c2092fae",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ecb1ed63_1d5888c8",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/hal3_still_capture_zsl.go",
        "patchSetId": 3
      },
      "lineNbr": 25,
      "author": {
        "id": 1285903
      },
      "writtenOn": "2020-12-17T14:30:22Z",
      "side": 1,
      "message": "Do you mean something like this?\nHAL3StillCapture: for all devices that don\u0027t support ZSL.\nHAL3StillCaptureZsl: the ZSL-variant for devices that support ZSL.\nBoth run the entire suite of Camera3StillCaptureTest.\n\nThen in gtest (cros-camera-test), we say\n```\nif (ShouldRunAgainstCrosCamera()) {\n   GTEST_SKIP();\n}\n```\n\n\u003e Why didn\u0027t we add ENABLE_ZSL in the ZSL helper?\n\nI think my understanding at the time was that ENABLE_ZSL should be explicitly added to the capture request.\nThis was from reading the testTakePictureZsl test here: https://cs.android.com/android/platform/superproject/+/master:cts/tests/camera/src/android/hardware/camera2/cts/StillCaptureTest.java;l\u003d225;drc\u003dfadf88db914f8d32ce7ce76e2d669361ceeeebeb\n\n```\n               CaptureRequest.Builder stillRequest \u003d\n                        mCamera.createCaptureRequest(CameraDevice.TEMPLATE_STILL_CAPTURE);\n                stillRequest.set(CaptureRequest.CONTROL_ENABLE_ZSL, true);\n```\n\nLet\u0027s have a short meeting next week to discuss this.",
      "parentUuid": "250087ec_d055502b",
      "revId": "28d07dd1323391d3038fbd2612be1dc6c2092fae",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "93260727_9602bc24",
        "filename": "src/chromiumos/tast/local/bundles/cros/camera/hal3_still_capture_zsl.go",
        "patchSetId": 3
      },
      "lineNbr": 25,
      "author": {
        "id": 1143539
      },
      "writtenOn": "2020-12-20T10:50:58Z",
      "side": 1,
      "message": "The ZSL helper adds ENABLE_ZSL in the still capture template when ZSL can be supported; then ZSL will be tested while testing over the service AND the platform supports ZSL.",
      "parentUuid": "ecb1ed63_1d5888c8",
      "revId": "28d07dd1323391d3038fbd2612be1dc6c2092fae",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}