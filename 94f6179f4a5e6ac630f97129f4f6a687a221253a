{
  "comments": [
    {
      "key": {
        "uuid": "3c9b9133_245ca41a",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/arc_networkd_up.go",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-01-09T07:38:09Z",
      "side": 1,
      "message": "it may make more sense for this to be in the \u0027arc\u0027 package, as it seems arc-specific",
      "revId": "94f6179f4a5e6ac630f97129f4f6a687a221253a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f19a87b0_44be9b03",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/arc_networkd_up.go",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-09T08:41:22Z",
      "side": 1,
      "message": "Agreed. I\u0027d recommend naming this test as arc.Networkd (no \"Up\" to make the name simpler). Or if our purpose is just to check the liveness of arc-network, you can modify platform.CheckProcesses test: see my comment below.",
      "parentUuid": "3c9b9133_245ca41a",
      "revId": "94f6179f4a5e6ac630f97129f4f6a687a221253a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "09da5653_69c22336",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/arc_networkd_up.go",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1307765
      },
      "writtenOn": "2019-01-10T00:08:34Z",
      "side": 1,
      "message": "Dan - That\u0027s reasonable, I wasn\u0027t entirely sure where to put this.\n\nShuhei - Thanks, I wasn\u0027t aware of this test. However, I\u0027d like to verify both the original and child processes are running. I could modify CheckProcesses to accommodate this if you prefer?",
      "parentUuid": "f19a87b0_44be9b03",
      "revId": "94f6179f4a5e6ac630f97129f4f6a687a221253a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "88988f60_8ada49e9",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/arc_networkd_up.go",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-10T09:04:45Z",
      "side": 1,
      "message": "Thanks for explanation!\n\nBut it sounds to me a bit fragile to check the shape of the process tree. For example, arc-networkd may run external commands (I guess it\u0027s not the case today, but we may want to do this in the future), then arc-networkd will fork and this test will break in a rare race condition, which is very hard to debug. Checking the status of the upstart job is a simple way to avoid such difficulties.\n\nIf you want to do more precise checking, I recommend testing what arc-networkd does, not how it does. What\u0027s the functionality of arc-networkd? (sorry I\u0027m not familiar with the deamon...)",
      "parentUuid": "09da5653_69c22336",
      "revId": "94f6179f4a5e6ac630f97129f4f6a687a221253a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f9c1df80_622eeb49",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/arc_networkd_up.go",
        "patchSetId": 2
      },
      "lineNbr": 1,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-09T08:41:22Z",
      "side": 1,
      "message": "huge nit: Happy new year, this is 2019 :)",
      "range": {
        "startLine": 1,
        "startChar": 13,
        "endLine": 1,
        "endChar": 17
      },
      "revId": "94f6179f4a5e6ac630f97129f4f6a687a221253a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8c134d24_74bee4c2",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/arc_networkd_up.go",
        "patchSetId": 2
      },
      "lineNbr": 21,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-01-09T07:38:09Z",
      "side": 1,
      "message": "please add an \"android\" dependency so that this test won\u0027t run (and fail) on non-arc systems\n\nhttp://go/tast-deps",
      "revId": "94f6179f4a5e6ac630f97129f4f6a687a221253a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c6ecf417_c9f68f67",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/arc_networkd_up.go",
        "patchSetId": 2
      },
      "lineNbr": 25,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-01-09T07:38:09Z",
      "side": 1,
      "message": "please nest this in your test function instead of declaring it in the outer scope (which is shared across all tests in the \u0027network\u0027 package)",
      "revId": "94f6179f4a5e6ac630f97129f4f6a687a221253a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "98ded100_62b049ea",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/arc_networkd_up.go",
        "patchSetId": 2
      },
      "lineNbr": 39,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-09T08:41:22Z",
      "side": 1,
      "message": "IIUC arc-network service starts after session login, so I believe this test won\u0027t pass if it\u0027s run in login screen. Could you add a code to login and enable ARC, just like arc.Boot:\nhttps://chromium.googlesource.com/chromiumos/platform/tast-tests/+/master/src/chromiumos/tast/local/bundles/cros/arc/boot.go",
      "range": {
        "startLine": 39,
        "startChar": 0,
        "endLine": 39,
        "endChar": 32
      },
      "revId": "94f6179f4a5e6ac630f97129f4f6a687a221253a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "59713d35_b0e6be87",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/arc_networkd_up.go",
        "patchSetId": 2
      },
      "lineNbr": 39,
      "author": {
        "id": 1307765
      },
      "writtenOn": "2019-01-10T00:08:34Z",
      "side": 1,
      "message": "This (and the other) tests are based on crrev/1401481 which changes how/when arc-networkd runs. Both process should be up and independent of login.",
      "parentUuid": "98ded100_62b049ea",
      "range": {
        "startLine": 39,
        "startChar": 0,
        "endLine": 39,
        "endChar": 32
      },
      "revId": "94f6179f4a5e6ac630f97129f4f6a687a221253a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a661b78d_ceaa2093",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/arc_networkd_up.go",
        "patchSetId": 2
      },
      "lineNbr": 46,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-01-09T07:38:09Z",
      "side": 1,
      "message": "please don\u0027t discard this error. all of these process-related functions may return errors if the process exits mid-test; i\u0027d recommend calling \u0027continue\u0027 to skip the process if that happens.",
      "revId": "94f6179f4a5e6ac630f97129f4f6a687a221253a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fea39a1a_279a8128",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/arc_networkd_up.go",
        "patchSetId": 2
      },
      "lineNbr": 51,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-01-09T15:13:30Z",
      "side": 1,
      "message": "style: the string returned by Cmdline contains the command itself. So, \"args\" may be slightly different. How about just cmd or cmdline?",
      "range": {
        "startLine": 51,
        "startChar": 3,
        "endLine": 51,
        "endChar": 7
      },
      "revId": "94f6179f4a5e6ac630f97129f4f6a687a221253a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4cb993d4_209712c6",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/arc_networkd_up.go",
        "patchSetId": 2
      },
      "lineNbr": 51,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-01-09T15:13:30Z",
      "side": 1,
      "message": "Instead of manually parsing at L81, could you use CmdlineSlice?",
      "range": {
        "startLine": 51,
        "startChar": 21,
        "endLine": 51,
        "endChar": 28
      },
      "revId": "94f6179f4a5e6ac630f97129f4f6a687a221253a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "897f2a94_584e18cb",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/arc_networkd_up.go",
        "patchSetId": 2
      },
      "lineNbr": 66,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-09T08:41:22Z",
      "side": 1,
      "message": "This is tricky and difficult to follow the logic. Please first ensure that exactly one of the two processes in pi has ppid \u003d\u003d 1, and assign the two process info to two named variables.",
      "range": {
        "startLine": 65,
        "startChar": 0,
        "endLine": 66,
        "endChar": 18
      },
      "revId": "94f6179f4a5e6ac630f97129f4f6a687a221253a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f30cb741_b39dc1fe",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/arc_networkd_up.go",
        "patchSetId": 2
      },
      "lineNbr": 68,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-01-09T07:38:09Z",
      "side": 1,
      "message": "what sort of regressions are you trying to catch by checking the process\u0027s args or user? it seems like this will just require someone to update this test whenever they want to modify the args.\n\nchecking that the process is running may be useful (for catching crashes), but i\u0027m not sure about the rest of it.",
      "revId": "94f6179f4a5e6ac630f97129f4f6a687a221253a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "62c83f85_75ae8bd7",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/arc_networkd_up.go",
        "patchSetId": 2
      },
      "lineNbr": 68,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-01-09T08:41:22Z",
      "side": 1,
      "message": "+1, the purpose of this test is not obvious. If we just want to make sure arc-network service is up, we can add it to platform.CheckProcesses:\nhttps://chromium.googlesource.com/chromiumos/platform/tast-tests/+/master/src/chromiumos/tast/local/bundles/cros/platform/check_processes.go\n\nNote that we need to call arc.Supported() to conditionally add arc-network to the process list to check.",
      "parentUuid": "f30cb741_b39dc1fe",
      "revId": "94f6179f4a5e6ac630f97129f4f6a687a221253a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "28c41c03_8d59a416",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/arc_networkd_up.go",
        "patchSetId": 2
      },
      "lineNbr": 69,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-01-09T15:13:30Z",
      "side": 1,
      "message": "Here and after, s.Error(), because those checks look independent, and it is still possible to check other conditions even one of them fails.\nWith the way, in case of failure, you can find more info which would help investigation and debugging.",
      "range": {
        "startLine": 69,
        "startChar": 6,
        "endLine": 69,
        "endChar": 11
      },
      "revId": "94f6179f4a5e6ac630f97129f4f6a687a221253a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e8d08826_319c44f9",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/arc_networkd_up.go",
        "patchSetId": 2
      },
      "lineNbr": 73,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-01-09T15:13:30Z",
      "side": 1,
      "message": "How about checking child user, too?",
      "range": {
        "startLine": 71,
        "startChar": 3,
        "endLine": 73,
        "endChar": 4
      },
      "revId": "94f6179f4a5e6ac630f97129f4f6a687a221253a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7c0058c5_54e998f7",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/arc_networkd_up.go",
        "patchSetId": 2
      },
      "lineNbr": 79,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-01-09T15:13:30Z",
      "side": 1,
      "message": "Nice to output both a.ppid and b.pid.",
      "range": {
        "startLine": 79,
        "startChar": 58,
        "endLine": 79,
        "endChar": 64
      },
      "revId": "94f6179f4a5e6ac630f97129f4f6a687a221253a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "14daf1cb_53600ff8",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/arc_networkd_up.go",
        "patchSetId": 2
      },
      "lineNbr": 86,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2019-01-09T15:13:30Z",
      "side": 1,
      "message": "1? Or, rather I\u0027d recommend to output whole command line.",
      "range": {
        "startLine": 86,
        "startChar": 80,
        "endLine": 86,
        "endChar": 81
      },
      "revId": "94f6179f4a5e6ac630f97129f4f6a687a221253a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}