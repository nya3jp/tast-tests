{
  "comments": [
    {
      "key": {
        "uuid": "d6fe4bc2_60c6143e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 18,
      "author": {
        "id": 1273510
      },
      "writtenOn": "2020-06-28T23:28:58Z",
      "side": 1,
      "message": "With some caveats. Involving Chrome\u0027s rendering pipeline might be somewhat problematic: if WebGL rendering happens to be broken in Chrome but lower level CrOS graphics is fine, we might end up blocking Chrome uprevs (which may or may not be desirable) since this test is in the commit queue.\n\nBased on the bug, it seems Ilja doesn\u0027t mind involving Chrome, so it\u0027s probably okay.\n\nOne might argue, however, that Chrome OS already uses GL to render its UI, so issuing WebGL commands might not exercise the lower level graphics stack much more and we do it only to get an image for which we have a reference.\n\nWe might alternatively consider taking a screenshot of something like one of the platform/drm-tests which use GL for rendering and bsdrm to page flip (which is aware of modifiers and AFAICT plumbs them with ADDFB2). But I\u0027d like to hear Ilja\u0027s thoughts on this.",
      "range": {
        "startLine": 17,
        "startChar": 41,
        "endLine": 18,
        "endChar": 7
      },
      "revId": "8cf46fb6aa958a513a3d981fdd8558751c7120ee",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "dc963d32_8cfb5ed3",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 21,
      "author": {
        "id": 1273510
      },
      "writtenOn": "2020-06-28T23:28:58Z",
      "side": 1,
      "message": "Could you also test on a krane/kukui? Just as a sanity check to make sure this works with rotated screens.",
      "range": {
        "startLine": 21,
        "startChar": 28,
        "endLine": 21,
        "endChar": 35
      },
      "revId": "8cf46fb6aa958a513a3d981fdd8558751c7120ee",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b017bc3c_9751ac36",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 21,
      "author": {
        "id": 1363554
      },
      "writtenOn": "2020-06-29T00:26:33Z",
      "side": 1,
      "message": "I unfortunately don\u0027t have any way to test on krane/kukui these days..  I\u0027d appreciate if someone else could.",
      "parentUuid": "dc963d32_8cfb5ed3",
      "range": {
        "startLine": 21,
        "startChar": 28,
        "endLine": 21,
        "endChar": 35
      },
      "revId": "8cf46fb6aa958a513a3d981fdd8558751c7120ee",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c6680efd_fcb1316c",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 21,
      "author": {
        "id": 1273510
      },
      "writtenOn": "2020-07-07T02:44:25Z",
      "side": 1,
      "message": "Ok, I tested on krane and it passes.",
      "parentUuid": "b017bc3c_9751ac36",
      "range": {
        "startLine": 21,
        "startChar": 28,
        "endLine": 21,
        "endChar": 35
      },
      "revId": "8cf46fb6aa958a513a3d981fdd8558751c7120ee",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9669e55e_b7ad590b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1273510
      },
      "writtenOn": "2020-07-07T02:44:25Z",
      "side": 1,
      "message": "Sorry for the delay. I don\u0027t have problems with this if other folks are okay depending on Chrome\u0027s WebGL stack.",
      "revId": "8cf46fb6aa958a513a3d981fdd8558751c7120ee",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9eb93402_9ccf59c9",
        "filename": "src/chromiumos/tast/local/bundles/cros/graphics/sanity.go",
        "patchSetId": 1
      },
      "lineNbr": 157,
      "author": {
        "id": 1273510
      },
      "writtenOn": "2020-06-28T23:28:58Z",
      "side": 1,
      "message": "You might want to consider starting Chrome with HW overlays disabled. That way, if that path gets broken in Chrome, it doesn\u0027t affect this test (and we\u0027re not really interested in testing HW overlays). This is done by starting Chrome with a specific command line argument. I think it\u0027s either --enable-hardware-overlays\u003d\"\" or --disable-hardware-overlays.\n\nYou should be able to test by appending --tint-gl-composited-content to the command line. If the content is red tinted, it means it didn\u0027t get promoted to an overlay.",
      "range": {
        "startLine": 157,
        "startChar": 19,
        "endLine": 157,
        "endChar": 22
      },
      "revId": "8cf46fb6aa958a513a3d981fdd8558751c7120ee",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4b0b34ff_8c1ca085",
        "filename": "src/chromiumos/tast/local/bundles/cros/graphics/sanity.go",
        "patchSetId": 1
      },
      "lineNbr": 157,
      "author": {
        "id": 1363554
      },
      "writtenOn": "2020-06-29T00:26:33Z",
      "side": 1,
      "message": "I\u0027m still learning my way around tast.. any hints about how to do this?",
      "parentUuid": "9eb93402_9ccf59c9",
      "range": {
        "startLine": 157,
        "startChar": 19,
        "endLine": 157,
        "endChar": 22
      },
      "revId": "8cf46fb6aa958a513a3d981fdd8558751c7120ee",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6666741f_1f766893",
        "filename": "src/chromiumos/tast/local/bundles/cros/graphics/sanity.go",
        "patchSetId": 1
      },
      "lineNbr": 157,
      "author": {
        "id": 1273510
      },
      "writtenOn": "2020-07-07T02:44:25Z",
      "side": 1,
      "message": "Yes, the following works:\n\ncr, err :\u003d chrome.New(ctx, chrome.ExtraArgs(\"--enable-hardware-overlays\u003d\\\"\\\"\"))",
      "parentUuid": "4b0b34ff_8c1ca085",
      "range": {
        "startLine": 157,
        "startChar": 19,
        "endLine": 157,
        "endChar": 22
      },
      "revId": "8cf46fb6aa958a513a3d981fdd8558751c7120ee",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2f3240b9_7712d98d",
        "filename": "src/chromiumos/tast/local/bundles/cros/graphics/sanity.go",
        "patchSetId": 1
      },
      "lineNbr": 195,
      "author": {
        "id": 1273510
      },
      "writtenOn": "2020-06-28T23:28:58Z",
      "side": 1,
      "message": "nit: Use periods to end the comments.",
      "range": {
        "startLine": 195,
        "startChar": 59,
        "endLine": 195,
        "endChar": 60
      },
      "revId": "8cf46fb6aa958a513a3d981fdd8558751c7120ee",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "073944f6_d32b710a",
        "filename": "src/chromiumos/tast/local/bundles/cros/graphics/sanity.go",
        "patchSetId": 1
      },
      "lineNbr": 207,
      "author": {
        "id": 1273510
      },
      "writtenOn": "2020-06-28T23:28:58Z",
      "side": 1,
      "message": "nit: Comment on why this Sleep is needed as Tast prefers polling for some condition as opposed to sleeping. I assume it\u0027s needed to wait for rendering to finish?",
      "range": {
        "startLine": 205,
        "startChar": 1,
        "endLine": 207,
        "endChar": 2
      },
      "revId": "8cf46fb6aa958a513a3d981fdd8558751c7120ee",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bcb9e661_460f3027",
        "filename": "src/chromiumos/tast/local/bundles/cros/graphics/sanity.go",
        "patchSetId": 1
      },
      "lineNbr": 207,
      "author": {
        "id": 1363554
      },
      "writtenOn": "2020-06-29T00:26:33Z",
      "side": 1,
      "message": "yeah, just to give sufficient time for the js/webgl to react to the input.. open to suggestions if there is a better way to accomplish that.",
      "parentUuid": "073944f6_d32b710a",
      "range": {
        "startLine": 205,
        "startChar": 1,
        "endLine": 207,
        "endChar": 2
      },
      "revId": "8cf46fb6aa958a513a3d981fdd8558751c7120ee",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9ae4c480_a052814c",
        "filename": "src/chromiumos/tast/local/bundles/cros/graphics/sanity.go",
        "patchSetId": 1
      },
      "lineNbr": 207,
      "author": {
        "id": 1273510
      },
      "writtenOn": "2020-07-07T02:44:25Z",
      "side": 1,
      "message": "I was about to say that maybe you could do gl.finish(), but I don\u0027t think this guarantees the content is on the screen.\n\nI guess another way is to not take a screenshot and instead do gl.readPixels() on the canvas and somehow read the pixels back from Go.\n\nOverall, sleeping is the simplest it seems. Just make sure to add a comment indicating why it\u0027s needed.",
      "parentUuid": "bcb9e661_460f3027",
      "range": {
        "startLine": 205,
        "startChar": 1,
        "endLine": 207,
        "endChar": 2
      },
      "revId": "8cf46fb6aa958a513a3d981fdd8558751c7120ee",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8a13ea6f_9c41248b",
        "filename": "src/chromiumos/tast/local/bundles/cros/graphics/sanity.go",
        "patchSetId": 1
      },
      "lineNbr": 209,
      "author": {
        "id": 1273510
      },
      "writtenOn": "2020-07-07T02:44:25Z",
      "side": 1,
      "message": "I noticed that this can capture the mouse cursor. If you look at the PNGs it saves, you can see a few dark pixels in the center of the circle. Since the images are scaled down, this doesn\u0027t make the fuzzy comparison fail, at least on the boards I tried.\n\nJust keep in mind that if it does fail, this might be a reason. We should be able to exclude the cursor plane in the screenshot tool though if this becomes a problem.",
      "range": {
        "startLine": 209,
        "startChar": 22,
        "endLine": 209,
        "endChar": 29
      },
      "revId": "8cf46fb6aa958a513a3d981fdd8558751c7120ee",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}