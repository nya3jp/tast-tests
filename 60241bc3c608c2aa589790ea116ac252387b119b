{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "f32beffe_94fbd3b8",
        "filename": "src/chromiumos/tast/local/bundles/cros/health/probe_display_info.go",
        "patchSetId": 1
      },
      "lineNbr": 38,
      "author": {
        "id": 1179631
      },
      "writtenOn": "2022-03-31T06:55:47Z",
      "side": 1,
      "message": "Is there no other way to do this? Nothing that you can poll / etc to wait for ui to initialize?",
      "revId": "60241bc3c608c2aa589790ea116ac252387b119b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3295e839_e05cb106",
        "filename": "src/chromiumos/tast/local/bundles/cros/health/probe_display_info.go",
        "patchSetId": 1
      },
      "lineNbr": 38,
      "author": {
        "id": 1366047
      },
      "writtenOn": "2022-03-31T07:04:43Z",
      "side": 1,
      "message": "1. ui service is in running state, so it\u0027s not a correct check point.\n2. `modetest` is the standard command line tool to query/interact with display, but it has same behavior. Besides, there is really a case that no CRTC info exist. So we can\u0027t rely on its output to determine whether the initialization is done or not.\n\nAs I said, both outputs are correct, we reflect the real information.\n\nLet me add graphics team members to see if there is any other approach.",
      "parentUuid": "f32beffe_94fbd3b8",
      "revId": "60241bc3c608c2aa589790ea116ac252387b119b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "474cbbdc_b35b43f8",
        "filename": "src/chromiumos/tast/local/bundles/cros/health/probe_display_info.go",
        "patchSetId": 1
      },
      "lineNbr": 38,
      "author": {
        "id": 1179631
      },
      "writtenOn": "2022-03-31T07:07:56Z",
      "side": 1,
      "message": "Does the case where no CRTC exists happen in this test? I guess this test runs on headless chromebooks so it would (?).\n\nIn any case, polling on CRTC info for 10 seconds (and not counting it as an error if nothing appears) or so is strictly better than an unconditional sleep. Or, you can try to detect if there is no internal display (there is code that does this in Tast iirc).",
      "parentUuid": "3295e839_e05cb106",
      "revId": "60241bc3c608c2aa589790ea116ac252387b119b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b428fee6_46408c82",
        "filename": "src/chromiumos/tast/local/bundles/cros/health/probe_display_info.go",
        "patchSetId": 1
      },
      "lineNbr": 38,
      "author": {
        "id": 1366047
      },
      "writtenOn": "2022-03-31T07:14:01Z",
      "side": 1,
      "message": "No, this is not the case. I leased a bob device and I think it really has an internal display. I also did a small experiment (http://b/225766968#comment10), it just needs a few seconds for initialization. After that, everything is fine.\n\nBTW, this tast test will check if there is an internal display or not. If there is no eDP, the test should pass without any error.",
      "parentUuid": "474cbbdc_b35b43f8",
      "revId": "60241bc3c608c2aa589790ea116ac252387b119b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f269c478_897b7992",
        "filename": "src/chromiumos/tast/local/bundles/cros/health/probe_display_info.go",
        "patchSetId": 1
      },
      "lineNbr": 38,
      "author": {
        "id": 1179631
      },
      "writtenOn": "2022-03-31T07:18:27Z",
      "side": 1,
      "message": "Not sure now if you need to handle the case where no CRTC will exist. You said here you do \u003e Besides, there is really a case that no CRTC info exist; but here that you don\u0027t \u003e No, this is not the case.\n\nIf you need to handle this case, polling on CRTC info for k seconds is better than an unconditional sleep. If you don\u0027t, then it\u0027s a complete solution I think. If there is no eDP and that should be a pass without error, you could just check that condition before this wait.\n\nAnyway, there might be a better solution than polling CRTC info so let\u0027s hear from others hey",
      "parentUuid": "b428fee6_46408c82",
      "revId": "60241bc3c608c2aa589790ea116ac252387b119b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e65b6381_1881bb13",
        "filename": "src/chromiumos/tast/local/bundles/cros/health/probe_display_info.go",
        "patchSetId": 1
      },
      "lineNbr": 38,
      "author": {
        "id": 1366047
      },
      "writtenOn": "2022-03-31T07:32:03Z",
      "side": 1,
      "message": "Sorry, let me make it more clear.\n\nTwo cases:\n1. There is really no CRTC info. It happens when it\u0027s hibernate/suspend.\n2. Short time period of no CRTC info after ui restart. This CL is trying to deal with this case.\n\nCase 1 is the reason that I think we can\u0027t check modetest until it\u0027s initialized.\n\nI hoped my understanding is correct, I\u0027m also not the expert of the whole graphics stack.",
      "parentUuid": "f269c478_897b7992",
      "revId": "60241bc3c608c2aa589790ea116ac252387b119b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4d46c2a1_4e31287c",
        "filename": "src/chromiumos/tast/local/bundles/cros/health/probe_display_info.go",
        "patchSetId": 1
      },
      "lineNbr": 38,
      "author": {
        "id": 1179631
      },
      "writtenOn": "2022-03-31T08:02:49Z",
      "side": 1,
      "message": "Yerp, so we can try to detect #1, or just poll for #2 and not fail because #1 can happen. If #1 is the minority case, it\u0027s better to do the poll on #2 than to sleep unconditionally.",
      "parentUuid": "e65b6381_1881bb13",
      "revId": "60241bc3c608c2aa589790ea116ac252387b119b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1dcb5c69_dc27533f",
        "filename": "src/chromiumos/tast/local/bundles/cros/health/probe_display_info.go",
        "patchSetId": 1
      },
      "lineNbr": 38,
      "author": {
        "id": 1366047
      },
      "writtenOn": "2022-03-31T08:05:28Z",
      "side": 1,
      "message": "Fair enough. So I guess polling for 3 to 5 seconds is acceptable?",
      "parentUuid": "4d46c2a1_4e31287c",
      "revId": "60241bc3c608c2aa589790ea116ac252387b119b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5f09cc11_e5fa4762",
        "filename": "src/chromiumos/tast/local/bundles/cros/health/probe_display_info.go",
        "patchSetId": 1
      },
      "lineNbr": 38,
      "author": {
        "id": 1179631
      },
      "writtenOn": "2022-03-31T08:08:58Z",
      "side": 1,
      "message": "If there\u0027s no better solution then it\u0027s better than unconditional sleep. I would poll for 10 or 20 seconds IMO.\n\nCan #1 be detected?",
      "parentUuid": "1dcb5c69_dc27533f",
      "revId": "60241bc3c608c2aa589790ea116ac252387b119b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "580325d9_f5cd40ad",
        "filename": "src/chromiumos/tast/local/bundles/cros/health/probe_display_info.go",
        "patchSetId": 1
      },
      "lineNbr": 38,
      "author": {
        "id": 1366047
      },
      "writtenOn": "2022-03-31T08:12:40Z",
      "side": 1,
      "message": "It just reports nothing, so I won\u0027t say we can detect it. We only make sure the output of cros_healthd are consistent with modetest in this case.",
      "parentUuid": "5f09cc11_e5fa4762",
      "revId": "60241bc3c608c2aa589790ea116ac252387b119b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}