{
  "comments": [
    {
      "key": {
        "uuid": "f4d5607b_242b51b5",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 19,
      "author": {
        "id": 1152319
      },
      "writtenOn": "2018-12-12T17:18:29Z",
      "side": 1,
      "message": "please also test on a board with TPM 2.0: reef, eve, fizz, bob, scarlet, etc - there cryptohomed behaves quite differently. \n\nit probably works, though is somewhat brittle: in 2.0 case, taking ownership blocks \"cryptohome --action\u003dstatus\", so you never see being_owned\u003dtrue, you only get response after the ownership is taken with owned\u003dtrue. and that may take a while, if pre-ownership was not completed (failure or is still running if the test is the first one after booting the board for the 1st time after powerwash/clearing the owner).\n\nif testexec.CommandContext(ctx, \"cryptohome\", \"--action\u003dstatus\") times out before that, you\u0027ll time out of checkTPMOwnedOrBeingOwned loop as well. what is the timeout for this command?",
      "range": {
        "startLine": 19,
        "startChar": 0,
        "endLine": 19,
        "endChar": 4
      },
      "revId": "8b3efed190190ef6fb1a358631e2d2f0a2c1b72f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1175f7c3_5db3b896",
        "filename": "src/chromiumos/tast/local/ready/ready.go",
        "patchSetId": 2
      },
      "lineNbr": 91,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2018-12-12T16:07:32Z",
      "side": 1,
      "message": "are there better repair instructions that i could print here? running the following and rebooting doesn\u0027t appear to be enough to get my caroline device out of the state that it\u0027s currently in:\n\n  crossystem clear_tpm_owner_request\u003d1\n  rm /home/chronos/.oobe_completed\n  rm /home/.shadow/.can_attempt_ownership\n  rm -rf /home/.shadow/low_entropy_creds/\n\ni\u0027m not even 100% sure that powerwashing will make --action\u003dtpm_take_ownership work on this device. :-/\n\n/var/log/messages is full of this, apparently repeated many times whenever cryptohome tries to talk to the TPM:\n\n  2018-12-12T08:02:44.312064-08:00 WARNING cryptohomed[1237]: TSS: Failed unix connect: /run/tcsd/tcsd.socket - No such file or directory\n  2018-12-12T08:02:44.312334-08:00 WARNING cryptohomed[1237]: TSS: Got a list of valid IPs\n  2018-12-12T08:02:44.312648-08:00 WARNING cryptohomed[1237]: TSS: Could not connect to machine: localhost\n  2018-12-12T08:02:44.312705-08:00 ERR cryptohomed[1237]: TSS: Could not connect to any machine in the list.\n  2018-12-12T08:02:44.312726-08:00 ERR cryptohomed[1237]: TSS: Failed to send packet",
      "revId": "8b3efed190190ef6fb1a358631e2d2f0a2c1b72f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7542e2f4_b5150c3a",
        "filename": "src/chromiumos/tast/local/ready/ready.go",
        "patchSetId": 2
      },
      "lineNbr": 91,
      "author": {
        "id": 1152319
      },
      "writtenOn": "2018-12-12T17:18:29Z",
      "side": 1,
      "message": "I\u0027d keep it simple: \"Consider powerwashing/clearing the owner for the DUT to repair it\".\nYes, powerwashing doesn\u0027t guarantee to fix it, if there\u0027s something really wrong with the device or the OS image (e.g. tcsd fails to start on it consistently, regardless of the state, as in this example).\n\nYou may also suggest recovering to a known good OS image if that doesn\u0027t help. \n\nA consistently failing part of the test that tries to take ownership may actually serve its main purpose and indicate that there\u0027s some real issue with the OS image running on the device since it can\u0027t even take ownership.",
      "parentUuid": "1175f7c3_5db3b896",
      "revId": "8b3efed190190ef6fb1a358631e2d2f0a2c1b72f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}