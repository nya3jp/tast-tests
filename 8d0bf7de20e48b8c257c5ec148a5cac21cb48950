{
  "comments": [
    {
      "key": {
        "uuid": "017e2c5f_eb7216a5",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 78,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2018-10-31T23:05:11Z",
      "side": 1,
      "message": "nit: just rename this to pattern or glob?",
      "range": {
        "startLine": 78,
        "startChar": 59,
        "endLine": 78,
        "endChar": 75
      },
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fed217ef_d2aa8d30",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 78,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2018-10-31T23:05:11Z",
      "side": 1,
      "message": "please always document ambiguous return values:\n\n  (numFiles int, discrdFound, keroomFound bool, err error)",
      "range": {
        "startLine": 78,
        "startChar": 85,
        "endLine": 78,
        "endChar": 107
      },
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6faee628_1faa6735",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 78,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2018-11-01T00:03:39Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "fed217ef_d2aa8d30",
      "range": {
        "startLine": 78,
        "startChar": 85,
        "endLine": 78,
        "endChar": 107
      },
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c3842bbf_875f86ec",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 78,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2018-11-01T00:03:39Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "017e2c5f_eb7216a5",
      "range": {
        "startLine": 78,
        "startChar": 59,
        "endLine": 78,
        "endChar": 75
      },
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "286757ba_68854c76",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 91,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2018-10-31T23:05:11Z",
      "side": 1,
      "message": "you won\u0027t need this declaration after naming the return values on L78",
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bcee4c6d_3e7c3525",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 91,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2018-11-01T00:03:39Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "286757ba_68854c76",
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d217f181_aee1ef38",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 110,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2018-10-31T23:05:11Z",
      "side": 1,
      "message": "i think that the convention that i\u0027ve seen is for other return values to be discarded when an error return value is non-nil. as such, i\u0027d recommend just using error to signal problems checking the files.\n\nin other words:\n\n  L81: return 0, false, false, errors.Wrapf(err, \"bad glob %v\", ...)\n  L85: return 0, false, false, nil\n  L95: return 0, false, false, err\n  L105: return filesCount, keroomFound, discrdFound, nil\n\nyou don\u0027t need to pass testing.State (or ctx, which is unused) into this function in that case, and i think that this function\u0027s contract is clearer: it checks the clip files and returns what it finds instead of containing test logic.",
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "37e4a2e4_018d0923",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 110,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2018-11-01T00:03:39Z",
      "side": 1,
      "message": "The problem with this approach is that there are lots of different errors: no files, missing keroom, missing discrd, missing both.  I guess that I can deal with three combinations, but in general this wouldn\u0027t work well.\n\nAlso some errors should really be fatal: if I can\u0027t glob the directory, something weird is going on and I shouldn\u0027t keep trying.\n\nThe callback should probably have a way of differentiating three outcomes: exit loop with no errors, retry, exit immediately with error.  But you only have error type or nil.",
      "parentUuid": "d217f181_aee1ef38",
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5b4a4816_95950348",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 110,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2018-11-01T00:21:11Z",
      "side": 1,
      "message": "filepath.Glob can only fail if you give it a bad pattern, which you aren\u0027t doing, so i\u0027m actually fine with you just calling panic(fmt.Sprintf(\"glob failed: %v\", err)) if you get a failure there. :-P\n\nmy main point was that you\u0027re already passing back all of the state that you need to choose between those different outcomes (num files, missing events), so it feels cleaner to me to keep the logic for breaking out of the testing.Poll loop down in the function that you pass to testing.Poll instead of putting it up here.\n\nre error reporting: you can create your own error types or return an enum instead, but it feels like it\u0027s probably overkill in this situation (and per above, i think it\u0027s clearer to keep all of the polling control-flow logic in one place).",
      "parentUuid": "37e4a2e4_018d0923",
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d8c46a34_89a41680",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 110,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2018-11-01T01:00:53Z",
      "side": 1,
      "message": "OK---I am taking \"I\u0027m actually fine\" to mean that I can also leave this as is.",
      "parentUuid": "5b4a4816_95950348",
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "be092018_9f654570",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 126,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2018-10-31T23:05:11Z",
      "side": 1,
      "message": "nit: Could",
      "range": {
        "startLine": 126,
        "startChar": 11,
        "endLine": 126,
        "endChar": 16
      },
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ad1e56cb_addfeccb",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 126,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2018-11-01T00:03:39Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "be092018_9f654570",
      "range": {
        "startLine": 126,
        "startChar": 11,
        "endLine": 126,
        "endChar": 16
      },
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4f032596_bd6df650",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 174,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2018-10-31T23:05:11Z",
      "side": 1,
      "message": "please log before sleeping so it\u0027s clear why the test is hanging:\n\n  s.Log(\"Waiting for memd to notice change\")",
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3b87578d_e925a054",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 174,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2018-11-01T00:03:39Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "4f032596_bd6df650",
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3deccf72_1a6e91cc",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 177,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2018-10-31T23:05:11Z",
      "side": 1,
      "message": "please use this instead:\n\n  select {\n  case \u003c-time.After(3*time.Second):\n  case \u003c-ctx.Done():\n      s.Fatal(\"Failed waiting for memd: \", ctx.Err())\n  }",
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2155f1f0_2ccb53aa",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 177,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2018-11-01T00:03:39Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3deccf72_1a6e91cc",
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "97d18d2a_f89a4630",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 194,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2018-10-31T23:05:11Z",
      "side": 1,
      "message": "you don\u0027t need this now that you improved the poll condition, no?",
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ab5b4a22_d4f3cbc5",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 194,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2018-11-01T00:03:39Z",
      "side": 1,
      "message": "Right, I guess I don\u0027t need it.  But might as well sleep for 5 seconds because almost surely nothing will happen earlier than that.",
      "parentUuid": "97d18d2a_f89a4630",
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "35fbe94d_9ff4a833",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 194,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2018-11-01T00:21:11Z",
      "side": 1,
      "message": "please poll in case something happens earlier. :-)\n\nalso: simpler code if you delete this, and i won\u0027t need to ask you to replace it with a five-line select statement so that you honor ctx\u0027s deadline. :-P",
      "parentUuid": "ab5b4a22_d4f3cbc5",
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4e1299bd_4aac2569",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 194,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2018-11-01T01:00:53Z",
      "side": 1,
      "message": "OK---although I\u0027ve already done that...",
      "parentUuid": "35fbe94d_9ff4a833",
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6c96d68b_aa55abce",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 194,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2018-11-01T01:09:35Z",
      "side": 1,
      "message": "i meant remove this and just depend on the testing.Poll call on L201 to wait. feel free to increase its timeout to 12 seconds or whatever if needed",
      "parentUuid": "4e1299bd_4aac2569",
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a04a544e_46bcdcfe",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 201,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2018-10-31T23:05:11Z",
      "side": 1,
      "message": "please log before polling here too so someone watching the logs knows what\u0027s happening:\n\n  s.Log(\"Waiting for memd to write clip file\")\n\nhttps://chromium.googlesource.com/chromiumos/platform/tast/+/HEAD/docs/writing_tests.md#When-to-log",
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c61f3f0c_f2bf8525",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 201,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2018-11-01T00:03:39Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a04a544e_46bcdcfe",
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4e4d3935_77b595be",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 204,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2018-10-31T23:05:11Z",
      "side": 1,
      "message": "this would then be:\n\n  if err !\u003d nil {\n      return err\n  }\n  if !discrdFound || !keroomFound {\n      return errors.New(\"missing events\")\n  }\n  return nil",
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "09c42eb2_afb454f6",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 204,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2018-11-01T00:03:39Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "4e4d3935_77b595be",
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "af642089_8420af8f",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 212,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2018-10-31T23:05:11Z",
      "side": 1,
      "message": "move this condition and the next into an else block? you\u0027ll never have events if there weren\u0027t any files, so these errors are redundant in that case",
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "014592e0_eec0cfa5",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 212,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2018-11-01T00:03:39Z",
      "side": 1,
      "message": "But s.Fatal does not return, does it?  In any case this is changed.",
      "parentUuid": "af642089_8420af8f",
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3e011b5a_c67cfe82",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memd.go",
        "patchSetId": 9
      },
      "lineNbr": 212,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2018-11-01T00:21:11Z",
      "side": 1,
      "message": "whoops, indeed. sorry, missed that the above one was Fatal rather than Error!",
      "parentUuid": "014592e0_eec0cfa5",
      "revId": "8d0bf7de20e48b8c257c5ec148a5cac21cb48950",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}