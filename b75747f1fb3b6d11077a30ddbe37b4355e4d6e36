{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "711e0dfd_ecc30765",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1445297
      },
      "writtenOn": "2021-05-26T20:35:47Z",
      "side": 1,
      "message": "The test is now moved to a separate file.\nPlease review.",
      "revId": "b75747f1fb3b6d11077a30ddbe37b4355e4d6e36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8ad485ba_484dfa37",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_cont_netperf.go",
        "patchSetId": 2
      },
      "lineNbr": 62,
      "author": {
        "id": 1243287
      },
      "writtenOn": "2021-06-05T00:26:26Z",
      "side": 1,
      "message": "My concern with this is kind of in the same vein as the ping test: this threshold doesn\u0027t really mean anything and depends on the duration of the netperf stream. Is there some kind of absolute value we can use instead (similar to ping packet loss)? Maybe TransactionErrors?",
      "range": {
        "startLine": 62,
        "startChar": 77,
        "endLine": 62,
        "endChar": 80
      },
      "revId": "b75747f1fb3b6d11077a30ddbe37b4355e4d6e36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5f006ee1_2557aaae",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_cont_netperf.go",
        "patchSetId": 2
      },
      "lineNbr": 62,
      "author": {
        "id": 1445297
      },
      "writtenOn": "2021-06-09T22:23:37Z",
      "side": 1,
      "message": "Unfortunately, for TCP Stream/Maerts test, neperf shows only throughput metric. I also can\u0027t find any errors in interface counters.\n\nThis is not as bad, because now that we got rid of scanning we\u0027re doing only roaming in the loop. For 50 roaming rounds, we have ~10 iterations of netperf, thus the impact of measurement\u0027s tail (when we\u0027re running netperf and not roaming) would be minimal.\n\nWell, for 10 iterations, we could actually cut off the last iteration and still have enough of meaningful data.\n\nWhat worries me, is the general performance drop, which is even higher in download(maerts) case, than in the stream case.",
      "parentUuid": "8ad485ba_484dfa37",
      "range": {
        "startLine": 62,
        "startChar": 77,
        "endLine": 62,
        "endChar": 80
      },
      "revId": "b75747f1fb3b6d11077a30ddbe37b4355e4d6e36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "81d2c0e8_b02dafeb",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_cont_netperf.go",
        "patchSetId": 2
      },
      "lineNbr": 62,
      "author": {
        "id": 1243287
      },
      "writtenOn": "2021-06-10T00:27:40Z",
      "side": 1,
      "message": "I suppose if there\u0027s no alternative, this is fine as is.\n\n\u003e What worries me, is the general performance drop, which is even higher in download(maerts) case, than in the stream case.\n\nCan you paste some numbers here? Are you saying that the percentage throughput drop is more for the rx case than the tx case?",
      "parentUuid": "5f006ee1_2557aaae",
      "range": {
        "startLine": 62,
        "startChar": 77,
        "endLine": 62,
        "endChar": 80
      },
      "revId": "b75747f1fb3b6d11077a30ddbe37b4355e4d6e36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a28ebc3a_e2738044",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_cont_netperf.go",
        "patchSetId": 2
      },
      "lineNbr": 62,
      "author": {
        "id": 1445297
      },
      "writtenOn": "2021-06-11T16:00:22Z",
      "side": 1,
      "message": "RX case (FT PSK, Nami):\n2021-06-10T10:48:57.603897Z [10:48:57.603] Achieved starting throughput: 171.340000 Mbps\n[...]\n2021-06-10T10:51:01.565730Z [10:51:01.564] Stop Verification\n2021-06-10T10:51:01.565770Z [10:51:01.564] Iteration 1: End Time\u003d10:49:14.775, Throughput\u003d62.360000\n2021-06-10T10:51:01.565794Z [10:51:01.564] Iteration 2: End Time\u003d10:49:25.591, Throughput\u003d39.010000\n2021-06-10T10:51:01.565836Z [10:51:01.564] Iteration 3: End Time\u003d10:49:36.098, Throughput\u003d127.080000\n2021-06-10T10:51:01.565888Z [10:51:01.564] Iteration 4: End Time\u003d10:49:46.862, Throughput\u003d60.770000\n2021-06-10T10:51:01.565928Z [10:51:01.564] Iteration 5: End Time\u003d10:49:57.488, Throughput\u003d127.520000\n2021-06-10T10:51:01.565954Z [10:51:01.564] Iteration 6: End Time\u003d10:50:08.369, Throughput\u003d93.640000\n2021-06-10T10:51:01.565990Z [10:51:01.564] Iteration 7: End Time\u003d10:50:18.963, Throughput\u003d94.150000\n2021-06-10T10:51:01.566029Z [10:51:01.564] Iteration 8: End Time\u003d10:50:29.864, Throughput\u003d82.130000\n2021-06-10T10:51:01.566066Z [10:51:01.564] Iteration 9: End Time\u003d10:50:40.228, Throughput\u003d65.980000\n2021-06-10T10:51:01.566090Z [10:51:01.564] Iteration 10: End Time\u003d10:50:51.213, Throughput\u003d69.530000\n2021-06-10T10:51:01.566129Z [10:51:01.564] Iteration 11: End Time\u003d10:51:01.564, Throughput\u003d171.100000\n2021-06-10T10:51:01.566163Z [10:51:01.564] Average throughput 90.297273, threshold 68.536000\n\nTX Case:\n2021-06-10T10:59:24.776257Z [10:59:24.775] Achieved starting throughput: 192.100000 Mbps\n[...]\n2021-06-10T11:01:19.061550Z [11:01:19.060] Stop Verification\n2021-06-10T11:01:19.061723Z [11:01:19.060] Iteration 1: End Time\u003d10:59:42.167, Throughput\u003d132.360000\n2021-06-10T11:01:19.061775Z [11:01:19.060] Iteration 2: End Time\u003d10:59:53.071, Throughput\u003d130.310000\n2021-06-10T11:01:19.061801Z [11:01:19.060] Iteration 3: End Time\u003d11:00:03.888, Throughput\u003d147.690000\n2021-06-10T11:01:19.061818Z [11:01:19.060] Iteration 4: End Time\u003d11:00:15.082, Throughput\u003d138.490000\n2021-06-10T11:01:19.061842Z [11:01:19.060] Iteration 5: End Time\u003d11:00:25.831, Throughput\u003d153.920000\n2021-06-10T11:01:19.061864Z [11:01:19.061] Iteration 6: End Time\u003d11:00:36.397, Throughput\u003d134.500000\n2021-06-10T11:01:19.061905Z [11:01:19.061] Iteration 7: End Time\u003d11:00:47.007, Throughput\u003d123.560000\n2021-06-10T11:01:19.061921Z [11:01:19.061] Iteration 8: End Time\u003d11:00:57.667, Throughput\u003d140.050000\n2021-06-10T11:01:19.061952Z [11:01:19.061] Iteration 9: End Time\u003d11:01:08.427, Throughput\u003d138.250000\n2021-06-10T11:01:19.061969Z [11:01:19.061] Iteration 10: End Time\u003d11:01:19.060, Throughput\u003d140.550000\n2021-06-10T11:01:19.061993Z [11:01:19.061] Average throughput 137.968000, threshold 96.050000\n\nThus, average performance drop for RX case is ~50% with high jitter. For TX it\u0027s ~30%.\nLooking at the worst iteration, it\u0027s actually almost 80% of performance drop (39/171Mbps).\nOn Hatch, the numbers are similar (53% drop on RX)\nAverage throughput 81.474000, threshold 70.216000",
      "parentUuid": "81d2c0e8_b02dafeb",
      "range": {
        "startLine": 62,
        "startChar": 77,
        "endLine": 62,
        "endChar": 80
      },
      "revId": "b75747f1fb3b6d11077a30ddbe37b4355e4d6e36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ee5d86e2_df291272",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_cont_netperf.go",
        "patchSetId": 2
      },
      "lineNbr": 62,
      "author": {
        "id": 1243287
      },
      "writtenOn": "2021-06-16T17:08:56Z",
      "side": 1,
      "message": "Don\u0027t know if you have the hardware for this, but kglund@ has recently made a breakthrough of sorts regarding our wificell setup with netperf, and I suspect these changes may improve some of the numbers you see. If you don\u0027t have the hardware, maybe we can first try pushing some of those config changes to our current wificell setup in the lab and see if some of these numbers are improved. Kevin, have you tested this at all (e.g. not using the pcap as the netperf endpoint)?",
      "parentUuid": "a28ebc3a_e2738044",
      "range": {
        "startLine": 62,
        "startChar": 77,
        "endLine": 62,
        "endChar": 80
      },
      "revId": "b75747f1fb3b6d11077a30ddbe37b4355e4d6e36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "49175db8_ce60e10f",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_cont_netperf.go",
        "patchSetId": 2
      },
      "lineNbr": 62,
      "author": {
        "id": 1360284
      },
      "writtenOn": "2021-06-23T20:15:12Z",
      "side": 1,
      "message": "Mentioned in my design doc, but might as well repeat here: Unfortunately the router configuration improvements that I\u0027ve been working on lately seem to only be impactful when combined with the hardware change to using the pcap as a netperf endpoint. On that note, these tests should be running in the wificell_perf pool, which means that they should be using the adjusted setups once the changes have been made.\n\nIt would require a pretty big change to the testing logic, but would it be possible to adjust this test to use the 3-way setup as well? Or is that not reasonable with the need for roaming?",
      "parentUuid": "ee5d86e2_df291272",
      "range": {
        "startLine": 62,
        "startChar": 77,
        "endLine": 62,
        "endChar": 80
      },
      "revId": "b75747f1fb3b6d11077a30ddbe37b4355e4d6e36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "24382d38_c4d65dcf",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_cont_netperf.go",
        "patchSetId": 2
      },
      "lineNbr": 65,
      "author": {
        "id": 1243287
      },
      "writtenOn": "2021-06-05T00:26:26Z",
      "side": 1,
      "message": "EAP/none tests?",
      "revId": "b75747f1fb3b6d11077a30ddbe37b4355e4d6e36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b303f8b2_08f60f5d",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_cont_netperf.go",
        "patchSetId": 2
      },
      "lineNbr": 65,
      "author": {
        "id": 1445297
      },
      "writtenOn": "2021-06-09T22:23:37Z",
      "side": 1,
      "message": "OK, but combined with stream/maerts tests it grows suite to 10 testcases.",
      "parentUuid": "24382d38_c4d65dcf",
      "revId": "b75747f1fb3b6d11077a30ddbe37b4355e4d6e36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5b2ce734_53b7a5e9",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_cont_netperf.go",
        "patchSetId": 2
      },
      "lineNbr": 83,
      "author": {
        "id": 1243287
      },
      "writtenOn": "2021-06-05T00:26:26Z",
      "side": 1,
      "message": "same comment as previous change (use second return value)",
      "revId": "b75747f1fb3b6d11077a30ddbe37b4355e4d6e36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e30fb374_ae18bd0f",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_cont_netperf.go",
        "patchSetId": 2
      },
      "lineNbr": 83,
      "author": {
        "id": 1445297
      },
      "writtenOn": "2021-06-09T22:23:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5b2ce734_53b7a5e9",
      "revId": "b75747f1fb3b6d11077a30ddbe37b4355e4d6e36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a2b45315_4aba89f6",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_cont_netperf.go",
        "patchSetId": 2
      },
      "lineNbr": 122,
      "author": {
        "id": 1243287
      },
      "writtenOn": "2021-06-05T00:26:26Z",
      "side": 1,
      "message": "nit: Throughput",
      "range": {
        "startLine": 122,
        "startChar": 1,
        "endLine": 122,
        "endChar": 17
      },
      "revId": "b75747f1fb3b6d11077a30ddbe37b4355e4d6e36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fb5005dc_91346323",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/roam_cont_netperf.go",
        "patchSetId": 2
      },
      "lineNbr": 122,
      "author": {
        "id": 1445297
      },
      "writtenOn": "2021-06-09T22:23:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a2b45315_4aba89f6",
      "range": {
        "startLine": 122,
        "startChar": 1,
        "endLine": 122,
        "endChar": 17
      },
      "revId": "b75747f1fb3b6d11077a30ddbe37b4355e4d6e36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "38b938a0_72343b8d",
        "filename": "src/chromiumos/tast/remote/network/netperf/continuous_session.go",
        "patchSetId": 2
      },
      "lineNbr": 27,
      "author": {
        "id": 1243287
      },
      "writtenOn": "2021-06-05T00:26:26Z",
      "side": 1,
      "message": "I\u0027m not too familiar with the normal session code, but could we possibly just add an option to reuse the runner? Again, I don\u0027t know the code too well so if you say it makes more sense to add a new session type I\u0027ll take your word for it.",
      "revId": "b75747f1fb3b6d11077a30ddbe37b4355e4d6e36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2e04b35e_2efee647",
        "filename": "src/chromiumos/tast/remote/network/netperf/continuous_session.go",
        "patchSetId": 2
      },
      "lineNbr": 27,
      "author": {
        "id": 1445297
      },
      "writtenOn": "2021-06-09T22:23:37Z",
      "side": 1,
      "message": "The original netperf session (as ported from autotest) assumes different configs can be run, thus it created runner for each run (because some configs could require swaping server with client). Each runner creation wasted time on restarting netserver (which took ~5s so it was rather a no-go for us).\n\nHere I pass only one config during session creation, so I can reuse the runner.",
      "parentUuid": "38b938a0_72343b8d",
      "revId": "b75747f1fb3b6d11077a30ddbe37b4355e4d6e36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "23af1d60_f74fe402",
        "filename": "src/chromiumos/tast/remote/network/netperf/continuous_session.go",
        "patchSetId": 2
      },
      "lineNbr": 27,
      "author": {
        "id": 1243287
      },
      "writtenOn": "2021-06-10T00:27:40Z",
      "side": 1,
      "message": "Sorry, should have been more clear. I meant that it would be nice to reuse the original code and just add an option to reuse the runner as opposed to creating an entirely new session type and c\u0026p-ing code (in the warmup functions, for example). It\u0027s entirely possible that it\u0027s easier to do it the way you already did it, but I figure it\u0027s worth looking into.",
      "parentUuid": "2e04b35e_2efee647",
      "revId": "b75747f1fb3b6d11077a30ddbe37b4355e4d6e36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5a0d5dbe_5c42fd5e",
        "filename": "src/chromiumos/tast/remote/network/netperf/continuous_session.go",
        "patchSetId": 2
      },
      "lineNbr": 27,
      "author": {
        "id": 1445297
      },
      "writtenOn": "2021-06-11T16:00:22Z",
      "side": 1,
      "message": "Yes, the warmup part can be moved to a common place (e.g. runner).",
      "parentUuid": "23af1d60_f74fe402",
      "revId": "b75747f1fb3b6d11077a30ddbe37b4355e4d6e36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}