{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "4dab935b_21725669",
        "filename": "src/chromiumos/tast/local/bundles/cros/apps/webstore/webstore_app_helper.go",
        "patchSetId": 8
      },
      "lineNbr": 125,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2022-04-13T16:48:42Z",
      "side": 1,
      "message": "WaitForLocation(confirm) returns immediately when conform is available.\nI don\u0027t think it\u0027s what you\u0027re waiting for conceptually?",
      "range": {
        "startLine": 125,
        "startChar": 4,
        "endLine": 125,
        "endChar": 55
      },
      "revId": "5e73939ad11ba4520258ca5cfef23dcd0195f051",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "10464447_2caa1800",
        "filename": "src/chromiumos/tast/local/bundles/cros/apps/webstore/webstore_app_helper.go",
        "patchSetId": 8
      },
      "lineNbr": 125,
      "author": {
        "id": 1446889
      },
      "writtenOn": "2022-04-19T04:28:07Z",
      "side": 1,
      "message": "Here, we are checking whether tab is switched after clicking the install confirm button. If confirm button is not found which means another tab is opened, only then we are activating main tab.",
      "parentUuid": "4dab935b_21725669",
      "range": {
        "startLine": 125,
        "startChar": 4,
        "endLine": 125,
        "endChar": 55
      },
      "revId": "5e73939ad11ba4520258ca5cfef23dcd0195f051",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bc2a3d09_9a77117d",
        "filename": "src/chromiumos/tast/local/bundles/cros/apps/webstore/webstore_app_helper.go",
        "patchSetId": 8
      },
      "lineNbr": 125,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2022-04-20T12:57:55Z",
      "side": 1,
      "message": "So, if the switching delays for some reasons, this check passes, but soon after the tab is switching to the new tab? That sounds like a source of flakiness?\n\nAlso, which is the expected scenario? The tab switching should happen? Or should not?\nCould you avoid ambiguous story (covering both) here, unless there\u0027s no special reasons?",
      "parentUuid": "10464447_2caa1800",
      "range": {
        "startLine": 125,
        "startChar": 4,
        "endLine": 125,
        "endChar": 55
      },
      "revId": "5e73939ad11ba4520258ca5cfef23dcd0195f051",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "92780432_2d38aecc",
        "filename": "src/chromiumos/tast/local/bundles/cros/apps/webstore/webstore_app_helper.go",
        "patchSetId": 8
      },
      "lineNbr": 125,
      "author": {
        "id": 1366764
      },
      "writtenOn": "2022-04-25T11:02:52Z",
      "side": 1,
      "message": "The moment we click the \u0027confirm\u0027 button in the pop-up window, the button disappears and it takes some 3-5 seconds to install the Webstore app and the app gets opened in a new tab. Then we need to come back to the parent tab and check for the \u0027upgraded\u0027 text.\n\nEarlier we had a 5 seconds sleep before L125 but that is also a source of flakiness and hence we removed. Can you please suggest if we can include that 5 seconds sleep instead of L125 and then activate the main tab?",
      "parentUuid": "bc2a3d09_9a77117d",
      "range": {
        "startLine": 125,
        "startChar": 4,
        "endLine": 125,
        "endChar": 55
      },
      "revId": "5e73939ad11ba4520258ca5cfef23dcd0195f051",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6ab722ee_5befc66d",
        "filename": "src/chromiumos/tast/local/bundles/cros/apps/webstore/webstore_app_helper.go",
        "patchSetId": 8
      },
      "lineNbr": 125,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2022-04-25T15:10:02Z",
      "side": 1,
      "message": "If I understand your explanation correctly, the following is what you\u0027d like to see?\n\n  // Making sure confirmation dialog/button is displayed.\n  if err :\u003d ui.WaitUntilExists(confirm)(ctx); err !\u003d nil {\n    return ...\n  }\n  // Then click it.\n  if err :\u003d ui.DoDefault(confirm)(ctx); err !\u003d nil {\n    return ...\n  }\n  // Wait for the button gets gone.\n  if err :\u003d ui.WaitUntilGone(confrm)(ctx); err !\u003d nil {\n    return ...\n  }\n  // Here, the original tab should be focused back.\n  if a, err :\u003d tab.active(ctx); err !\u003d nil {\n    return ...\n  } else if !a {\n    return ...  // tab is not activated.\n  }\n  \n  // Check if the app is upgraded or not\n  if err :\u003d ui.WaitUntilExists(upgraded)(ctx); err !\u003d nil {\n    ...\n    \nwhere\n\n  func (t *tab) active(ctx context.Context) (bool, error) {\n    // call chrome.tabs.get() and return \"active\" property.\n  }\n\ncf) https://developer.chrome.com/docs/extensions/reference/tabs/#type-Tab",
      "parentUuid": "92780432_2d38aecc",
      "range": {
        "startLine": 125,
        "startChar": 4,
        "endLine": 125,
        "endChar": 55
      },
      "revId": "5e73939ad11ba4520258ca5cfef23dcd0195f051",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}