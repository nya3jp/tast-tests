{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "b8426052_fe06e793",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1305461
      },
      "writtenOn": "2021-12-13T20:03:13Z",
      "side": 1,
      "message": "+ tast-owners to take a look, so Ian can have a quicker review cycle when he gets back next year",
      "revId": "d124fe4a97e4aa4f1a1b117507cac23df9406845",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "602b23bb_9f2b33b7",
        "filename": "src/chromiumos/tast/local/bundles/cros/ui/chrome_crash_loop.go",
        "patchSetId": 2
      },
      "lineNbr": 113,
      "author": {
        "id": 1398801
      },
      "writtenOn": "2021-12-13T22:27:45Z",
      "side": 1,
      "message": "Please handle the err.",
      "range": {
        "startLine": 113,
        "startChar": 1,
        "endLine": 113,
        "endChar": 34
      },
      "revId": "d124fe4a97e4aa4f1a1b117507cac23df9406845",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c3cff65f_99bd3b15",
        "filename": "src/chromiumos/tast/local/bundles/cros/ui/chrome_crash_loop.go",
        "patchSetId": 2
      },
      "lineNbr": 113,
      "author": {
        "id": 1300299
      },
      "writtenOn": "2022-01-07T02:19:44Z",
      "side": 1,
      "message": "How you want me to handle it? As the comment says, the test shouldn\u0027t fail if the file doesn\u0027t exist, so I can\u0027t just fail the test if I get an error. fs.PathError doesn\u0027t give you a lot of easily-queryable information about what the exact nature of the error was -- the only thing it will reliably tell you is that the error was or was not a timeout, which isn\u0027t relevant here. I don\u0027t see a good way to distinguish \"file didn\u0027t exist\" (expected) from \"filename was a directory\" or \"didn\u0027t have permission to remove\" (bad).\n\nThat\u0027s why I\u0027m checking that the file could be removed on line 119 instead. os.Stat returns much more useful information.",
      "parentUuid": "602b23bb_9f2b33b7",
      "range": {
        "startLine": 113,
        "startChar": 1,
        "endLine": 113,
        "endChar": 34
      },
      "revId": "d124fe4a97e4aa4f1a1b117507cac23df9406845",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "03cebb32_d3e1a0a7",
        "filename": "src/chromiumos/tast/local/bundles/cros/ui/chrome_crash_loop.go",
        "patchSetId": 2
      },
      "lineNbr": 113,
      "author": {
        "id": 1398801
      },
      "writtenOn": "2022-01-10T03:49:39Z",
      "side": 1,
      "message": "I got a bit confused. The comment said \"Ensure success file isn\u0027t left over from previous test\" but it also said that it does not matter if it is there or not. So if it does not matter, why do we want to \"Ensure\"?",
      "parentUuid": "c3cff65f_99bd3b15",
      "range": {
        "startLine": 113,
        "startChar": 1,
        "endLine": 113,
        "endChar": 34
      },
      "revId": "d124fe4a97e4aa4f1a1b117507cac23df9406845",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "11308079_cb979324",
        "filename": "src/chromiumos/tast/local/bundles/cros/ui/chrome_crash_loop.go",
        "patchSetId": 2
      },
      "lineNbr": 113,
      "author": {
        "id": 1300299
      },
      "writtenOn": "2022-01-11T01:18:30Z",
      "side": 1,
      "message": "The normal state of the world is that the success file doesn\u0027t exist when the test starts. The crashes induced by the test cause crash_sender to create the file, which we then see down on line 155, and mark the test successful. At the end of the test, the defer\u0027ed os.Remove() removes the file, and we\u0027re back to the normal state of \"the success file doesn\u0027t exist\".\n\nIt is, however, possible that the file will exist when the test starts. For example, the DUT might have kernel panicked in the middle of a previous run of this test. Or someone might have run `crash_sender --test_mode` manually for some reason. In that case, we do want to remove the old, leftover success file so that we are starting the body of the test in the normal state (no success file). That\u0027s what I mean by \"Ensure\" -- let\u0027s ensure that we are in the normal, expected state of not having the success file yet. \n\nThe test should not fail in either case -- that\u0027s what I mean by \"doesn\u0027t matter\". If the file is not present at this moment, the test should not fail. If the file is present at this moment, the test should also not fail. The only case in which it should fail from this code is if the file already exists and we are unable to remove it -- in that case, we can\u0027t conduct the test.",
      "parentUuid": "03cebb32_d3e1a0a7",
      "range": {
        "startLine": 113,
        "startChar": 1,
        "endLine": 113,
        "endChar": 34
      },
      "revId": "d124fe4a97e4aa4f1a1b117507cac23df9406845",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2b9c977f_a59f3163",
        "filename": "src/chromiumos/tast/local/bundles/cros/ui/chrome_crash_loop.go",
        "patchSetId": 2
      },
      "lineNbr": 115,
      "author": {
        "id": 1398801
      },
      "writtenOn": "2021-12-13T22:27:45Z",
      "side": 1,
      "message": "This should go before os.Remove(testModeSuccessfulFile)",
      "range": {
        "startLine": 115,
        "startChar": 1,
        "endLine": 115,
        "endChar": 40
      },
      "revId": "d124fe4a97e4aa4f1a1b117507cac23df9406845",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b05063fa_d6811aa8",
        "filename": "src/chromiumos/tast/local/bundles/cros/ui/chrome_crash_loop.go",
        "patchSetId": 2
      },
      "lineNbr": 115,
      "author": {
        "id": 1300299
      },
      "writtenOn": "2022-01-07T02:19:44Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "2b9c977f_a59f3163",
      "range": {
        "startLine": 115,
        "startChar": 1,
        "endLine": 115,
        "endChar": 40
      },
      "revId": "d124fe4a97e4aa4f1a1b117507cac23df9406845",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "17393dab_02e29ded",
        "filename": "src/chromiumos/tast/local/bundles/cros/ui/chrome_crash_loop.go",
        "patchSetId": 2
      },
      "lineNbr": 119,
      "author": {
        "id": 1398801
      },
      "writtenOn": "2021-12-13T22:27:45Z",
      "side": 1,
      "message": "This would not fail the case?",
      "range": {
        "startLine": 119,
        "startChar": 4,
        "endLine": 119,
        "endChar": 9
      },
      "revId": "d124fe4a97e4aa4f1a1b117507cac23df9406845",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3ac520b0_5b63234c",
        "filename": "src/chromiumos/tast/local/bundles/cros/ui/chrome_crash_loop.go",
        "patchSetId": 2
      },
      "lineNbr": 119,
      "author": {
        "id": 1300299
      },
      "writtenOn": "2022-01-07T02:19:44Z",
      "side": 1,
      "message": "I don\u0027t understand what you are asking here, sorry. I want to make sure the test-successful file is removed before I start the real test, so that we don\u0027t get confused by leftovers from previous tests.",
      "parentUuid": "17393dab_02e29ded",
      "range": {
        "startLine": 119,
        "startChar": 4,
        "endLine": 119,
        "endChar": 9
      },
      "revId": "d124fe4a97e4aa4f1a1b117507cac23df9406845",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "97562321_2e046b69",
        "filename": "src/chromiumos/tast/local/bundles/cros/ui/chrome_crash_loop.go",
        "patchSetId": 2
      },
      "lineNbr": 119,
      "author": {
        "id": 1398801
      },
      "writtenOn": "2022-01-10T03:49:39Z",
      "side": 1,
      "message": "So here if it has not been removed, you want to fail the test case, which conflicts with previous code before.\n\nBTW, if you want to fail the test case here, why not using s.Fatal?",
      "parentUuid": "3ac520b0_5b63234c",
      "range": {
        "startLine": 119,
        "startChar": 4,
        "endLine": 119,
        "endChar": 9
      },
      "revId": "d124fe4a97e4aa4f1a1b117507cac23df9406845",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e512dba3_f6bbe3c4",
        "filename": "src/chromiumos/tast/local/bundles/cros/ui/chrome_crash_loop.go",
        "patchSetId": 2
      },
      "lineNbr": 119,
      "author": {
        "id": 1300299
      },
      "writtenOn": "2022-01-11T01:18:30Z",
      "side": 1,
      "message": "OK, I changed it to s.Fatal. Is that what you were suggesting?",
      "parentUuid": "97562321_2e046b69",
      "range": {
        "startLine": 119,
        "startChar": 4,
        "endLine": 119,
        "endChar": 9
      },
      "revId": "d124fe4a97e4aa4f1a1b117507cac23df9406845",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}