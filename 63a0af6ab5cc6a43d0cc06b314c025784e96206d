{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "e6ed439f_5d85eec1",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perfetto_wm_jankness.go",
        "patchSetId": 8
      },
      "lineNbr": 24,
      "author": {
        "id": 1163499
      },
      "writtenOn": "2022-09-16T04:33:33Z",
      "side": 1,
      "message": "nit: Please add \u0027arc-framework+tast@google.com\u0027 as well.",
      "range": {
        "startLine": 24,
        "startChar": 80,
        "endLine": 24,
        "endChar": 84
      },
      "revId": "63a0af6ab5cc6a43d0cc06b314c025784e96206d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "67604c20_f2d1ca94",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perfetto_wm_jankness.go",
        "patchSetId": 8
      },
      "lineNbr": 24,
      "author": {
        "id": 1553967
      },
      "writtenOn": "2022-09-16T05:52:16Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e6ed439f_5d85eec1",
      "range": {
        "startLine": 24,
        "startChar": 80,
        "endLine": 24,
        "endChar": 84
      },
      "revId": "63a0af6ab5cc6a43d0cc06b314c025784e96206d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2d46e78b_ffe10b68",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perfetto_wm_jankness.go",
        "patchSetId": 8
      },
      "lineNbr": 75,
      "author": {
        "id": 1163499
      },
      "writtenOn": "2022-09-16T04:33:33Z",
      "side": 1,
      "message": "nit: Let\u0027s use activity.SetWindowState() instead. It\u0027s easier to read and have better support for multiple ARC++ versions.\n```\nif _, err :\u003d act.SetWindowState(ctx, tconn, ash.WMEventMaximize); err !\u003d nil {\n  ...\n}\n```",
      "range": {
        "startLine": 75,
        "startChar": 14,
        "endLine": 75,
        "endChar": 39
      },
      "revId": "63a0af6ab5cc6a43d0cc06b314c025784e96206d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a6f2ee9e_4511a53e",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perfetto_wm_jankness.go",
        "patchSetId": 8
      },
      "lineNbr": 75,
      "author": {
        "id": 1553967
      },
      "writtenOn": "2022-09-16T05:52:16Z",
      "side": 1,
      "message": "Thank you! I added some changes, could you check it?",
      "parentUuid": "2d46e78b_ffe10b68",
      "range": {
        "startLine": 75,
        "startChar": 14,
        "endLine": 75,
        "endChar": 39
      },
      "revId": "63a0af6ab5cc6a43d0cc06b314c025784e96206d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ab4bfec5_e8b580d3",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perfetto_wm_jankness.go",
        "patchSetId": 8
      },
      "lineNbr": 80,
      "author": {
        "id": 1163499
      },
      "writtenOn": "2022-09-16T04:33:33Z",
      "side": 1,
      "message": "Using ash.WaitForARCAppWindowState() is probably more robust. Could you try that?\n```\nif err :\u003d ash.WaitForARCAppWindowState(ctx, tconn, act.PackageName(), ash.WMEventMaximize); err !\u003d nil {\n  ...\n}\n```",
      "range": {
        "startLine": 80,
        "startChar": 5,
        "endLine": 80,
        "endChar": 11
      },
      "revId": "63a0af6ab5cc6a43d0cc06b314c025784e96206d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "aec38a20_37af2d90",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perfetto_wm_jankness.go",
        "patchSetId": 8
      },
      "lineNbr": 80,
      "author": {
        "id": 1553967
      },
      "writtenOn": "2022-09-16T05:52:16Z",
      "side": 1,
      "message": "I added some changes, could you check it? Thank you!",
      "parentUuid": "ab4bfec5_e8b580d3",
      "range": {
        "startLine": 80,
        "startChar": 5,
        "endLine": 80,
        "endChar": 11
      },
      "revId": "63a0af6ab5cc6a43d0cc06b314c025784e96206d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "64c51d6b_de90ef70",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perfetto_wm_jankness.go",
        "patchSetId": 8
      },
      "lineNbr": 80,
      "author": {
        "id": 1510928
      },
      "writtenOn": "2022-09-16T06:01:44Z",
      "side": 1,
      "message": "I think here we use Sleep because we need wait until \"WM animation finish\". However there isn\u0027t a way to indicate it. ash.WaitForARCAppWindowState just wait the window state change finished in exo side, and not related with animation.\n\nSince we want to trace how many frames are jankness during animation, so here I prefer Sleep an enough time gap for make sure animation won\u0027t terminated before finished.\n\nWhat do you think? Thanks.",
      "parentUuid": "aec38a20_37af2d90",
      "range": {
        "startLine": 80,
        "startChar": 5,
        "endLine": 80,
        "endChar": 11
      },
      "revId": "63a0af6ab5cc6a43d0cc06b314c025784e96206d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b3b4ee94_d132830d",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perfetto_wm_jankness.go",
        "patchSetId": 8
      },
      "lineNbr": 80,
      "author": {
        "id": 1553967
      },
      "writtenOn": "2022-09-16T06:31:40Z",
      "side": 1,
      "message": "Thank you! So we need to sleep here to gather enough trace to see whether the frame is janky or not, is my understanding correct?",
      "parentUuid": "64c51d6b_de90ef70",
      "range": {
        "startLine": 80,
        "startChar": 5,
        "endLine": 80,
        "endChar": 11
      },
      "revId": "63a0af6ab5cc6a43d0cc06b314c025784e96206d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8e4ca037_ad45fa03",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perfetto_wm_jankness.go",
        "patchSetId": 8
      },
      "lineNbr": 80,
      "author": {
        "id": 1163499
      },
      "writtenOn": "2022-09-16T06:42:26Z",
      "side": 1,
      "message": "Good point. I re-checked the implementation of activity.SetWindowState().\nIt calls ash.SetWindowState() [1] with \u0027false\u0027 for waitForStateChange.\nSo, using ash.SetARCAppWindowStateAndWait()[2] is probably better in this case. Sorry for the confusion!\n\nI am not sure whether we can remove the sleep at all by using \u0027AndWait\u0027 variant or not. It waits for animation finished on Chrome side, so might not be suitable for this case.\n\n\n[1]: https://source.corp.google.com/chromeos_public/src/platform/tast-tests/src/chromiumos/tast/local/arc/activity.go;l\u003d876\n[2]: https://source.corp.google.com/chromeos_public/src/platform/tast-tests/src/chromiumos/tast/local/chrome/ash/wm.go;l\u003d313?q\u003dWaitForARCAppWindowState",
      "parentUuid": "b3b4ee94_d132830d",
      "range": {
        "startLine": 80,
        "startChar": 5,
        "endLine": 80,
        "endChar": 11
      },
      "revId": "63a0af6ab5cc6a43d0cc06b314c025784e96206d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b18ce9f1_e62f064d",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perfetto_wm_jankness.go",
        "patchSetId": 8
      },
      "lineNbr": 80,
      "author": {
        "id": 1510928
      },
      "writtenOn": "2022-09-16T07:06:00Z",
      "side": 1,
      "message": "Check that the animating tag in ash.SetARCAppWindowStateAndWait marked here [1]. Seems like it indicating if ui::LayerAnimator in animating. I\u0027m not sure if ARC animation use this Layer. Leave it to takise san.\n\n[1](https://source.chromium.org/chromium/chromium/src/+/main:chrome/browser/chromeos/extensions/autotest_private/autotest_private_api.cc;drc\u003dffbdfec17809781ad37c9fd1a5ee8dc3062c2767;l\u003d4397)",
      "parentUuid": "8e4ca037_ad45fa03",
      "range": {
        "startLine": 80,
        "startChar": 5,
        "endLine": 80,
        "endChar": 11
      },
      "revId": "63a0af6ab5cc6a43d0cc06b314c025784e96206d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7d3e3e85_d271bb85",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perfetto_wm_jankness.go",
        "patchSetId": 8
      },
      "lineNbr": 83,
      "author": {
        "id": 1163499
      },
      "writtenOn": "2022-09-16T04:33:33Z",
      "side": 1,
      "message": "ditto",
      "range": {
        "startLine": 83,
        "startChar": 32,
        "endLine": 83,
        "endChar": 40
      },
      "revId": "63a0af6ab5cc6a43d0cc06b314c025784e96206d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c418c4a5_5b6caa99",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perfetto_wm_jankness.go",
        "patchSetId": 8
      },
      "lineNbr": 87,
      "author": {
        "id": 1163499
      },
      "writtenOn": "2022-09-16T04:33:33Z",
      "side": 1,
      "message": "ditto",
      "range": {
        "startLine": 87,
        "startChar": 11,
        "endLine": 87,
        "endChar": 21
      },
      "revId": "63a0af6ab5cc6a43d0cc06b314c025784e96206d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}