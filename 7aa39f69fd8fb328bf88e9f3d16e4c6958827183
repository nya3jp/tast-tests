{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "89471f9f_d5ff1f37",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1260470
      },
      "writtenOn": "2022-11-03T15:51:34Z",
      "side": 1,
      "message": "Alexis, want to give this a review? If I don\u0027t hear anything in a couple days I can upgrade my +1 to a +2.",
      "revId": "7aa39f69fd8fb328bf88e9f3d16e4c6958827183",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "455bbcc9_68a81075",
        "filename": "src/chromiumos/tast/local/bundles/cros/hibernate/hiberman_dry_run.go",
        "patchSetId": 2
      },
      "lineNbr": 22,
      "author": {
        "id": 1260470
      },
      "writtenOn": "2022-11-03T15:51:34Z",
      "side": 1,
      "message": "This may be tight if the kernel is logging to serial or the hibervol is being created in this attempt (until Sarthak\u0027s provision primitives land we\u0027re zeroing the disk ourselves). If this is meant to be an \"if it takes this long it\u0027s just silly and is definitely stuck\" time, maybe 2 or 3 minutes is more appropriate.",
      "range": {
        "startLine": 22,
        "startChar": 23,
        "endLine": 22,
        "endChar": 25
      },
      "revId": "7aa39f69fd8fb328bf88e9f3d16e4c6958827183",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "cb87ceda_b594823c",
        "filename": "src/chromiumos/tast/local/bundles/cros/hibernate/hiberman_dry_run.go",
        "patchSetId": 2
      },
      "lineNbr": 22,
      "author": {
        "id": 1512414
      },
      "writtenOn": "2022-11-04T00:36:10Z",
      "side": 1,
      "message": "I will increase the time to 60 seconds for now.\nThe value of 15 seconds was selected based on my simplified tests on local DUT.",
      "parentUuid": "455bbcc9_68a81075",
      "range": {
        "startLine": 22,
        "startChar": 23,
        "endLine": 22,
        "endChar": 25
      },
      "revId": "7aa39f69fd8fb328bf88e9f3d16e4c6958827183",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5da51e09_00d42133",
        "filename": "src/chromiumos/tast/local/bundles/cros/hibernate/hiberman_dry_run.go",
        "patchSetId": 2
      },
      "lineNbr": 48,
      "author": {
        "id": 1163784
      },
      "writtenOn": "2022-11-03T18:19:31Z",
      "side": 1,
      "message": "Is it necessary to have the slice of strings when you are just using them by their index in the next line? You aren\u0027t having to list each cmd[i] but you have to list all of the args in the slice anyway. Ultimately probably a style choice and I am not a Go expert so I don\u0027t know if this is the preferred way.",
      "range": {
        "startLine": 47,
        "startChar": 1,
        "endLine": 48,
        "endChar": 58
      },
      "revId": "7aa39f69fd8fb328bf88e9f3d16e4c6958827183",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8be26a4a_868dc11a",
        "filename": "src/chromiumos/tast/local/bundles/cros/hibernate/hiberman_dry_run.go",
        "patchSetId": 2
      },
      "lineNbr": 48,
      "author": {
        "id": 1512414
      },
      "writtenOn": "2022-11-04T00:36:10Z",
      "side": 1,
      "message": "CommandContext(ctx, string, ...string)\nInitally I was just doing CommandContext(ctx, cmd...), but that (ctx, ...string)\nIt\u0027s quite messed up but I found that this is the pattern folks use inside tast Golang files (ref. https://source.corp.google.com/search?q\u003d%22CommandContext(ctx,%20cmd%22\u0026ss\u003dpiper%2FGoogle%2Fchromeos_public:src%2Fplatform%2F)",
      "parentUuid": "5da51e09_00d42133",
      "range": {
        "startLine": 47,
        "startChar": 1,
        "endLine": 48,
        "endChar": 58
      },
      "revId": "7aa39f69fd8fb328bf88e9f3d16e4c6958827183",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6120e319_97571007",
        "filename": "src/chromiumos/tast/local/bundles/cros/hibernate/hiberman_dry_run.go",
        "patchSetId": 2
      },
      "lineNbr": 54,
      "author": {
        "id": 1260470
      },
      "writtenOn": "2022-11-03T15:51:34Z",
      "side": 1,
      "message": "This is more of a broader comment, as I understand this to be fairly standard practice within ChromeOS, but I\u0027ve always found the idea of grepping for specific logs in the tests to be a bit sketchy. I guess if there were logs that were meant to be read by machines rather than humans, I\u0027d at least make them look more like machine logs, eg log(\"event:wrote_hibernate_image\"). That way a poor developer has a hint if they change or delete this log that a test is likely to break.\n\nWe currently have Alexis\u0027 metrics sprinkled throughout hiberman, which are a lot like machine readable logs. We could hook into that logic and have metrics get emitted somewhere the test could pick up in test mode (even if that just means printing them out to the main logger in a structured way). If the metrics we send out via telemetry don\u0027t cover all the cases we\u0027d want to track in tests, we could add test-specific events that go out this test-only channel but never make it to telemetry.\n\nI\u0027m not an expert in testing, so feel free to disagree and tell me this is what everyone is used to. But I thought I\u0027d throw this out to see if you had any thoughts.",
      "range": {
        "startLine": 54,
        "startChar": 22,
        "endLine": 54,
        "endChar": 26
      },
      "revId": "7aa39f69fd8fb328bf88e9f3d16e4c6958827183",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "97abe601_418f9562",
        "filename": "src/chromiumos/tast/local/bundles/cros/hibernate/hiberman_dry_run.go",
        "patchSetId": 2
      },
      "lineNbr": 54,
      "author": {
        "id": 1163784
      },
      "writtenOn": "2022-11-03T18:19:31Z",
      "side": 1,
      "message": "I agree that we might want to think about if there is a better way to figure out where we are in the hibernate path other than by grepping logs. The initial thought for adding the metrics was to hook into the logging logic by writing specific log lines that could be processed later, but ultimately we separated it out so it is utilizing similar logic but is being handled separately. Not sure what the best approach for tests is, and grepping the logs is probably fine to start with.",
      "parentUuid": "6120e319_97571007",
      "range": {
        "startLine": 54,
        "startChar": 22,
        "endLine": 54,
        "endChar": 26
      },
      "revId": "7aa39f69fd8fb328bf88e9f3d16e4c6958827183",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "de550b62_47465f7f",
        "filename": "src/chromiumos/tast/local/bundles/cros/hibernate/hiberman_dry_run.go",
        "patchSetId": 2
      },
      "lineNbr": 54,
      "author": {
        "id": 1512414
      },
      "writtenOn": "2022-11-04T00:37:32Z",
      "side": 1,
      "message": "I totally agree with using different logs than human readable.\nI\u0027ve added a comment to adapt our codebase to use some sort of enum or structure that will allow us to fetch the state in less fragile way.\nAdditionally, for tests that are not dry_run, I would ideally want to fetch the status from EC to ensure that we are reporting the status correctly.",
      "parentUuid": "97abe601_418f9562",
      "range": {
        "startLine": 54,
        "startChar": 22,
        "endLine": 54,
        "endChar": 26
      },
      "revId": "7aa39f69fd8fb328bf88e9f3d16e4c6958827183",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}