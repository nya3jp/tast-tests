{
  "comments": [
    {
      "key": {
        "uuid": "9ffb9be2_236b2330",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/p2p_server.go",
        "patchSetId": 4
      },
      "lineNbr": 45,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2020-04-24T02:07:53Z",
      "side": 1,
      "message": "Could you explain what you\u0027d like to do in the following scenarios?\n\n1) When the context actually expires during query.\n  1-1) What if some results are found.\n  1-2) What if no result is found.\n2) When the given timeout is non-positive value.\n\ndo you want to return an error? Or, success with empty result?\nIt looks a bit complicated to me. Could you mention what\u0027s the expected behavior in the document?",
      "revId": "52f9b51375d4ad1e552d3a3be98c76e193ca0bd9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1c2d135c_ff5d8c62",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/p2p_server.go",
        "patchSetId": 4
      },
      "lineNbr": 45,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2020-04-24T05:10:15Z",
      "side": 1,
      "message": "Thanks, your questions made me think more carefully about this function...\n\nTo answer your questions:\n\n1) We always want to return an error, regardless of whether we get responses or not.\n2) I don\u0027t have 100% preference, but in general I want to treat negative timeouts as the zero timeout.\n\nThis is because \"timeout\" is to allow some time to peer services to respond.\n\nAlso I noticed that this patchset does not support context cancellation (instead of context deadline).\n\nSo I decided to check ctx.Done() while reading responses.",
      "parentUuid": "9ffb9be2_236b2330",
      "revId": "52f9b51375d4ad1e552d3a3be98c76e193ca0bd9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9e52a3d2_6290db8c",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/p2p_server.go",
        "patchSetId": 4
      },
      "lineNbr": 45,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2020-04-24T15:32:56Z",
      "side": 1,
      "message": "\u003e 1) We always want to return an error, regardless of whether we get responses or not.\n\nBecause mdns.Query() blocks \"timeout\" duration always (unless it fails to start),\nif timeout is bigger than remaining ctx\u0027s timeout, it will be (almost) always return an error after ctx\u0027s timeout. (note, because of async implementation, I think there\u0027s some small amount of chance that it may return a list of found results, though. Anyways, it looks fragile behavior to me).\n\nIs it intentional behavior? \"Waiting timeout duration\" looks just redundant to me...?",
      "parentUuid": "1c2d135c_ff5d8c62",
      "revId": "52f9b51375d4ad1e552d3a3be98c76e193ca0bd9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}