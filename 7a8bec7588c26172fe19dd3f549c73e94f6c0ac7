{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "88d711c5_e9e07f81",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1386944
      },
      "writtenOn": "2021-01-28T06:56:43Z",
      "side": 1,
      "message": "Ready for review.\n\n@mwarton FYI on the change to the one crostini file, and the refactoring of the crostini part of the multi-VM precondition.",
      "revId": "7a8bec7588c26172fe19dd3f549c73e94f6c0ac7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6b4b1314_d61d8e33",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1386944
      },
      "writtenOn": "2021-01-28T06:57:26Z",
      "side": 1,
      "message": "This change is used in crrev.com/i/3566830.",
      "revId": "7a8bec7588c26172fe19dd3f549c73e94f6c0ac7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1980af7e_fa8041ba",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1368736
      },
      "writtenOn": "2021-01-28T08:50:02Z",
      "side": 1,
      "message": "Please pick a single reviewer for this change and the one using the new API. It\u0027s easier to follow.",
      "revId": "7a8bec7588c26172fe19dd3f549c73e94f6c0ac7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0810c0b5_d14f1f6e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1386944
      },
      "writtenOn": "2021-01-29T04:27:23Z",
      "side": 1,
      "message": "Done. I\u0027ve added you as reviewer to the corresponding CL on the internal side.",
      "parentUuid": "1980af7e_fa8041ba",
      "revId": "7a8bec7588c26172fe19dd3f549c73e94f6c0ac7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6f9cb509_f792b5e9",
        "filename": "src/chromiumos/tast/local/crostini/pre.go",
        "patchSetId": 2
      },
      "lineNbr": 125,
      "author": {
        "id": 1386944
      },
      "writtenOn": "2021-01-28T06:56:43Z",
      "side": 1,
      "message": "This change is required to allow hardware deps for different VMs to be combined. (Tast only allows hardware conditions to be readily combined, not the hwdeps constructed from them.)",
      "revId": "7a8bec7588c26172fe19dd3f549c73e94f6c0ac7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3568ff7c_2c03f301",
        "filename": "src/chromiumos/tast/local/crostini/pre.go",
        "patchSetId": 2
      },
      "lineNbr": 125,
      "author": {
        "id": 1368736
      },
      "writtenOn": "2021-01-28T08:50:02Z",
      "side": 1,
      "message": "Is this needed anywhere else? If not move this change to a different CL.",
      "parentUuid": "6f9cb509_f792b5e9",
      "revId": "7a8bec7588c26172fe19dd3f549c73e94f6c0ac7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b2ecab34_83c4406d",
        "filename": "src/chromiumos/tast/local/crostini/pre.go",
        "patchSetId": 2
      },
      "lineNbr": 125,
      "author": {
        "id": 1386944
      },
      "writtenOn": "2021-01-29T04:27:23Z",
      "side": 1,
      "message": "Yes, it is needed in the corresponding CL on the internal side, which this CL is setting up for: crrev.com/i/3566830.",
      "parentUuid": "3568ff7c_2c03f301",
      "revId": "7a8bec7588c26172fe19dd3f549c73e94f6c0ac7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fa57c73e_6bd482c4",
        "filename": "src/chromiumos/tast/local/multivm/state_manager.go",
        "patchSetId": 2
      },
      "lineNbr": 20,
      "author": {
        "id": 1368736
      },
      "writtenOn": "2021-01-28T08:50:02Z",
      "side": 1,
      "message": "Why was this made public? Move to a different CL if not needed for this iteration.",
      "range": {
        "startLine": 20,
        "startChar": 1,
        "endLine": 20,
        "endChar": 10
      },
      "revId": "7a8bec7588c26172fe19dd3f549c73e94f6c0ac7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "820847d8_0ee6d876",
        "filename": "src/chromiumos/tast/local/multivm/state_manager.go",
        "patchSetId": 2
      },
      "lineNbr": 20,
      "author": {
        "id": 1386944
      },
      "writtenOn": "2021-01-29T04:27:23Z",
      "side": 1,
      "message": "We need to be able to create these ChromeOptions in the internal bundle, so that we can define additional multi-vm preconditions with private VMs. See the corresponding CL on the internal side here: crrev.com/i/3566830.",
      "parentUuid": "fa57c73e_6bd482c4",
      "range": {
        "startLine": 20,
        "startChar": 1,
        "endLine": 20,
        "endChar": 10
      },
      "revId": "7a8bec7588c26172fe19dd3f549c73e94f6c0ac7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8bd6e3b2_93011c96",
        "filename": "src/chromiumos/tast/local/multivm/state_manager.go",
        "patchSetId": 2
      },
      "lineNbr": 24,
      "author": {
        "id": 1368736
      },
      "writtenOn": "2021-01-28T08:50:02Z",
      "side": 1,
      "message": "I don\u0027t see why this split between VMOptions and VMActivation is required. Add a comment or use a single interface for VMs.",
      "revId": "7a8bec7588c26172fe19dd3f549c73e94f6c0ac7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e76fdafb_cd8dc304",
        "filename": "src/chromiumos/tast/local/multivm/state_manager.go",
        "patchSetId": 2
      },
      "lineNbr": 24,
      "author": {
        "id": 1386944
      },
      "writtenOn": "2021-01-29T04:27:23Z",
      "side": 1,
      "message": "Comment added. It\u0027s mostly a design choice: the API structure forces correct usage of the API (i.e. must call Activate before Deactivate, Deactivate can only be called if Activate succeeds.) It also maintains a separation of the VM state from the (caller-provided) activation parameters, as was already true in the original state manager.",
      "parentUuid": "8bd6e3b2_93011c96",
      "revId": "7a8bec7588c26172fe19dd3f549c73e94f6c0ac7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4c73a645_013a4fc7",
        "filename": "src/chromiumos/tast/local/multivm/state_manager.go",
        "patchSetId": 2
      },
      "lineNbr": 24,
      "author": {
        "id": 1368736
      },
      "writtenOn": "2021-01-29T09:37:13Z",
      "side": 1,
      "message": "Ack.",
      "parentUuid": "e76fdafb_cd8dc304",
      "revId": "7a8bec7588c26172fe19dd3f549c73e94f6c0ac7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b3036e85_6c9ba596",
        "filename": "src/chromiumos/tast/local/multivm/state_manager.go",
        "patchSetId": 2
      },
      "lineNbr": 116,
      "author": {
        "id": 1368736
      },
      "writtenOn": "2021-01-28T08:50:02Z",
      "side": 1,
      "message": "Why not return an actual interface?",
      "range": {
        "startLine": 116,
        "startChar": 40,
        "endLine": 116,
        "endChar": 49
      },
      "revId": "7a8bec7588c26172fe19dd3f549c73e94f6c0ac7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "043e25d6_4b551a29",
        "filename": "src/chromiumos/tast/local/multivm/state_manager.go",
        "patchSetId": 2
      },
      "lineNbr": 116,
      "author": {
        "id": 1386944
      },
      "writtenOn": "2021-01-29T04:27:23Z",
      "side": 1,
      "message": "That would be nice. Unfortunately, as far as I\u0027m aware, there is no real consistency between arc, crostini and pita VM objects.",
      "parentUuid": "b3036e85_6c9ba596",
      "range": {
        "startLine": 116,
        "startChar": 40,
        "endLine": 116,
        "endChar": 49
      },
      "revId": "7a8bec7588c26172fe19dd3f549c73e94f6c0ac7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "103e493f_18a4f0dd",
        "filename": "src/chromiumos/tast/local/multivm/state_manager.go",
        "patchSetId": 2
      },
      "lineNbr": 116,
      "author": {
        "id": 1368736
      },
      "writtenOn": "2021-01-29T09:37:13Z",
      "side": 1,
      "message": "Can you add helpers to get the current VMs?",
      "parentUuid": "043e25d6_4b551a29",
      "range": {
        "startLine": 116,
        "startChar": 40,
        "endLine": 116,
        "endChar": 49
      },
      "revId": "7a8bec7588c26172fe19dd3f549c73e94f6c0ac7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5363b4e1_2caffebe",
        "filename": "src/chromiumos/tast/local/multivm/state_manager.go",
        "patchSetId": 2
      },
      "lineNbr": 116,
      "author": {
        "id": 1386944
      },
      "writtenOn": "2021-02-01T04:47:26Z",
      "side": 1,
      "message": "StateManager is not directly used from tests, but PreData (from pre.go) is and I\u0027ve added helper methods for it (see CrostiniFromPre, ARCFromPre).",
      "parentUuid": "103e493f_18a4f0dd",
      "range": {
        "startLine": 116,
        "startChar": 40,
        "endLine": 116,
        "endChar": 49
      },
      "revId": "7a8bec7588c26172fe19dd3f549c73e94f6c0ac7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a9b21d1d_7ea0c6ab",
        "filename": "src/chromiumos/tast/local/multivm/state_manager.go",
        "patchSetId": 2
      },
      "lineNbr": 163,
      "author": {
        "id": 1368736
      },
      "writtenOn": "2021-01-28T08:50:02Z",
      "side": 1,
      "message": "nit: This is not extensible. Save the required ExtraArgs and chrome options as part of vmOptions.",
      "revId": "7a8bec7588c26172fe19dd3f549c73e94f6c0ac7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "23771653_a55c14f4",
        "filename": "src/chromiumos/tast/local/multivm/state_manager.go",
        "patchSetId": 2
      },
      "lineNbr": 163,
      "author": {
        "id": 1386944
      },
      "writtenOn": "2021-01-29T04:27:23Z",
      "side": 1,
      "message": "Done. Originally, I was not sure how to fix this -- the logic here required certain options when ARC is _not_ present (i.e. chrome.ARCDisabled()), which is not something that could be fixed by simply asking all present VMs for their desired options. Looking at the implementation, disabled is already the default, so I can clean it up quite nicely.",
      "parentUuid": "a9b21d1d_7ea0c6ab",
      "revId": "7a8bec7588c26172fe19dd3f549c73e94f6c0ac7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "25c5339d_9269e100",
        "filename": "src/chromiumos/tast/local/multivm/state_manager.go",
        "patchSetId": 2
      },
      "lineNbr": 282,
      "author": {
        "id": 1368736
      },
      "writtenOn": "2021-01-28T08:50:02Z",
      "side": 1,
      "message": "nit: use the for inside a single defer, it\u0027s easier to reason about.",
      "revId": "7a8bec7588c26172fe19dd3f549c73e94f6c0ac7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "12a0dad5_f2bfeb55",
        "filename": "src/chromiumos/tast/local/multivm/state_manager.go",
        "patchSetId": 2
      },
      "lineNbr": 282,
      "author": {
        "id": 1386944
      },
      "writtenOn": "2021-01-29T04:27:23Z",
      "side": 1,
      "message": "I think this would change the semantics of the Deactivate implementation. Under the old approach, even if the cleanup of one VM panicked, the others would still be attempted. If I switch the for loop and the defer around, a panic in one cleanup would stop the other cleanups from running.\n\nSee comment on line 244:\n\t// NB: We deactivate in reverse order using defer so that if any one part\n\t// panics, the rest will still complete.",
      "parentUuid": "25c5339d_9269e100",
      "revId": "7a8bec7588c26172fe19dd3f549c73e94f6c0ac7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6270410f_23738d6c",
        "filename": "src/chromiumos/tast/local/multivm/state_manager.go",
        "patchSetId": 2
      },
      "lineNbr": 282,
      "author": {
        "id": 1368736
      },
      "writtenOn": "2021-01-29T09:37:13Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "12a0dad5_f2bfeb55",
      "revId": "7a8bec7588c26172fe19dd3f549c73e94f6c0ac7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}