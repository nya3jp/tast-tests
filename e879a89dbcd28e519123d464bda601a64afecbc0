{
  "comments": [
    {
      "key": {
        "uuid": "762f46e1_52be1719",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/link_monitor_failure.go",
        "patchSetId": 2
      },
      "lineNbr": 39,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2020-07-13T07:59:59Z",
      "side": 1,
      "message": "\"the test\"\n\nSame below.",
      "range": {
        "startLine": 39,
        "startChar": 28,
        "endLine": 39,
        "endChar": 32
      },
      "revId": "e879a89dbcd28e519123d464bda601a64afecbc0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b40b04c2_05837ebf",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/link_monitor_failure.go",
        "patchSetId": 2
      },
      "lineNbr": 39,
      "author": {
        "id": 1387481
      },
      "writtenOn": "2020-07-15T08:15:46Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "762f46e1_52be1719",
      "range": {
        "startLine": 39,
        "startChar": 28,
        "endLine": 39,
        "endChar": 32
      },
      "revId": "e879a89dbcd28e519123d464bda601a64afecbc0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f5578126_b9f375ec",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/link_monitor_failure.go",
        "patchSetId": 2
      },
      "lineNbr": 59,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2020-07-13T07:59:59Z",
      "side": 1,
      "message": "Refer to the \"when to log\" section [1], we can log message to inform developers what\u0027s happening when the upcoming task take some time to finish; otherwise, avoid logging unnecessary information.\n\nSo I think we can log:\n1. before line 37: \"Setting up the test fixture and AP\"\n2. here: \"Test fixture setup done; Connecting the DUT to the AP\"\n3. in line 73: \"WiFi connected; starting the test\" \n\n[1] https://chromium.googlesource.com/chromiumos/platform/tast/+/HEAD/docs/writing_tests.md#when-to-log",
      "revId": "e879a89dbcd28e519123d464bda601a64afecbc0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4c700444_53a84cbf",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/link_monitor_failure.go",
        "patchSetId": 2
      },
      "lineNbr": 59,
      "author": {
        "id": 1387481
      },
      "writtenOn": "2020-07-15T08:15:46Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f5578126_b9f375ec",
      "revId": "e879a89dbcd28e519123d464bda601a64afecbc0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6df2deb7_13a8a792",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/link_monitor_failure.go",
        "patchSetId": 2
      },
      "lineNbr": 88,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2020-07-13T07:59:59Z",
      "side": 1,
      "message": "the AP",
      "range": {
        "startLine": 88,
        "startChar": 48,
        "endLine": 88,
        "endChar": 50
      },
      "revId": "e879a89dbcd28e519123d464bda601a64afecbc0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "61533317_e5ee0493",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/link_monitor_failure.go",
        "patchSetId": 2
      },
      "lineNbr": 88,
      "author": {
        "id": 1387481
      },
      "writtenOn": "2020-07-15T08:15:46Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "6df2deb7_13a8a792",
      "range": {
        "startLine": 88,
        "startChar": 48,
        "endLine": 88,
        "endChar": 50
      },
      "revId": "e879a89dbcd28e519123d464bda601a64afecbc0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "cccaf2b4_00a746f0",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/link_monitor_failure.go",
        "patchSetId": 2
      },
      "lineNbr": 94,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-07-13T05:53:16Z",
      "side": 1,
      "message": "I guess you can poll for the check in L97 instead? So that we can save some time if the recovery uses less than the maximum timeout.",
      "range": {
        "startLine": 91,
        "startChar": 0,
        "endLine": 94,
        "endChar": 2
      },
      "revId": "e879a89dbcd28e519123d464bda601a64afecbc0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3f4615b9_807a0484",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/link_monitor_failure.go",
        "patchSetId": 2
      },
      "lineNbr": 94,
      "author": {
        "id": 1387481
      },
      "writtenOn": "2020-07-15T08:15:46Z",
      "side": 1,
      "message": "Done with polling a connected event. BTW, to avoid polling the events, do you think adding some signal-like util to EventLogger is good? For example, we may simply keep calling el.Wait(ctx) util it returns a connected event here.",
      "parentUuid": "cccaf2b4_00a746f0",
      "range": {
        "startLine": 91,
        "startChar": 0,
        "endLine": 94,
        "endChar": 2
      },
      "revId": "e879a89dbcd28e519123d464bda601a64afecbc0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f0ac1019_b7cf4b1e",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/link_monitor_failure.go",
        "patchSetId": 2
      },
      "lineNbr": 94,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-07-15T08:47:05Z",
      "side": 1,
      "message": "Sounds nice. It will be useful for some waiting case like this and I guess wifi.CSA might be suitable too. But I\u0027m not sure if it is possible to obtain both interface on the same object. (one concern: channel might block sender) If not, probably we can have the caller to spawn goroutine to buffer events. Or have a new object iw.EventWatcher and let EventLogger depend on it.\n\nProbably we can discuss the design and have another CL for this change.",
      "parentUuid": "3f4615b9_807a0484",
      "range": {
        "startLine": 91,
        "startChar": 0,
        "endLine": 94,
        "endChar": 2
      },
      "revId": "e879a89dbcd28e519123d464bda601a64afecbc0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d006fb11_293ae1f4",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/link_monitor_failure.go",
        "patchSetId": 2
      },
      "lineNbr": 98,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2020-07-13T08:03:14Z",
      "side": 1,
      "message": "Shall we poll for disconnect and reassociate event together as some drivers support direct reassociation?\nhttps://crbug.com/990012#c6",
      "revId": "e879a89dbcd28e519123d464bda601a64afecbc0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2058dd1c_c2741f04",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/link_monitor_failure.go",
        "patchSetId": 2
      },
      "lineNbr": 98,
      "author": {
        "id": 1387481
      },
      "writtenOn": "2020-07-15T08:15:46Z",
      "side": 1,
      "message": "I guess there is no reassociate event in this case? According to this comment, iw prints the connected event right after the scan event.\nhttps://crbug.com/990012#c4",
      "parentUuid": "d006fb11_293ae1f4",
      "revId": "e879a89dbcd28e519123d464bda601a64afecbc0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "26e75746_c7412c0b",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/link_monitor_failure.go",
        "patchSetId": 2
      },
      "lineNbr": 98,
      "author": {
        "id": 1001853
      },
      "writtenOn": "2020-07-20T06:11:39Z",
      "side": 1,
      "message": "I mean reassociateStart obtained in reassociateTime(). It can be either from the first scan event or from the first disconnect event just before the link is gone deliberately.\n\nShouldn\u0027t we obtain reassociateStart in a separate function and the value is used to calculate linkFailureTime and reassociateStart?\nlinkFailureTime \u003d reassociateStart - testStart\nreassociateStart \u003d connectedTime - reassociateStart",
      "parentUuid": "2058dd1c_c2741f04",
      "revId": "e879a89dbcd28e519123d464bda601a64afecbc0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "419b8193_8f2bf4ad",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/link_monitor_failure.go",
        "patchSetId": 2
      },
      "lineNbr": 101,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-07-13T05:53:16Z",
      "side": 1,
      "message": "The time on test runner and the time on DUT is combined here. IIRC, I think I see time difference around the order of a second between the logs on DUT and on test runner. [1]\n\nNot sure if it might be more accurate to get the startTime from DUT?\n\n[1] For example, wifi.SimpleConnect.80211acvht20 in https://stainless.corp.google.com/browse/chromeos-autotest-results/swarming-4d5ba80b39278510/ the connection log in log.txt and net.log have difference ~1 second.",
      "range": {
        "startLine": 101,
        "startChar": 21,
        "endLine": 101,
        "endChar": 62
      },
      "revId": "e879a89dbcd28e519123d464bda601a64afecbc0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7dc96f5d_6534a79e",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/link_monitor_failure.go",
        "patchSetId": 2
      },
      "lineNbr": 101,
      "author": {
        "id": 1387481
      },
      "writtenOn": "2020-07-15T08:15:46Z",
      "side": 1,
      "message": "Added a gRPC command: GetCurrentTime.",
      "parentUuid": "419b8193_8f2bf4ad",
      "range": {
        "startLine": 101,
        "startChar": 21,
        "endLine": 101,
        "endChar": 62
      },
      "revId": "e879a89dbcd28e519123d464bda601a64afecbc0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f06cec0c_f5894d12",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/link_monitor_failure.go",
        "patchSetId": 2
      },
      "lineNbr": 126,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-07-13T05:53:16Z",
      "side": 1,
      "message": "This is added in crrev.com/c/250840 which says the behavior is available after wpa_supplicant-2.3. I guess we don\u0027t have any model using wpa_supplicant that old, so probably we can consider dropping the code for the old behavior if there\u0027s really no scan event expected?",
      "range": {
        "startLine": 124,
        "startChar": 0,
        "endLine": 126,
        "endChar": 84
      },
      "revId": "e879a89dbcd28e519123d464bda601a64afecbc0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ec757729_6fe7d04e",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/link_monitor_failure.go",
        "patchSetId": 2
      },
      "lineNbr": 126,
      "author": {
        "id": 1387481
      },
      "writtenOn": "2020-07-15T08:15:46Z",
      "side": 1,
      "message": "I can still get the scan event before disconnect event on my DUT though wpa_supplicant-2.8 is installed, so let\u0027s leave the code for the old behavior here.",
      "parentUuid": "f06cec0c_f5894d12",
      "range": {
        "startLine": 124,
        "startChar": 0,
        "endLine": 126,
        "endChar": 84
      },
      "revId": "e879a89dbcd28e519123d464bda601a64afecbc0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "49d47226_b8125638",
        "filename": "src/chromiumos/tast/remote/bundles/cros/wifi/link_monitor_failure.go",
        "patchSetId": 2
      },
      "lineNbr": 126,
      "author": {
        "id": 1371981
      },
      "writtenOn": "2020-07-15T08:47:05Z",
      "side": 1,
      "message": "Then, this looks good to me for now. Might also worth investigating the behavior in current wpa_supplicant. (e.g. does it always send the scan or conditionally or ...)",
      "parentUuid": "ec757729_6fe7d04e",
      "range": {
        "startLine": 124,
        "startChar": 0,
        "endLine": 126,
        "endChar": 84
      },
      "revId": "e879a89dbcd28e519123d464bda601a64afecbc0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}