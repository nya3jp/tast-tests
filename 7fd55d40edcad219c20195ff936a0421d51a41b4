{
  "comments": [
    {
      "key": {
        "uuid": "63c70594_1fbb41d7",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/kernelmeter/kernelmeter.go",
        "patchSetId": 3
      },
      "lineNbr": 25,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-03-12T23:16:56Z",
      "side": 1,
      "message": "nit: runningSampler or samplerRunning seem clearer",
      "range": {
        "startLine": 25,
        "startChar": 1,
        "endLine": 25,
        "endChar": 11
      },
      "revId": "7fd55d40edcad219c20195ff936a0421d51a41b4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "495fc016_ad17d491",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/kernelmeter/kernelmeter.go",
        "patchSetId": 3
      },
      "lineNbr": 114,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-03-12T23:16:56Z",
      "side": 1,
      "message": "do you actually need the ability to control this? this makes the code harder for me to understand: now there are various members that conditionally initialized/relevant. more on next file...",
      "range": {
        "startLine": 114,
        "startChar": 30,
        "endLine": 114,
        "endChar": 40
      },
      "revId": "7fd55d40edcad219c20195ff936a0421d51a41b4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b3e51773_93f5f565",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/kernelmeter/kernelmeter.go",
        "patchSetId": 3
      },
      "lineNbr": 114,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-03-12T23:29:52Z",
      "side": 1,
      "message": "This is true, I was wondering myself.  The overhead of useless goroutines is probably pretty low.",
      "parentUuid": "495fc016_ad17d491",
      "range": {
        "startLine": 114,
        "startChar": 30,
        "endLine": 114,
        "endChar": 40
      },
      "revId": "7fd55d40edcad219c20195ff936a0421d51a41b4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a05b89d9_0f0b33a0",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memory_pressure.go",
        "patchSetId": 3
      },
      "lineNbr": 752,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-03-12T23:16:56Z",
      "side": 1,
      "message": "nit: \u0027f\u0027 is more common",
      "range": {
        "startLine": 752,
        "startChar": 45,
        "endLine": 752,
        "endChar": 53
      },
      "revId": "7fd55d40edcad219c20195ff936a0421d51a41b4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5df5a9e6_fad32a65",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memory_pressure.go",
        "patchSetId": 3
      },
      "lineNbr": 752,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-03-12T23:29:52Z",
      "side": 1,
      "message": "Cool, thanks.",
      "parentUuid": "a05b89d9_0f0b33a0",
      "range": {
        "startLine": 752,
        "startChar": 45,
        "endLine": 752,
        "endChar": 53
      },
      "revId": "7fd55d40edcad219c20195ff936a0421d51a41b4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6484c252_a1c56552",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memory_pressure.go",
        "patchSetId": 3
      },
      "lineNbr": 753,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-03-12T23:16:56Z",
      "side": 1,
      "message": "what about if you just instantiate a new meter in this function and then defer a close call? does letting the goroutine get started break anything?",
      "revId": "7fd55d40edcad219c20195ff936a0421d51a41b4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d7c6ebb9_e17f3ea2",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memory_pressure.go",
        "patchSetId": 3
      },
      "lineNbr": 753,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-03-12T23:29:52Z",
      "side": 1,
      "message": "That would work.  Also, these stats don\u0027t need a max rate, so they don\u0027t need a goroutine, but even if they did I don\u0027t think that would break anything.",
      "parentUuid": "6484c252_a1c56552",
      "revId": "7fd55d40edcad219c20195ff936a0421d51a41b4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3da21dcd_07754f4e",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memory_pressure.go",
        "patchSetId": 3
      },
      "lineNbr": 920,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2019-03-12T21:57:37Z",
      "side": 1,
      "message": "do we really want these stats for every tab or would it be enough to just log it at the end of phase 1?",
      "range": {
        "startLine": 920,
        "startChar": 2,
        "endLine": 920,
        "endChar": 43
      },
      "revId": "7fd55d40edcad219c20195ff936a0421d51a41b4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f58c7ec8_05002d86",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memory_pressure.go",
        "patchSetId": 3
      },
      "lineNbr": 920,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-03-12T23:29:52Z",
      "side": 1,
      "message": "I did it this way so that we can ensure that the preallocation doesn\u0027t do anything funky.  The preallocating processes run asynchronously, and depending on RAM size, their pages may be swapped out sooner or later, so it feels safer to keep track of the entire history of these quantities.",
      "parentUuid": "3da21dcd_07754f4e",
      "range": {
        "startLine": 920,
        "startChar": 2,
        "endLine": 920,
        "endChar": 43
      },
      "revId": "7fd55d40edcad219c20195ff936a0421d51a41b4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "296c434e_d0d69119",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memory_pressure.go",
        "patchSetId": 3
      },
      "lineNbr": 920,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2019-03-12T23:31:44Z",
      "side": 1,
      "message": "I don\u0027t understand how logging for every tab will tell us if preallocation is affecting anything?",
      "parentUuid": "f58c7ec8_05002d86",
      "range": {
        "startLine": 920,
        "startChar": 2,
        "endLine": 920,
        "endChar": 43
      },
      "revId": "7fd55d40edcad219c20195ff936a0421d51a41b4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "76be03e6_b2381eaa",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memory_pressure.go",
        "patchSetId": 3
      },
      "lineNbr": 920,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2019-03-12T23:55:28Z",
      "side": 1,
      "message": "Just to add to this -- I think if we recorded this once before phase 1 we would get an idea if the compression ratio of preallocated pages was off, even though not everything got compressed.  So I\u0027ll propose we do it once before phase 1 (to address the concern about preallocation being ineffective) and once after phase 1.",
      "parentUuid": "296c434e_d0d69119",
      "range": {
        "startLine": 920,
        "startChar": 2,
        "endLine": 920,
        "endChar": 43
      },
      "revId": "7fd55d40edcad219c20195ff936a0421d51a41b4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5fc62d6b_7ee2e262",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memory_pressure.go",
        "patchSetId": 3
      },
      "lineNbr": 920,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-03-13T00:08:34Z",
      "side": 1,
      "message": "The test starts preallocating processes in the background.  They might start swapping out soon after that, or wait until there\u0027s pressure from opening tabs.  Either way, logging zram stats at the beginning of the test will tell us nothing.\n\nOn a cyan this adds less than 20 lines on a total of about 450 lines.\n\nYou know what, I am taking it out.  I\u0027ll log once after opening the initial set, and once at the end.  With some luck there will be some swap after the initial set.  We\u0027ll figure out if we need more logging.",
      "parentUuid": "76be03e6_b2381eaa",
      "range": {
        "startLine": 920,
        "startChar": 2,
        "endLine": 920,
        "endChar": 43
      },
      "revId": "7fd55d40edcad219c20195ff936a0421d51a41b4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "93d544bf_e84ac156",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memory_pressure.go",
        "patchSetId": 3
      },
      "lineNbr": 920,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2019-03-13T00:14:27Z",
      "side": 1,
      "message": "I\u0027m actually trying it to see how it feels, and it\u0027s actually not that bad.  It\u0027s interesting to see how much extra swap gets used at every tab.  I didn\u0027t understand that there wasn\u0027t any time between when the preallocation started and phase 1.  I\u0027ll retract my objection based on those two pieces of information.",
      "parentUuid": "5fc62d6b_7ee2e262",
      "range": {
        "startLine": 920,
        "startChar": 2,
        "endLine": 920,
        "endChar": 43
      },
      "revId": "7fd55d40edcad219c20195ff936a0421d51a41b4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c853e33a_e083ab23",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memory_pressure.go",
        "patchSetId": 3
      },
      "lineNbr": 921,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2019-03-12T21:57:37Z",
      "side": 1,
      "message": "if we don\u0027t have zram, just skip logging -- If we run without zram we\u0027ll just end up having this repeating a lot in the log.",
      "range": {
        "startLine": 921,
        "startChar": 3,
        "endLine": 921,
        "endChar": 34
      },
      "revId": "7fd55d40edcad219c20195ff936a0421d51a41b4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "faa6c5c1_d8757496",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memory_pressure.go",
        "patchSetId": 3
      },
      "lineNbr": 921,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-03-12T23:29:52Z",
      "side": 1,
      "message": "Sure, although that would be only once per tab (log files are 300-500 lines on cyan).\nMaybe I\u0027ll just log once.  Too bad Go doesn\u0027t have static variables...",
      "parentUuid": "c853e33a_e083ab23",
      "range": {
        "startLine": 921,
        "startChar": 3,
        "endLine": 921,
        "endChar": 34
      },
      "revId": "7fd55d40edcad219c20195ff936a0421d51a41b4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9676d37a_32dcfb29",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memory_pressure.go",
        "patchSetId": 3
      },
      "lineNbr": 921,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2019-03-13T01:32:40Z",
      "side": 1,
      "message": "looks like this is still logging?",
      "parentUuid": "faa6c5c1_d8757496",
      "range": {
        "startLine": 921,
        "startChar": 3,
        "endLine": 921,
        "endChar": 34
      },
      "revId": "7fd55d40edcad219c20195ff936a0421d51a41b4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7f088690_5b52ef53",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memory_pressure.go",
        "patchSetId": 3
      },
      "lineNbr": 921,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-03-13T01:38:12Z",
      "side": 1,
      "message": "can\u0027t you just add \"loggedMissingZRAM :\u003d false\" outside of the loop to track whether you\u0027ve logged or not?",
      "parentUuid": "faa6c5c1_d8757496",
      "range": {
        "startLine": 921,
        "startChar": 3,
        "endLine": 921,
        "endChar": 34
      },
      "revId": "7fd55d40edcad219c20195ff936a0421d51a41b4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "209bab3a_0a12647d",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memory_pressure.go",
        "patchSetId": 3
      },
      "lineNbr": 1018,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2019-03-12T23:16:56Z",
      "side": 1,
      "message": "this file is getting to the size/complexity where i\u0027d recommend trying to split some more of the code into separate subpackages...",
      "revId": "7fd55d40edcad219c20195ff936a0421d51a41b4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5dc67ec8_d2a01ea4",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memory_pressure.go",
        "patchSetId": 3
      },
      "lineNbr": 1018,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-03-12T23:29:52Z",
      "side": 1,
      "message": "OK, I\u0027ll look for a good way.  The zram stats may logically go into kernelmeter for one thing, yes?",
      "parentUuid": "209bab3a_0a12647d",
      "revId": "7fd55d40edcad219c20195ff936a0421d51a41b4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3a3459ba_d91fcfb8",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memory_pressure.go",
        "patchSetId": 3
      },
      "lineNbr": 1018,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2019-03-13T00:14:27Z",
      "side": 1,
      "message": "I agree re-factoring this is good.  We\u0027ll probably want that to be able to compose more interesting tests also (i.e. adding Android etc).  But I would make that a separate CL that doesn\u0027t add any functionality.",
      "parentUuid": "5dc67ec8_d2a01ea4",
      "revId": "7fd55d40edcad219c20195ff936a0421d51a41b4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "50f81d0a_e191e37a",
        "filename": "src/chromiumos/tast/local/bundles/cros/platform/memory_pressure.go",
        "patchSetId": 3
      },
      "lineNbr": 1018,
      "author": {
        "id": 1000028
      },
      "writtenOn": "2019-03-13T16:46:20Z",
      "side": 1,
      "message": "Yes that seems like a good idea.  Unless it is an absolute requirement for this CL, I\u0027d like to postpone the refactor to the next one.",
      "parentUuid": "3a3459ba_d91fcfb8",
      "revId": "7fd55d40edcad219c20195ff936a0421d51a41b4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}