{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "dddec02e_a6970362",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1541210
      },
      "writtenOn": "2022-08-15T06:53:57Z",
      "side": 1,
      "message": "PTAL, thanks!",
      "revId": "c590a2f76762def87d99f4a768d1d5b1603d47a1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "27ee0e3c_e184d199",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_perf.go",
        "patchSetId": 4
      },
      "lineNbr": 43,
      "author": {
        "id": 1394308
      },
      "writtenOn": "2022-08-15T07:04:53Z",
      "side": 1,
      "message": "It looks like we prefer `SSHFS`:\n* https://source.chromium.org/chromium/chromiumos/platform/tast-tests/+/main:src/chromiumos/tast/local/bundles/cros/crostini/sshfs_mount.go;l\u003d23;drc\u003da324b9a9e19fdad757406347a06ccd1fb625526a\n* https://source.chromium.org/chromium/chromiumos/platform/tast-tests/+/main:src/chromiumos/tast/local/bundles/cros/platform/cros_disks_sshfs.go;l\u003d16;drc\u003d1b25e17923f11ef6b10efa38191b72f038877a96\ncf. https://github.com/golang/go/wiki/CodeReviewComments#initialisms",
      "range": {
        "startLine": 43,
        "startChar": 4,
        "endLine": 43,
        "endChar": 9
      },
      "revId": "c590a2f76762def87d99f4a768d1d5b1603d47a1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e05d753b_0c7feea1",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_perf.go",
        "patchSetId": 4
      },
      "lineNbr": 43,
      "author": {
        "id": 1541210
      },
      "writtenOn": "2022-08-15T09:26:23Z",
      "side": 1,
      "message": "I see, thanks!",
      "parentUuid": "27ee0e3c_e184d199",
      "range": {
        "startLine": 43,
        "startChar": 4,
        "endLine": 43,
        "endChar": 9
      },
      "revId": "c590a2f76762def87d99f4a768d1d5b1603d47a1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "72b75b9a_dcfd2378",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_perf.go",
        "patchSetId": 4
      },
      "lineNbr": 70,
      "author": {
        "id": 1394308
      },
      "writtenOn": "2022-08-15T07:04:53Z",
      "side": 1,
      "message": "Shouldn\u0027t we add `\"config_unicode\"`?",
      "range": {
        "startLine": 70,
        "startChar": 3,
        "endLine": 70,
        "endChar": 20
      },
      "revId": "c590a2f76762def87d99f4a768d1d5b1603d47a1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "39839b83_086f6f2d",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_perf.go",
        "patchSetId": 4
      },
      "lineNbr": 70,
      "author": {
        "id": 1541210
      },
      "writtenOn": "2022-08-15T09:26:23Z",
      "side": 1,
      "message": "Apparently we don\u0027t need it here.",
      "parentUuid": "72b75b9a_dcfd2378",
      "range": {
        "startLine": 70,
        "startChar": 3,
        "endLine": 70,
        "endChar": 20
      },
      "revId": "c590a2f76762def87d99f4a768d1d5b1603d47a1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bc17e378_e239732c",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_perf.go",
        "patchSetId": 4
      },
      "lineNbr": 70,
      "author": {
        "id": 1394308
      },
      "writtenOn": "2022-08-15T09:57:58Z",
      "side": 1,
      "message": "Ah,sorry. I confused SSHFS mount with host-side virtio-blk /data mount when I looked at the CL in Cq-Depend...",
      "parentUuid": "39839b83_086f6f2d",
      "range": {
        "startLine": 70,
        "startChar": 3,
        "endLine": 70,
        "endChar": 20
      },
      "revId": "c590a2f76762def87d99f4a768d1d5b1603d47a1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "495585f5_5112aa59",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_perf.go",
        "patchSetId": 4
      },
      "lineNbr": 70,
      "author": {
        "id": 1541210
      },
      "writtenOn": "2022-08-15T10:43:13Z",
      "side": 1,
      "message": "I see, sorry for the confusion.",
      "parentUuid": "bc17e378_e239732c",
      "range": {
        "startLine": 70,
        "startChar": 3,
        "endLine": 70,
        "endChar": 20
      },
      "revId": "c590a2f76762def87d99f4a768d1d5b1603d47a1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "39009d01_56f316e1",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_perf.go",
        "patchSetId": 4
      },
      "lineNbr": 308,
      "author": {
        "id": 1394308
      },
      "writtenOn": "2022-08-15T07:04:53Z",
      "side": 1,
      "message": "Shouldn\u0027t we unmount it when the test ends?",
      "range": {
        "startLine": 302,
        "startChar": 0,
        "endLine": 308,
        "endChar": 3
      },
      "revId": "c590a2f76762def87d99f4a768d1d5b1603d47a1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a1cc6fe9_9c88f36e",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_perf.go",
        "patchSetId": 4
      },
      "lineNbr": 308,
      "author": {
        "id": 1541210
      },
      "writtenOn": "2022-08-15T09:26:23Z",
      "side": 1,
      "message": "Looks like /home/root/\u003chash\u003e/android-data/data/media/0 is already unmounted at the end of the test. Probably it\u0027s unmounted when we unmount the SDCard volume. So if we need to do it, I think it should be before unmounting the SDCard volume.",
      "parentUuid": "39009d01_56f316e1",
      "range": {
        "startLine": 302,
        "startChar": 0,
        "endLine": 308,
        "endChar": 3
      },
      "revId": "c590a2f76762def87d99f4a768d1d5b1603d47a1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0f84226b_f56cdc5d",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_perf.go",
        "patchSetId": 4
      },
      "lineNbr": 308,
      "author": {
        "id": 1394308
      },
      "writtenOn": "2022-08-15T09:57:58Z",
      "side": 1,
      "message": "Thanks for checking! If that\u0027s the case, maybe the unmount code should be moved to somewhere in between\n```\nerr \u003d createFileCopiesUnderTargetPath(s, targetDirPath)\n```\nand\n```\nif err !\u003d nil {\n\ts.Fatalf(\"Failed to create copies of %s under %v: %v\", capybaraFileName, targetDirPath, err)\n}\n```\nso that it\u0027s executed even when `createFileCopiesUnderTargetPath` fails?\nAlso I wonder whether the defered `os.RemoveAll(targetDirPath)` has any effect if SSHFS is already unmounted. Do we need to mount and unmount SSHFS before and after `os.RemoveAll` so that the created files are always removed?",
      "parentUuid": "a1cc6fe9_9c88f36e",
      "range": {
        "startLine": 302,
        "startChar": 0,
        "endLine": 308,
        "endChar": 3
      },
      "revId": "c590a2f76762def87d99f4a768d1d5b1603d47a1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1ee149fc_607f849c",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_perf.go",
        "patchSetId": 4
      },
      "lineNbr": 308,
      "author": {
        "id": 1394308
      },
      "writtenOn": "2022-08-15T10:22:34Z",
      "side": 1,
      "message": "Or possibly defer the umount command here, and mount SSHFS again after the SDCard volume is unmounted and mounted?",
      "parentUuid": "0f84226b_f56cdc5d",
      "range": {
        "startLine": 302,
        "startChar": 0,
        "endLine": 308,
        "endChar": 3
      },
      "revId": "c590a2f76762def87d99f4a768d1d5b1603d47a1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7d7fc324_271c7b50",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/media_scan_perf.go",
        "patchSetId": 4
      },
      "lineNbr": 308,
      "author": {
        "id": 1541210
      },
      "writtenOn": "2022-08-15T10:43:13Z",
      "side": 1,
      "message": "\u003e maybe the unmount code should be moved to somewhere in between [...] so that it\u0027s executed even when  createFileCopiesUnderTargetPath  fails?\nRight, thanks!\n\n\u003e Do we need to mount and unmount SSHFS before and after os.RemoveAll\nI also overlooked this (as os.RemoveAll doesn\u0027t fail for nonexistent paths), thanks for pointing this out as well!\n\n\u003e Or possibly defer the umount command here, and mount SSHFS again after the SDCard volume is unmounted and mounted?\nDo you mean to allow SSHFS to be automatically unmounted when we unmount the SDCard volume? Although that will be one less unmount needed, probably the code will be easier to understand if we always wrap with mount and unmount the parts of the code that accesses `/home/root/\u003chash\u003e/android-data/data` ?",
      "parentUuid": "1ee149fc_607f849c",
      "range": {
        "startLine": 302,
        "startChar": 0,
        "endLine": 308,
        "endChar": 3
      },
      "revId": "c590a2f76762def87d99f4a768d1d5b1603d47a1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}