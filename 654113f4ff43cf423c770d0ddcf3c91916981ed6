{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "5e822aee_3ef0f098",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 10
      },
      "lineNbr": 0,
      "author": {
        "id": 1530382
      },
      "writtenOn": "2022-06-24T20:59:58Z",
      "side": 1,
      "message": "Thanks everyone for the comments, helps a ton.\n\nThe following happened in this patch:\n- Http server is now called in a goroutine within golang, no longer uses python\n- We are now checking for the service state \u0027redirect-found\u0027. In order to get online state, we will need to have an additional https server, which should be the next steps.\n- All comments as well",
      "revId": "654113f4ff43cf423c770d0ddcf3c91916981ed6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5b03c0ce_78b97279",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/virtualnet/dnsmasq/dnsmasq.go",
        "patchSetId": 10
      },
      "lineNbr": 92,
      "author": {
        "id": 1530382
      },
      "writtenOn": "2022-06-24T20:59:58Z",
      "side": 1,
      "message": "Although this accomplished what we want, it feels kind of awkward. Curious on suggestions to refactor here.",
      "range": {
        "startLine": 87,
        "startChar": 1,
        "endLine": 92,
        "endChar": 2
      },
      "revId": "654113f4ff43cf423c770d0ddcf3c91916981ed6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7df41c88_e78cf867",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/virtualnet/dnsmasq/dnsmasq.go",
        "patchSetId": 10
      },
      "lineNbr": 92,
      "author": {
        "id": 1364246
      },
      "writtenOn": "2022-06-27T02:19:24Z",
      "side": 1,
      "message": "IIUC (didn\u0027t do experiment by myself, just according to the manual of dnsmasq), when specifying \"port\", dnsmasq will start the DNS server by itself, so I guess in the first if branch (`if len(d.dns) \u003e 0`), we don\u0027t need to set \"port\", since in this case we expect using the external DNS servers (d.dns).\n\nAnother question is, in the second if branch (`if d.forceAddressToIP !\u003d \"\"`), do we need to also append `${gateway}:53` to the dns list to make DHCP broadcasting this DNS? Did you check that if the IPConfig object exposed by shill contain this DNS server (after setup, run `/usr/local/lib/flimflam/test/list-ipconfigs etho_routert` on DUT before cleanup, maybe need to add a timeout in the test to avoid cleanup happens too fast)? But it seems that this part should works well if this test passes...\n\nThanks!",
      "parentUuid": "5b03c0ce_78b97279",
      "range": {
        "startLine": 87,
        "startChar": 1,
        "endLine": 92,
        "endChar": 2
      },
      "revId": "654113f4ff43cf423c770d0ddcf3c91916981ed6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "824f9120_f0826c96",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/virtualnet/dnsmasq/dnsmasq.go",
        "patchSetId": 10
      },
      "lineNbr": 92,
      "author": {
        "id": 1530382
      },
      "writtenOn": "2022-06-30T16:54:14Z",
      "side": 1,
      "message": "\u003e Do we need to also append  `${gateway}:53`  to the dns list to make DHCP broadcasting this DNS? Did you check that if the IPConfig object exposed by shill contain this DNS server\n\nThe ipconfig came back with this as the gateway: `Gateway \u003d 192.168.100.1` so it appears to be working as expected. So I believe we do not need to add that to the dns list. Please correct me if I am wrong here.",
      "parentUuid": "7df41c88_e78cf867",
      "range": {
        "startLine": 87,
        "startChar": 1,
        "endLine": 92,
        "endChar": 2
      },
      "revId": "654113f4ff43cf423c770d0ddcf3c91916981ed6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "78f96775_5a8f027a",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/virtualnet/dnsmasq/dnsmasq.go",
        "patchSetId": 10
      },
      "lineNbr": 92,
      "author": {
        "id": 1364246
      },
      "writtenOn": "2022-07-01T02:31:37Z",
      "side": 1,
      "message": "Sorry I was not clear: did this address (\"192.168.100.1\") also appears in the \"NameServers\" field in the IPConfig object? That\u0027s the DNS list which should be used by the PortalDetector.\n\nMy actual question is: don\u0027t we need to append \"0.0.0.0\" to the |dns| list as what was done in this patch https://crrev.com/c/3722629?  (I just learned that 0.0.0.0 can be used to represent gateway from that patch)",
      "parentUuid": "824f9120_f0826c96",
      "range": {
        "startLine": 87,
        "startChar": 1,
        "endLine": 92,
        "endChar": 2
      },
      "revId": "654113f4ff43cf423c770d0ddcf3c91916981ed6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1a3ac1a3_15defe48",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/virtualnet/dnsmasq/dnsmasq.go",
        "patchSetId": 10
      },
      "lineNbr": 92,
      "author": {
        "id": 1530382
      },
      "writtenOn": "2022-07-01T15:36:20Z",
      "side": 1,
      "message": "\u003e did this address (\"192.168.100.1\") also appears in the \"NameServers\" field in the IPConfig object?\n\nYes, just double checked and the command you shared returns this:\n```\nNameServers \u003d [\n    192.168.100.1\n]\n```\n\n\u003e  don\u0027t we need to append \"0.0.0.0\" to the |dns| list as what was done in this patch https://crrev.com/c/3722629?\n\nI could, but considering I already have the correct addresses for Gateway and NameServers, would it be necessary?",
      "parentUuid": "78f96775_5a8f027a",
      "range": {
        "startLine": 87,
        "startChar": 1,
        "endLine": 92,
        "endChar": 2
      },
      "revId": "654113f4ff43cf423c770d0ddcf3c91916981ed6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6d7a75f5_7f5daf26",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/virtualnet/dnsmasq/dnsmasq.go",
        "patchSetId": 10
      },
      "lineNbr": 92,
      "author": {
        "id": 1530382
      },
      "writtenOn": "2022-07-01T18:57:14Z",
      "side": 1,
      "message": "Also I believe that you do not need to append 0.0.0.0. If you provide no address at all for `dhcp-option\u003doption:dns-server`, it assumes that the host you are running dnsmasq on is the DNS server. Correct me if I am wrong",
      "parentUuid": "1a3ac1a3_15defe48",
      "range": {
        "startLine": 87,
        "startChar": 1,
        "endLine": 92,
        "endChar": 2
      },
      "revId": "654113f4ff43cf423c770d0ddcf3c91916981ed6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b03827fa_515e2e44",
        "filename": "src/chromiumos/tast/local/bundles/cros/network/virtualnet/dnsmasq/dnsmasq.go",
        "patchSetId": 10
      },
      "lineNbr": 92,
      "author": {
        "id": 1364246
      },
      "writtenOn": "2022-07-02T02:56:09Z",
      "side": 1,
      "message": "Ack. Thanks for testing that! It sounds counterintuitive to me though :)",
      "parentUuid": "6d7a75f5_7f5daf26",
      "range": {
        "startLine": 87,
        "startChar": 1,
        "endLine": 92,
        "endChar": 2
      },
      "revId": "654113f4ff43cf423c770d0ddcf3c91916981ed6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}