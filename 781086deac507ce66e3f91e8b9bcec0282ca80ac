{
  "comments": [
    {
      "key": {
        "uuid": "99fa57dd_45b10196",
        "filename": "src/chromiumos/tast/local/arc/activity.go",
        "patchSetId": 3
      },
      "lineNbr": 170,
      "author": {
        "id": 1358595
      },
      "writtenOn": "2020-03-19T17:11:41Z",
      "side": 1,
      "message": "Is it possible to start an android activity that only runs in the background and does not have a visible window? If so, this might be detrimental in the future.",
      "range": {
        "startLine": 168,
        "startChar": 1,
        "endLine": 170,
        "endChar": 2
      },
      "revId": "781086deac507ce66e3f91e8b9bcec0282ca80ac",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "de7177eb_59643538",
        "filename": "src/chromiumos/tast/local/arc/activity.go",
        "patchSetId": 3
      },
      "lineNbr": 170,
      "author": {
        "id": 1179631
      },
      "writtenOn": "2020-03-24T02:54:21Z",
      "side": 1,
      "message": "I\u0027m not sure enough to fully rule that out. If we need that in the future I think we can add a separate function for this.",
      "parentUuid": "99fa57dd_45b10196",
      "range": {
        "startLine": 168,
        "startChar": 1,
        "endLine": 170,
        "endChar": 2
      },
      "revId": "781086deac507ce66e3f91e8b9bcec0282ca80ac",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9fe770d4_4f644b15",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/multi_display.go",
        "patchSetId": 3
      },
      "lineNbr": 186,
      "author": {
        "id": 1358595
      },
      "writtenOn": "2020-03-19T17:11:41Z",
      "side": 1,
      "message": "would it be better to put this in startActivityOnDisplay(..)? That would make it more similar to act.Start(...). Especially since that function will likely eventually be added to activity.go",
      "range": {
        "startLine": 184,
        "startChar": 3,
        "endLine": 186,
        "endChar": 4
      },
      "revId": "781086deac507ce66e3f91e8b9bcec0282ca80ac",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e8d5c7cb_ea5853f2",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/multi_display.go",
        "patchSetId": 3
      },
      "lineNbr": 186,
      "author": {
        "id": 1179631
      },
      "writtenOn": "2020-03-24T02:54:21Z",
      "side": 1,
      "message": "Yeah sgtm~~ Actually I realised I already added WaitForVisible to startActivityOnDisplay. Thanks for catching, will remove in a new patchset~!",
      "parentUuid": "9fe770d4_4f644b15",
      "range": {
        "startLine": 184,
        "startChar": 3,
        "endLine": 186,
        "endChar": 4
      },
      "revId": "781086deac507ce66e3f91e8b9bcec0282ca80ac",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "deec6ce6_e55426ab",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/multi_display.go",
        "patchSetId": 3
      },
      "lineNbr": 186,
      "author": {
        "id": 1179631
      },
      "writtenOn": "2020-03-26T03:42:34Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e8d5c7cb_ea5853f2",
      "range": {
        "startLine": 184,
        "startChar": 3,
        "endLine": 186,
        "endChar": 4
      },
      "revId": "781086deac507ce66e3f91e8b9bcec0282ca80ac",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "475db931_2878b3b4",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/resize_activity.go",
        "patchSetId": 3
      },
      "lineNbr": 138,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2020-03-19T14:47:32Z",
      "side": 1,
      "message": "here and below: this wait is also flaky.\nI\u0027d rather replace it with a \"waitForResumed\" that only lives in this file, than adding a sleep. I\u0027d keep the TODO message.",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 138,
        "endChar": 2
      },
      "revId": "781086deac507ce66e3f91e8b9bcec0282ca80ac",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "82569671_174e9486",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/resize_activity.go",
        "patchSetId": 3
      },
      "lineNbr": 138,
      "author": {
        "id": 1358595
      },
      "writtenOn": "2020-03-19T17:11:41Z",
      "side": 1,
      "message": "I second this.",
      "parentUuid": "475db931_2878b3b4",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 138,
        "endChar": 2
      },
      "revId": "781086deac507ce66e3f91e8b9bcec0282ca80ac",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f1779078_b052d24d",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/resize_activity.go",
        "patchSetId": 3
      },
      "lineNbr": 138,
      "author": {
        "id": 1179631
      },
      "writtenOn": "2020-03-24T02:54:21Z",
      "side": 1,
      "message": "Yes, I agree this is still flaky.\n\nI want to remove \u0027WaitForResumed\u0027 code in its entirety because it\u0027s being used incorrectly. Currently, it\u0027s equivalent to a sleep (that is, it serves the same purpose), but just looks a bit different. It seems misleading to me to leave it in and I don\u0027t want people to copy that code to other files.",
      "parentUuid": "82569671_174e9486",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 138,
        "endChar": 2
      },
      "revId": "781086deac507ce66e3f91e8b9bcec0282ca80ac",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "558fdde9_5426c76c",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/resize_activity.go",
        "patchSetId": 3
      },
      "lineNbr": 138,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2020-03-24T03:49:22Z",
      "side": 1,
      "message": "removing \"WaitForResumed\" from Activity LGTM.\nMy suggestion is to move func \"WaitForResumed\" to the resize_acivity.go file.",
      "parentUuid": "f1779078_b052d24d",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 138,
        "endChar": 2
      },
      "revId": "781086deac507ce66e3f91e8b9bcec0282ca80ac",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3cb13f5f_0d86806d",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/resize_activity.go",
        "patchSetId": 3
      },
      "lineNbr": 138,
      "author": {
        "id": 1179631
      },
      "writtenOn": "2020-03-24T03:55:48Z",
      "side": 1,
      "message": "I want to push back on this because functionally there\u0027s no difference between WaitForResumed and a sleep here, just that a sleep makes it more obvious what this code is actually doing.\n\nWhat is the reason for keeping WaitForResumed here?",
      "parentUuid": "558fdde9_5426c76c",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 138,
        "endChar": 2
      },
      "revId": "781086deac507ce66e3f91e8b9bcec0282ca80ac",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c75ec5e6_38d4b06f",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/resize_activity.go",
        "patchSetId": 3
      },
      "lineNbr": 138,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2020-03-24T04:06:01Z",
      "side": 1,
      "message": "I think it makes sense to remove WaitForResumed from Activity, since as you mentioned is misleading and flaky.\nBut if we can\u0027t replace WaitForResumed with something that is non-flaky, then let\u0027s keep calling the existing WaitForResumed, but changing the scope of the function: private to the file so that nobody else call it.  I\u0027d also add a TODO/FIXME in the func.\n\nThe rationale is:\nIf we can\u0027t replace WaitForResumed with something that is stable, then just leave as it is. \nIf we are going to fix it, then we should fix it properly.\nI don\u0027t want to replace a flaky func with another flaky one.",
      "parentUuid": "3cb13f5f_0d86806d",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 138,
        "endChar": 2
      },
      "revId": "781086deac507ce66e3f91e8b9bcec0282ca80ac",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "588ad237_7e06ac28",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/resize_activity.go",
        "patchSetId": 3
      },
      "lineNbr": 138,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2020-03-25T05:39:36Z",
      "side": 1,
      "message": "May I jump in to make sure everyone on the same page? My understanding is:\n\nFirst, in this case, WaitForResumed() conceptually does nothing, because the task state should be \"resumed\" on calling timing already. So, this is just misuse.\nIn practice, WaitForResumed() takes time to execute, which is the reason this stabilized the test.\n\nThen, IMO, in this specific case, replacing by testing.Sleep() can make more sense,\nbecause it is what we do here (indeed, it shouldn\u0027t be the long term solution as described below).\n\nAlternatively, technically we can comment here that, like:\n\n// Calling WaitForResumed does nothing because the task state should be already in resumed,\n// but it contributes some stability here because WaitForResumed takes some execution time, which\n// gives the chance to the window gets stabilized.\n// TODO(...): ...\n\njust in order to keep the current code, but it sounds like more hacky approach.\n\nIn general, testing.Sleep() is not a way to wait for some stabilized condition.\nThis is the case, too, and tast reviewers (incl. me) carefully check it all the time.\nPractically, we still use testing.Sleep() for stabilization in Tast, if,\n\n- It is for a short term. I.e., there\u0027s some on-going work to address it, and \n- There\u0027s no proper alternative.\n\nI think this case meets the conditions, too. There\u0027s TODO/associated bug to remove the testing.Sleep() here (I expect it will be addressed sometime soon). Also, there\u0027s no good alternative. (I assume consuming the time by no-op WaitForResumed is not a good alternative).\n\nRicardo, Brendan, WDYT?\n\nIf we can agree, then that means we can remove the last use of WaitForResumed from here, so we can remove the WaitForResumed completely.",
      "parentUuid": "c75ec5e6_38d4b06f",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 138,
        "endChar": 2
      },
      "revId": "781086deac507ce66e3f91e8b9bcec0282ca80ac",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4d59a69d_0a533852",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/resize_activity.go",
        "patchSetId": 3
      },
      "lineNbr": 138,
      "author": {
        "id": 1284845
      },
      "writtenOn": "2020-03-25T18:18:19Z",
      "side": 1,
      "message": "It\u0027s Ok for me to remove WaitForResumed which I added to stabilize but it seems not working well. I need to look for another method to stabilize it.",
      "parentUuid": "588ad237_7e06ac28",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 138,
        "endChar": 2
      },
      "revId": "781086deac507ce66e3f91e8b9bcec0282ca80ac",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d728f85b_8c2339f2",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/resize_activity.go",
        "patchSetId": 3
      },
      "lineNbr": 138,
      "author": {
        "id": 1179631
      },
      "writtenOn": "2020-03-26T03:42:34Z",
      "side": 1,
      "message": "My suggestion for stabilisation is to wait for an expected bounds.\n\nIf that isn\u0027t possible, I think Takise-san is looking at implementing something similar to go/arc-wm-synchronization that could be used.",
      "parentUuid": "4d59a69d_0a533852",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 138,
        "endChar": 2
      },
      "revId": "781086deac507ce66e3f91e8b9bcec0282ca80ac",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "48c142ba_6eec1cba",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/resize_activity.go",
        "patchSetId": 3
      },
      "lineNbr": 146,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2020-03-19T14:47:32Z",
      "side": 1,
      "message": "ditto above",
      "range": {
        "startLine": 146,
        "startChar": 19,
        "endLine": 146,
        "endChar": 24
      },
      "revId": "781086deac507ce66e3f91e8b9bcec0282ca80ac",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e48da8dc_16be21eb",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/resize_activity.go",
        "patchSetId": 3
      },
      "lineNbr": 146,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2020-03-25T13:45:34Z",
      "side": 1,
      "message": "Ok, lets do this. Thanks for adding more light about the \"sleep\" valid use cases.",
      "parentUuid": "48c142ba_6eec1cba",
      "range": {
        "startLine": 146,
        "startChar": 19,
        "endLine": 146,
        "endChar": 24
      },
      "revId": "781086deac507ce66e3f91e8b9bcec0282ca80ac",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8a888361_011c4e7b",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/resize_activity.go",
        "patchSetId": 3
      },
      "lineNbr": 146,
      "author": {
        "id": 1179631
      },
      "writtenOn": "2020-03-31T08:05:00Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e48da8dc_16be21eb",
      "range": {
        "startLine": 146,
        "startChar": 19,
        "endLine": 146,
        "endChar": 24
      },
      "revId": "781086deac507ce66e3f91e8b9bcec0282ca80ac",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fb74fdb5_ee95d438",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/resize_activity.go",
        "patchSetId": 3
      },
      "lineNbr": 229,
      "author": {
        "id": 1202079
      },
      "writtenOn": "2020-03-19T14:47:32Z",
      "side": 1,
      "message": "ditto above",
      "range": {
        "startLine": 229,
        "startChar": 20,
        "endLine": 229,
        "endChar": 25
      },
      "revId": "781086deac507ce66e3f91e8b9bcec0282ca80ac",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9cde33d8_9d7e713c",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/resize_activity.go",
        "patchSetId": 3
      },
      "lineNbr": 229,
      "author": {
        "id": 1179631
      },
      "writtenOn": "2020-03-31T08:05:00Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "fb74fdb5_ee95d438",
      "range": {
        "startLine": 229,
        "startChar": 20,
        "endLine": 229,
        "endChar": 25
      },
      "revId": "781086deac507ce66e3f91e8b9bcec0282ca80ac",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}