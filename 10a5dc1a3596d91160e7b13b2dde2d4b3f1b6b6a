{
  "comments": [
    {
      "key": {
        "uuid": "1b380aff_492d751f",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perf_boot_service.go",
        "patchSetId": 2
      },
      "lineNbr": 18,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-12-26T06:59:39Z",
      "side": 1,
      "message": "huge nit: This package is typically referred as just \"arc\", so I\u0027d import chromiumos/tast/services/cros/arc with an alias instead. How about importing the other one as \"arcpb\"?",
      "range": {
        "startLine": 18,
        "startChar": 1,
        "endLine": 18,
        "endChar": 9
      },
      "revId": "10a5dc1a3596d91160e7b13b2dde2d4b3f1b6b6a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1d9f8dd4_0ac4cc47",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perf_boot_service.go",
        "patchSetId": 2
      },
      "lineNbr": 18,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2020-01-06T06:13:21Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1b380aff_492d751f",
      "range": {
        "startLine": 18,
        "startChar": 1,
        "endLine": 18,
        "endChar": 9
      },
      "revId": "10a5dc1a3596d91160e7b13b2dde2d4b3f1b6b6a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "058979ad_9b107b2b",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perf_boot_service.go",
        "patchSetId": 2
      },
      "lineNbr": 41,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-12-26T06:59:39Z",
      "side": 1,
      "message": "\": \" is not needed; it\u0027s appended by errors.Wrap. Ditto below.",
      "range": {
        "startLine": 41,
        "startChar": 71,
        "endLine": 41,
        "endChar": 75
      },
      "revId": "10a5dc1a3596d91160e7b13b2dde2d4b3f1b6b6a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "549f96ac_119e44c7",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perf_boot_service.go",
        "patchSetId": 2
      },
      "lineNbr": 41,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2020-01-06T06:13:21Z",
      "side": 1,
      "message": "Removed \": \" here and elsewhere.",
      "parentUuid": "058979ad_9b107b2b",
      "range": {
        "startLine": 41,
        "startChar": 71,
        "endLine": 41,
        "endChar": 75
      },
      "revId": "10a5dc1a3596d91160e7b13b2dde2d4b3f1b6b6a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ceca93b5_b244404b",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perf_boot_service.go",
        "patchSetId": 2
      },
      "lineNbr": 61,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-12-26T06:59:39Z",
      "side": 1,
      "message": "huge nit: logcatEventEntryRegexp :\u003d ...",
      "range": {
        "startLine": 61,
        "startChar": 1,
        "endLine": 61,
        "endChar": 30
      },
      "revId": "10a5dc1a3596d91160e7b13b2dde2d4b3f1b6b6a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "42b8e411_6ce883d1",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perf_boot_service.go",
        "patchSetId": 2
      },
      "lineNbr": 61,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2020-01-06T06:13:21Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ceca93b5_b244404b",
      "range": {
        "startLine": 61,
        "startChar": 1,
        "endLine": 61,
        "endChar": 30
      },
      "revId": "10a5dc1a3596d91160e7b13b2dde2d4b3f1b6b6a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "acd5c634_9fd8b4da",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perf_boot_service.go",
        "patchSetId": 2
      },
      "lineNbr": 64,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-12-26T06:59:39Z",
      "side": 1,
      "message": "Why do we need KeepState option? I\u0027m rather afraid that it might make the perf results unstable because the previous test run on this DUT can affect the behavior of this test.",
      "range": {
        "startLine": 64,
        "startChar": 15,
        "endLine": 64,
        "endChar": 24
      },
      "revId": "10a5dc1a3596d91160e7b13b2dde2d4b3f1b6b6a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b9ecb6b9_615f21f0",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perf_boot_service.go",
        "patchSetId": 2
      },
      "lineNbr": 64,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2020-01-06T06:13:21Z",
      "side": 1,
      "message": "+khmel@\n\nIt\u0027s my understanding that keepState option corresponds with dont_override_profile option in autotest, and if that\u0027s the case, this CL\u0027s description seems to explain why it is needed.\n\nhttps://chrome-internal-review.googlesource.com/c/chromeos/autotest-cheets/+/268989\n\nYury, let us know if you have an opinion on this.",
      "parentUuid": "acd5c634_9fd8b4da",
      "range": {
        "startLine": 64,
        "startChar": 15,
        "endLine": 64,
        "endChar": 24
      },
      "revId": "10a5dc1a3596d91160e7b13b2dde2d4b3f1b6b6a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "de95567e_dbe702ca",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perf_boot_service.go",
        "patchSetId": 2
      },
      "lineNbr": 64,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2020-01-07T06:16:37Z",
      "side": 1,
      "message": "If that is the case, I think we have to start ARC with a new profile first, and do measurements on the second boot.",
      "parentUuid": "b9ecb6b9_615f21f0",
      "range": {
        "startLine": 64,
        "startChar": 15,
        "endLine": 64,
        "endChar": 24
      },
      "revId": "10a5dc1a3596d91160e7b13b2dde2d4b3f1b6b6a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b4920a96_4fbd1859",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perf_boot_service.go",
        "patchSetId": 2
      },
      "lineNbr": 64,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2020-01-07T06:41:32Z",
      "side": 1,
      "message": "Since this is unrelated to the remote test migration, I will address it in a separate CL after I get a comment from Yury.",
      "parentUuid": "de95567e_dbe702ca",
      "range": {
        "startLine": 64,
        "startChar": 15,
        "endLine": 64,
        "endChar": 24
      },
      "revId": "10a5dc1a3596d91160e7b13b2dde2d4b3f1b6b6a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "cf271947_012534fb",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perf_boot_service.go",
        "patchSetId": 2
      },
      "lineNbr": 72,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-12-26T06:59:39Z",
      "side": 1,
      "message": "Passing an empty path to arc.New does not prevent it from saving files, so this would just save files in the current directory.\n\nInstead how about creating a temporary directory?\n\n td, err :\u003d ioutil.TempDir(\"\", \"\")\n if err !\u003d nil { ... }\n defer os.RemoveAll(td)\n\n a, err :\u003d arc.New(ctx, td)",
      "range": {
        "startLine": 72,
        "startChar": 29,
        "endLine": 72,
        "endChar": 32
      },
      "revId": "10a5dc1a3596d91160e7b13b2dde2d4b3f1b6b6a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6cbd5c73_82b40c87",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perf_boot_service.go",
        "patchSetId": 2
      },
      "lineNbr": 72,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2020-01-06T06:13:21Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "cf271947_012534fb",
      "range": {
        "startLine": 72,
        "startChar": 29,
        "endLine": 72,
        "endChar": 32
      },
      "revId": "10a5dc1a3596d91160e7b13b2dde2d4b3f1b6b6a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5dae5a86_dbefc219",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perf_boot_service.go",
        "patchSetId": 2
      },
      "lineNbr": 84,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-12-26T06:59:39Z",
      "side": 1,
      "message": "style: arcStartTimeMS\nhttps://github.com/golang/go/wiki/CodeReviewComments#initialisms",
      "range": {
        "startLine": 84,
        "startChar": 5,
        "endLine": 84,
        "endChar": 19
      },
      "revId": "10a5dc1a3596d91160e7b13b2dde2d4b3f1b6b6a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a6e32ce4_44d932b9",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perf_boot_service.go",
        "patchSetId": 2
      },
      "lineNbr": 84,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2020-01-06T06:13:21Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5dae5a86_dbefc219",
      "range": {
        "startLine": 84,
        "startChar": 5,
        "endLine": 84,
        "endChar": 19
      },
      "revId": "10a5dc1a3596d91160e7b13b2dde2d4b3f1b6b6a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9e0a3b9f_b0d6df23",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perf_boot_service.go",
        "patchSetId": 2
      },
      "lineNbr": 142,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-12-26T06:59:39Z",
      "side": 1,
      "message": "I think this check behaves a bit confusing depending on how long time left in ctx timeout.\n\n- If ctx timeout is shorter than logcatTimeout: logcat process is killed on ctx timeout, scanner reads EOF and scanner.Scan returns false, so this RPC call suceeds\n- If ctx timeout is longer than logcatTimeout: an error is returned here\n\nMy recommendation is to set the context timeout with logcatTimeout and check if the last event is seen.\n\n ctx, cancel :\u003d context.WithTimeout(ctx, logcatTimeout)\n defer cancel()\n\n cmd :\u003d a.Command(ctx, ...) // cmd is killed on ctx timeout\n ...\n\n lastEventSeen :\u003d false\n for scanner.Scan() { // since the process is killed on ctx timeout, we\u0027ll exit from this loop by around that time\n   ...\n }\n if !lastEventSeen {\n   return nil, errors.New(...)\n }\n return res, nil",
      "range": {
        "startLine": 139,
        "startChar": 0,
        "endLine": 142,
        "endChar": 3
      },
      "revId": "10a5dc1a3596d91160e7b13b2dde2d4b3f1b6b6a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "82869121_055a75d5",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perf_boot_service.go",
        "patchSetId": 2
      },
      "lineNbr": 142,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2020-01-06T06:13:21Z",
      "side": 1,
      "message": "Done. Thanks for the tip!",
      "parentUuid": "9e0a3b9f_b0d6df23",
      "range": {
        "startLine": 139,
        "startChar": 0,
        "endLine": 142,
        "endChar": 3
      },
      "revId": "10a5dc1a3596d91160e7b13b2dde2d4b3f1b6b6a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e569aa1e_216e10d4",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perf_boot_service.go",
        "patchSetId": 2
      },
      "lineNbr": 143,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-12-26T06:59:39Z",
      "side": 1,
      "message": "Also we have to check scanner.Err() to see if it encountered any error.",
      "range": {
        "startLine": 143,
        "startChar": 0,
        "endLine": 143,
        "endChar": 2
      },
      "revId": "10a5dc1a3596d91160e7b13b2dde2d4b3f1b6b6a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e1d6dd7c_3d47dea8",
        "filename": "src/chromiumos/tast/local/bundles/cros/arc/perf_boot_service.go",
        "patchSetId": 2
      },
      "lineNbr": 143,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2020-01-06T06:13:21Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e569aa1e_216e10d4",
      "range": {
        "startLine": 143,
        "startChar": 0,
        "endLine": 143,
        "endChar": 2
      },
      "revId": "10a5dc1a3596d91160e7b13b2dde2d4b3f1b6b6a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a8784871_75e99343",
        "filename": "src/chromiumos/tast/remote/bundles/cros/arc/perf_boot.go",
        "patchSetId": 2
      },
      "lineNbr": 57,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-12-26T06:59:39Z",
      "side": 1,
      "message": "We can reuse the same \"cl\" variable for the two rpc.Client. (Reusing variables is common in Go unless very confusing)\n\nIn fact we already reuse \"service\"...",
      "range": {
        "startLine": 57,
        "startChar": 1,
        "endLine": 57,
        "endChar": 50
      },
      "revId": "10a5dc1a3596d91160e7b13b2dde2d4b3f1b6b6a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1bd79cfe_8afda16f",
        "filename": "src/chromiumos/tast/remote/bundles/cros/arc/perf_boot.go",
        "patchSetId": 2
      },
      "lineNbr": 57,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2020-01-06T06:13:21Z",
      "side": 1,
      "message": "Done.\nAlso removed \"defer cl2.Close(ctx)\"",
      "parentUuid": "a8784871_75e99343",
      "range": {
        "startLine": 57,
        "startChar": 1,
        "endLine": 57,
        "endChar": 50
      },
      "revId": "10a5dc1a3596d91160e7b13b2dde2d4b3f1b6b6a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "99c4688d_d089551a",
        "filename": "src/chromiumos/tast/services/cros/arc/perf_boot_service.proto",
        "patchSetId": 2
      },
      "lineNbr": 28,
      "author": {
        "id": 1118346
      },
      "writtenOn": "2019-12-26T06:59:39Z",
      "side": 1,
      "message": "Can we use google.protobuf.Duration instead?\nhttps://developers.google.com/protocol-buffers/docs/reference/google.protobuf#google.protobuf.Duration\nhttps://godoc.org/github.com/golang/protobuf/ptypes#Duration\nhttps://godoc.org/github.com/golang/protobuf/ptypes#DurationProto",
      "range": {
        "startLine": 28,
        "startChar": 4,
        "endLine": 28,
        "endChar": 9
      },
      "revId": "10a5dc1a3596d91160e7b13b2dde2d4b3f1b6b6a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "91ff4f2f_2035854a",
        "filename": "src/chromiumos/tast/services/cros/arc/perf_boot_service.proto",
        "patchSetId": 2
      },
      "lineNbr": 28,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2020-01-06T06:13:21Z",
      "side": 1,
      "message": "Done.\nThanks for friendly pointers 😊",
      "parentUuid": "99c4688d_d089551a",
      "range": {
        "startLine": 28,
        "startChar": 4,
        "endLine": 28,
        "endChar": 9
      },
      "revId": "10a5dc1a3596d91160e7b13b2dde2d4b3f1b6b6a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}