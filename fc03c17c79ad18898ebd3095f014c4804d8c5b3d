{
  "comments": [
    {
      "key": {
        "uuid": "e75c8bb7_660fe627",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 8,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2020-07-21T16:13:55Z",
      "side": 1,
      "message": "Could you explain the background?\nAlso, nice to tied to a bug.",
      "revId": "fc03c17c79ad18898ebd3095f014c4804d8c5b3d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "87a052e4_c644d685",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 8,
      "author": {
        "id": 1137124
      },
      "writtenOn": "2020-07-22T03:13:01Z",
      "side": 1,
      "message": "i don\u0027t really know the background.\ni was planning to reenable this test last week, but forgot it.\nand this error comes out that /run/camera is not found.\n\nsrc/platform2/login_manager/chrome_setup.cc:L364 should ensure it exists..\n\nbut file not exist is really not the test goal for the test. \n\nchecking existence is only for to prevent, file is renamed or moved, and renamed file may have bad labels and not checked by test.",
      "parentUuid": "e75c8bb7_660fe627",
      "revId": "fc03c17c79ad18898ebd3095f014c4804d8c5b3d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "88be200b_640fccd7",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 8,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2020-07-28T05:24:12Z",
      "side": 1,
      "message": "Thanks.\n\nThere seems another place that creates the directory.\nsrc/platform2/vm_tools/init/vm_concierge.conf;l\u003d72\nAnd, the UID/GID does not seem to set there.\n\nAt least, I think the directory context should be aligned without race condition.\nShik, could you make sure the expected behavior?\nI understand /run/camera/camera*sock will be removed eventually, but not sure the /run/camera directory itself.",
      "parentUuid": "87a052e4_c644d685",
      "revId": "fc03c17c79ad18898ebd3095f014c4804d8c5b3d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b49ac4e2_22e945b7",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 8,
      "author": {
        "id": 1137124
      },
      "writtenOn": "2020-07-28T05:30:32Z",
      "side": 1,
      "message": "FYI: bisector find https://chromium-review.googlesource.com/c/chromiumos/platform2/+/2297119 to be offending on (passing -\u003e socket bad label)\nI don\u0027t know if bisector can bisect by error message to help look for (socket bad label -\u003e directory gone on some boards). But i guess it\u0027s related to https://chromium-review.googlesource.com/c/chromiumos/platform2/+/2297120.",
      "parentUuid": "88be200b_640fccd7",
      "revId": "fc03c17c79ad18898ebd3095f014c4804d8c5b3d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "463755b1_a6bfeb0f",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 8,
      "author": {
        "id": 1001886
      },
      "writtenOn": "2020-07-28T06:58:07Z",
      "side": 1,
      "message": "The /run/camera directory would still be there and the /run/camera/camera3.sock is also being used to serve camera in PluginVM.\n\nIIRC we don\u0027t use /run/camera in ARC after the camera connection bootstrap is migrated to dbus. If the test is to check the files exist for ARC, maybe we could simply remove those lines?\n\n+hashimoto who just land the cleanup in ARC (http://ag/12139699).",
      "parentUuid": "b49ac4e2_22e945b7",
      "revId": "fc03c17c79ad18898ebd3095f014c4804d8c5b3d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bc676276_df817796",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 8,
      "author": {
        "id": 1000169
      },
      "writtenOn": "2020-07-28T07:42:06Z",
      "side": 1,
      "message": "What Shik said is correct.\nARC no longer uses /run/camera.\nWe can simply stop checking the state of /run/camera and its children in this test as it\u0027s now unrelated to ARC.",
      "parentUuid": "463755b1_a6bfeb0f",
      "revId": "fc03c17c79ad18898ebd3095f014c4804d8c5b3d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1de87723_fd6a1d45",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 8,
      "author": {
        "id": 1137124
      },
      "writtenOn": "2020-07-28T07:59:26Z",
      "side": 1,
      "message": "It\u0027s a little bit special about SELinux*ARC test.\nIt only means check after ARC starts (since we don\u0027t have SELinux*Browser test, and we don\u0027t have SELinux-enforced board without ARC).\n\nI saw /run/camera is not removed for all boards yet (the test is only failing some boards). https://chromium-review.googlesource.com/c/chromiumos/platform2/+/2297120 also only removes for hal v1.",
      "parentUuid": "bc676276_df817796",
      "revId": "fc03c17c79ad18898ebd3095f014c4804d8c5b3d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0e0b48f5_e97d560e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 8,
      "author": {
        "id": 1000169
      },
      "writtenOn": "2020-07-28T08:55:42Z",
      "side": 1,
      "message": "/run/camera exists on v3 boards, but it\u0027s for other components and ARC doesn\u0027t use it.\n\nIIUC this test\u0027s purpose is to check the SELinux contexts of files and directories needed by ARC.\nIn that sense, we can stop checking /run/camera in this test.",
      "parentUuid": "1de87723_fd6a1d45",
      "revId": "fc03c17c79ad18898ebd3095f014c4804d8c5b3d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4491b379_a5b018b8",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 8,
      "author": {
        "id": 1137124
      },
      "writtenOn": "2020-07-28T09:06:57Z",
      "side": 1,
      "message": "\u003e IIUC this test\u0027s purpose is to check the SELinux contexts of files and directories needed by ARC.\nyes, and no.\nyes: when the test was written while everything not related ARC is unconfined \u0026\u0026 unlabeled.\nno: after that, since we\u0027re not enabling SELinux for non-ARC boards, plus, arc-setup hacks file contexts. many post-browser check is also here.\n\nso i would prefer not to remove check, but add ignoreErros: true to allow skipping if it doesn\u0027t exist.",
      "parentUuid": "0e0b48f5_e97d560e",
      "revId": "fc03c17c79ad18898ebd3095f014c4804d8c5b3d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a6e15a85_4f814999",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 8,
      "author": {
        "id": 1000169
      },
      "writtenOn": "2020-07-28T09:39:07Z",
      "side": 1,
      "message": "Sorry, I\u0027m a bit confused by your logic.\nDo you mean this test should check the SELinux labels of all files and directories even if they are not related to ARC?\n\nNow ARC has nothing to do with /run/camera so I think it\u0027s better to do it somewhere else if we want to keep maintaining this check.\nHow about moving /run/camera check to selinux_files_system.go?\n\nFYI arc-setup stopped touching /run/camera in CL:2297119.",
      "parentUuid": "4491b379_a5b018b8",
      "revId": "fc03c17c79ad18898ebd3095f014c4804d8c5b3d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "95fe7d89_aaaaac96",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 8,
      "author": {
        "id": 1137124
      },
      "writtenOn": "2020-07-28T10:18:58Z",
      "side": 1,
      "message": "\u003e How about moving /run/camera check to selinux_files_system.go?\nis there any guarantee that /run/camera is created at system boot.\ni guess no, since i saw vm_concierge init script is trying to mkdir /run/camera, also session_manager is also a known creator for the directory.\n\n\u003e Do you mean this test should check the SELinux labels of all files and directories even if they are not related to ARC?\nYes. The test is for \"post-ARC start\" not ARC-oriented. Security-purpose ARC-oriented SELinux test should be covered by CTS.\n\nAlso there\u0027s no such test to test \"files / processes started after browser login\" since at the beginning the test is designed to test everything matters after ARC starts, even it doesn\u0027t matter to ARC, same for SELinuxProcessesARC. This comes for a reason that \"not to login the system twice, with/without ARC\" for the same purpose of testing, to avoid unnecessary system login, that slows down overall tast run, suggested by someone else long ago.\n\nPlus it\u0027s important to ensure \"many labels is still shape after arc start\" since arc-setup hacks many SELinux file labels in bad ways. it\u0027s sure arc-setup doesn\u0027t hack /run/camera now, but there\u0027s no guarantee such things won\u0027t happen again (or for other not ARC-oriented files in this test) and may potentially break other enforced processes.\n\nAlso, the idea is not to introducing SELinux***Browser comes from the fact that no board with (selinux\u003denforced, arc\u003dfalse), log-in browser-only, and test duplicated things is waste of running time.\n\nSELinuxFilesSystem should only test files exist when system boot, before log-in.",
      "parentUuid": "a6e15a85_4f814999",
      "revId": "fc03c17c79ad18898ebd3095f014c4804d8c5b3d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e6916d8f_06e37209",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 8,
      "author": {
        "id": 1000169
      },
      "writtenOn": "2020-07-28T11:09:17Z",
      "side": 1,
      "message": "Could you update the descriptions of all selinux_files_*.go tests?\nselinux_files_arc.go says \"Checks SELinux labels on ARC-specific files on devices that support ARC\", but it totally contradicts with your explanation.\nAlso, selinux_files_system.go has chrome.LoggedIn() as its precondition and it contradicts with your explanation \"should only test files exist when system boot, before log-in\".\nselinux_files_non_arc.go says \"Checks SELinux labels on Chrome-specific files on devices that don\u0027t support ARC\", but according to your explanation this test runs on no board so we should remove this?\n\nYour concern about arc-setup sounds like YAGNI to me.\nWith ARCVM, we are moving away from arc-setup, and there is no plan to make /run/camera visible to ARC for foreseeable future.\n\n/run/camera/camera3.sock is created by chrome, but it already exists before login and cros_camera_service depends on it so I don\u0027t see any problem calling it a system file, but it depends on how you define a system file.\nIt\u0027d be helpful if you could put a clear guideline about which of selinux_files_*.go test covers what kind of files as comments or test descriptions.",
      "parentUuid": "95fe7d89_aaaaac96",
      "revId": "fc03c17c79ad18898ebd3095f014c4804d8c5b3d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d97dc794_34604b37",
        "filename": "src/chromiumos/tast/local/bundles/cros/security/selinux_files_arc.go",
        "patchSetId": 1
      },
      "lineNbr": 131,
      "author": {
        "id": 1115919
      },
      "writtenOn": "2020-07-21T16:13:55Z",
      "side": 1,
      "message": "This comment is no longer needed as N is gone?",
      "range": {
        "startLine": 131,
        "startChar": 84,
        "endLine": 131,
        "endChar": 114
      },
      "revId": "fc03c17c79ad18898ebd3095f014c4804d8c5b3d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1a35f368_2f2dde12",
        "filename": "src/chromiumos/tast/local/bundles/cros/security/selinux_files_arc.go",
        "patchSetId": 1
      },
      "lineNbr": 131,
      "author": {
        "id": 1137124
      },
      "writtenOn": "2020-07-23T12:20:23Z",
      "side": 1,
      "message": "done in different CL sent to you.",
      "parentUuid": "d97dc794_34604b37",
      "range": {
        "startLine": 131,
        "startChar": 84,
        "endLine": 131,
        "endChar": 114
      },
      "revId": "fc03c17c79ad18898ebd3095f014c4804d8c5b3d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}